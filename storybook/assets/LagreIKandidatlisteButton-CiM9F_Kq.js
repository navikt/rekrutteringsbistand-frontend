import{av as N,j as e,S as I,Q as M,u as _,r as j,aw as P,ae as $,d as p,E as w,ax as R,U as B}from"./iframe-DYebcAac.js";import{L as D}from"./Link-CvjscnMo.js";import{l as T}from"./leggTilKandidat-C9Ec23GL.js";import{u as b}from"./KandidatSøkMarkerteContext-D9IeFB_G.js";import{U as F}from"./umamiEvents-CYDHrNFb.js";import{M as C}from"./Modal-COqdtEtc.js";import{T as i}from"./Table-BF5gnRat.js";import{a as L}from"./Checkbox-DrmofbGh.js";import{P as U}from"./Pagination--7KnMAr2.js";import{S}from"./PersonPlus-CQ8GUqDB.js";const E=({stillingsId:n})=>{const l=N(n);return e.jsx(I,{hooks:[l],children:d=>e.jsx(D,{href:`stilling/${n}`,children:d.stilling.title??"Ukjent tittel"})})};E.__docgenInfo={description:"",methods:[],displayName:"KandidatlisteTittel",props:{stillingsId:{required:!0,tsType:{name:"string"},description:""}}};const H=({onClose:n})=>{const{track:l}=M(),{visVarsel:d}=_(),{markerteKandidater:s,fjernMarkerteKandidater:g}=b(),[h,k]=j.useState(1),x=P(h>1?h-1:0),[r,m]=j.useState([]),[u,f]=j.useState(!1),y=t=>m(c=>c.includes(t)?c.filter(a=>a!==t):[...c,t]);return e.jsxs(C,{onClose:n,open:!0,width:800,header:{heading:`Lagre ${s?.length||0} kandidat i kandidatlister`},children:[e.jsx(C.Body,{children:e.jsx(I,{hooks:[x],children:t=>{const c=Math.floor(t.antall/8);return u?e.jsx($,{}):e.jsxs(e.Fragment,{children:[e.jsxs(i,{zebraStripes:!0,children:[e.jsx(i.Header,{children:e.jsxs(i.Row,{children:[e.jsx(i.DataCell,{children:e.jsx(L,{checked:r.length===t.liste.length,indeterminate:r.length>0&&r.length!==t.liste.length,onChange:()=>{r.length?m([]):m(t.liste.map(a=>a.stillingId))},hideLabel:!0,children:"Velg alle rader"})}),e.jsx(i.HeaderCell,{scope:"col",children:"Stilling"}),e.jsx(i.HeaderCell,{scope:"col",children:"Organisasjon"}),e.jsx(i.HeaderCell,{scope:"col",children:"Antall stillinger"})]})}),e.jsx(i.Body,{children:t.liste?.map((a,v)=>e.jsxs(i.Row,{selected:r.includes(a.stillingId),children:[e.jsx(i.DataCell,{children:e.jsx(L,{hideLabel:!0,checked:r.includes(a.stillingId),onChange:()=>y(a.stillingId),"aria-labelledby":`id-${a.stillingId}`,children:" "})}),e.jsx(i.HeaderCell,{scope:"row",children:e.jsx(E,{stillingsId:a.stillingId})}),e.jsx(i.DataCell,{children:a.organisasjonNavn}),e.jsx(i.DataCell,{children:a.antallStillinger})]},a.stillingId+v))})]}),e.jsx(U,{className:"my-8 flex justify-center",size:"small",page:h,onPageChange:k,count:c>0?c:1})]})}})}),e.jsxs(C.Footer,{children:[e.jsx(p,{disabled:u||r.length===0,type:"button",onClick:()=>{o(r,n,f)},children:"Lagre"}),e.jsx(p,{disabled:u,type:"button",variant:"secondary",onClick:n,children:"Avbryt"})]})]});async function o(t,c,a){if(!(!s||s.length===0)){if(a(!0),t.length!==0){l(F.Stilling.legg_til_markerte_kandidater,{antallKandidater:s?.length,kilde:"Kandidatsøk",antallStillinger:t.length});const v=t.map(K=>T(s,K));try{await Promise.all(v),d({type:"success",tekst:`${s.length}  kandidat${s.length>1?"er":""} lagret i rekrutteringstreff`}),g(),c()}catch(K){new w({message:"Feil ved lagring av kandidater i kandidatliste",error:K}),d({type:"error",tekst:"Feil ved lagring av kandidater i kandidatliste"})}}a(!1)}}};H.__docgenInfo={description:"",methods:[],displayName:"LagreIKandidatlisteModal",props:{onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};const q=({stillingsId:n,kandidatId:l})=>{const{track:d}=M(),{erEier:s,stillingsData:g,refetchKandidatliste:h}=R(),k=B(g,s),{visVarsel:x}=_(),{markerteKandidater:r,fjernMarkerteKandidater:m}=b();async function u(o){if(n){d(F.Stilling.legg_til_markerte_kandidater,{antallKandidater:o?.length,kilde:"Finn kandidater"});try{await T(o,n),x({type:"success",tekst:`${o.length}  kandidat${o.length>1?"er":""} lagret i kandiatliste`}),m()}catch(t){new w({message:"Feil ved lagring av kandidater i kandidatliste",error:t}),x({type:"error",tekst:"Feil ved lagring av kandidater i kandidatliste"})}}}async function f(){if(!(!r||r.length===0))return u(r)}async function y(o){return u([o])}return l?e.jsx(p,{variant:"tertiary",onClick:()=>{y(l),setTimeout(()=>{k?.mutate(),h?.()},1e3)},icon:e.jsx(S,{"aria-hidden":!0}),children:"Legg til jobbsøker i kandidatliste"}):e.jsx(p,{variant:"tertiary",onClick:()=>{f(),setTimeout(()=>{k.mutate(),h?.()},1e3)},icon:e.jsx(S,{"aria-hidden":!0}),disabled:r?.length===0,children:"Legg til markerte kandidater"})},A=({stillingsId:n,kandidatId:l})=>{const{markerteKandidater:d}=b(),[s,g]=j.useState(!1);return n?e.jsx(q,{stillingsId:n,kandidatId:l}):e.jsxs("div",{className:"flex",children:[e.jsx(p,{variant:"tertiary",onClick:()=>g(!0),icon:e.jsx(S,{"aria-hidden":!0}),disabled:d?.length===0,children:"Lagre i kandidatliste"}),s&&e.jsx(H,{onClose:()=>g(!1)})]})};A.__docgenInfo={description:"",methods:[],displayName:"LagreIKandidatlisteButton",props:{stillingsId:{required:!1,tsType:{name:"string"},description:""},kandidatId:{required:!1,tsType:{name:"string"},description:""}}};export{E as K,A as L};
