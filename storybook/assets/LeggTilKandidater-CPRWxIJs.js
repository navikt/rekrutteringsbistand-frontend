import{ct as _,j as e,S as q,cu as E,cv as j,cw as H,r as b,B as D,x as R,d as y,cx as O,cy as U,H as P,a7 as z,A as W,an as G}from"./iframe-5rwrKWZV.js";import{B as p}from"./Box-2Y16bkAR.js";import{M as S}from"./Modal-Ya9Rotr0.js";import{T as J}from"./TextField-DNKHiWzK.js";import{T as w}from"./Tag-D175MPv5.js";import{S as X}from"./CheckmarkCircle-CqxCfpKo.js";import{S as A}from"./PlusCircle-Cfw3ZFyR.js";const L=({fødselsnummer:n})=>{const i=_(n);return e.jsx(q,{hooks:[i],children:a=>a&&e.jsx(Q,{...a})})},Q=n=>{const i=Object.values(n).every(g=>g===!1),a=Object.values(n).every(g=>g===!0);let m=null;if(i||a)return e.jsx("div",{children:"Fant ingen forklaring på hvorfor jobbsøkeren er ikke synlig"});const d=Y(n),f=new Set,o=g=>Z(g,f);return d.utenforNoensKontroll.length?m=o(d.utenforNoensKontroll):m=e.jsxs(e.Fragment,{children:[d.kandidat.length>0&&e.jsx(e.Fragment,{children:o(d.kandidat)}),d.veileder.length>0&&e.jsx(e.Fragment,{children:o(d.veileder)})]}),m},T={utenforNoensKontroll:Object.values(H),kandidat:Object.values(j),veileder:Object.values(E)},Y=n=>{const i=Object.entries(n).filter(([,a])=>a===!1).map(([a])=>a);return{utenforNoensKontroll:i.filter(a=>T.utenforNoensKontroll.includes(a)),kandidat:i.filter(a=>T.kandidat.includes(a)),veileder:i.filter(a=>T.veileder.includes(a))}},Z=(n,i)=>{const a=$(n,i);return a.length===0?null:e.jsx("ul",{className:"list-disc space-y-2 pl-6",children:a.map(m=>e.jsx("li",{children:m},m))})},$=(n,i)=>{const a=[];return n.forEach(m=>{const d=ee(m);!d||i.has(d)||(i.add(d),a.push(d))}),a},ee=n=>{switch(n){case j.HarAktivCv:case j.HarJobbprofil:return"Personbruker mangler CV. Minimum innhold er ett yrkesønske og ett geografisk sted person ønsker å jobbe.";case j.HarSettHjemmel:return"Personbruker har ikke blitt informert om Navs behandlingsgrunnlag for deling av CV.";case j.MåIkkeBehandleTidligereCv:return"Personbruker har ikke valgt «Del CV». Dette kravet opptrer kun i overgangs-tilfeller hvor personbruker kommer under oppfølging av Nav med en CV som hen har fra en tidligere oppfølgingsperiode, eller med en CV som ble opprettet før hen kom under oppfølging av Nav.";case j.ErUnderOppfølging:case E.ErArbeidssøker:return"Personbruker må være i Navs Arbeidssøkerregister.";case H.ErIkkeDød:return"Er død."}};L.__docgenInfo={description:"",methods:[],displayName:"SynlighetsEvaluering",props:{fødselsnummer:{required:!0,tsType:{name:"string"},description:""}}};const F=({fødselsnummer:n})=>{const[i,a]=b.useState(!1);return e.jsx(p.New,{paddingInline:"space-16",paddingBlock:"space-12",children:i?e.jsx(L,{fødselsnummer:n}):e.jsxs("div",{children:[e.jsxs("div",{className:"py-2",children:[e.jsx(D,{className:"mb-2 font-bold",children:"Betingelser for at CV blir tilgjengelig i Rekrutteringsbistand"}),e.jsx(R,{children:"Det er tre krav som alle må være positive (1-3), mens de siste tre (4-6) er motsatt at de ekskluderer de personbrukere som kjennetegnes ved dem."})]}),e.jsxs("ol",{className:"list-decimal space-y-2 pl-6",children:[e.jsx("li",{children:"Personbruker må ha en CV, hvis ikke er det ikke noen CV å søke frem."}),e.jsx("li",{children:"Personbruker må ha blitt informert om hvordan Nav behandler personopplysninger i CV."}),e.jsx("li",{children:"Personbruker må være i Navs Arbeidssøkerregister."}),e.jsx("li",{children:'Personbruker kan ikke ha status "Egen ansatt".'}),e.jsx("li",{children:"Personbruker kan ikke ha adresseskjerming (kode 6 eller 7, eller strengt fortrolig utland §19)."}),e.jsx("li",{children:"Personbruker kan ikke være deltager i kommunalt kvalifiseringsprogram (KVP)."})]}),e.jsx(y,{className:"mt-4",onClick:()=>a(!0),variant:"secondary",children:"Se hvorfor jobbsøker ikke er synlig (punkt 1-4)"})]})})};F.__docgenInfo={description:"",methods:[],displayName:"Synlighetsinfo"};const M=({fødselsnummer:n})=>{const i=b.useRef(null);return e.jsxs("div",{children:[e.jsx(y,{variant:"tertiary",onClick:()=>i.current?.showModal(),type:"button",children:"Hvorfor er ikke kandidaten synlig?"}),e.jsxs(S,{ref:i,header:{heading:"Hvorfor er ikke kandidaten synlig?"},children:[e.jsx(S.Body,{children:e.jsx(F,{fødselsnummer:n})}),e.jsx(S.Footer,{children:e.jsx(y,{type:"button",onClick:()=>i.current?.close(),children:"Lukk"})})]})]})};M.__docgenInfo={description:"",methods:[],displayName:"SynlighetsModal",props:{fødselsnummer:{required:!0,tsType:{name:"string"},description:""}}};var C={},V;function re(){return V||(V=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.idnr=n.getType=n.dnrAndTnr=n.dnrAndHnr=n.tnr=n.hnr=n.dnr=n.fnr=void 0;const i=new RegExp("^\\d{11}$"),a=r=>(0,n.idnr)(r);n.fnr=a;const m=r=>(0,n.idnr)(r);n.dnr=m;const d=r=>(0,n.idnr)(r);n.hnr=d;const f=r=>(0,n.idnr)(r);n.tnr=f;const o=r=>(0,n.idnr)(r);n.dnrAndHnr=o;const g=r=>(0,n.idnr)(r);n.dnrAndTnr=g;const h=r=>{let s=r.split("").map(Number);return s[0]>=4&&s[2]>=8?"dnr-and-tnr":s[0]>=4&&s[2]>=4?"dnr-and-hnr":s[0]>=4?"dnr":s[2]>=8?"tnr":s[2]>=4?"hnr":"fnr"};n.getType=h;const v=r=>{const s=(0,n.getType)(r);return K(r,s)};n.idnr=v;const K=(r,s)=>{if(!i.test(r))return{status:"invalid",reasons:["fnr, dnr or hnr must consist of 11 digits"]};const c=[...x(r),...l(r,s)];return c.length==0?{status:"valid",type:s}:{status:"invalid",reasons:c}},x=r=>{let s=r.split("").map(Number),c=11-(3*s[0]+7*s[1]+6*s[2]+1*s[3]+8*s[4]+9*s[5]+4*s[6]+5*s[7]+2*s[8])%11,k=11-(5*s[0]+4*s[1]+3*s[2]+2*s[3]+7*s[4]+6*s[5]+5*s[6]+4*s[7]+3*s[8]+2*c)%11;return c===11&&(c=0),k===11&&(k=0),c<10&&k<10&&c==s[9]&&k==s[10]?[]:["checksums don't match"]},l=(r,s)=>{s==="dnr"?r=Number(r.substring(0,1))-4+r.substring(1):s==="hnr"?r=r.substring(0,2)+(Number(r.substring(2,3))-4)+r.substring(3):s==="tnr"?r=r.substring(0,2)+(Number(r.substring(2,3))-8)+r.substring(3):s==="dnr-and-hnr"?r=Number(r.substring(0,1))-4+r.substring(1,2)+(Number(r.substring(2,3))-4)+r.substring(3):s==="dnr-and-tnr"&&(r=Number(r.substring(0,1))-4+r.substring(1,2)+(Number(r.substring(2,3))-8)+r.substring(3));const c=Number(r.substring(0,2)),k=Number(r.substring(2,4)),N=r.substring(4,6),t=N=="00"?2e3:Number(N),u=new Date(Date.UTC(t,k-1,c));return u&&u.getUTCMonth()+1==k&&u.getUTCDate()==c?[]:["invalid date"]}})(C)),C}var ne=re();const se=n=>ne.idnr(n).status==="valid",te=({callBack:n,synlighetSomModal:i,initielleKandidater:a,tilFormidling:m})=>{const[d,f]=b.useState(""),[o,g]=b.useState(a??[]),[h,v]=b.useState(null),[K,x]=b.useState(""),l=O(h),r=U(h);b.useEffect(()=>{n(o)},[o,n]);const s=t=>{x(t),t.length<11?(f(""),v(null)):t.length>11?(v(null),f("Fødselsnummeret er for langt")):se(t)?(f(""),v(t)):(v(null),f("Fødselsnummeret er ikke gyldig"))},c=(t,u,B)=>{!o.some(I=>I.fødselsnummer===t)&&l.data&&(v(null),x(""),g([...o,{fødselsnummer:t,fornavn:u.fornavn,etternavn:u.etternavn,kilde:u.kilde,aktørId:B??null}]))},k=t=>e.jsx(p.New,{"data-testid":"velg-kandidat-resultat",className:"cursor-pointer",onClick:()=>{l.data&&c(t,l.data,r.data?.arenaKandidatnr??null)},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"p-4",children:[l.data?.fornavn," ",l.data?.etternavn," -"," ",t]}),e.jsx("div",{className:"mr-4",children:o.some(u=>u.fødselsnummer===t)?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{})," ",e.jsx("strong",{children:"Lagt til"})]}):e.jsx(y,{icon:e.jsx(A,{}),variant:"tertiary",children:"Legg til"})})]})}),N=t=>e.jsxs(p.New,{children:[e.jsxs("div",{className:"grid grid-cols-1 px-4 pt-4",children:[e.jsxs("div",{children:[l.data?.fornavn," ",l.data?.etternavn," -"," ",t]}),e.jsxs("div",{children:[e.jsx(w,{variant:"warning",size:"medium",className:"my-2",children:"Jobbsøkeren er ikke synlig"}),i&&e.jsx(M,{fødselsnummer:t})]})]}),!i&&e.jsx(F,{fødselsnummer:t})," ",e.jsx("hr",{}),e.jsx("div",{className:"flex justify-end",children:e.jsx(y,{icon:e.jsx(A,{}),variant:"tertiary",onClick:()=>{l?.data&&c(t,l?.data,null)},children:"Legg til som usynlig jobbsøker (Registrer som fått jobben)"})})]});return e.jsxs("div",{children:[e.jsx(P,{size:"xsmall",className:"mb-2",children:"Søk etter fødselsnummer"}),e.jsxs(p.New,{borderRadius:"xlarge",borderWidth:"1",borderColor:"info-subtleA",background:"info-soft",children:[e.jsx(J,{type:"text",inputMode:"numeric",value:K,label:"Fødselsnummer på jobbsøker",hideLabel:!0,onChange:t=>{const u=t.target.value.replace(/[^0-9]/g,"");s(u)},error:d}),l.isLoading?e.jsx(p.New,{className:"flex h-full items-center justify-center p-4",children:e.jsx(z,{})}):l.data&&h?r.data?.arenaKandidatnr?k(h):N(h):null,l.error&&e.jsx(W,{variant:"error",className:"mt-4",children:e.jsx("p",{children:l.error?.statuskode===403?"Tilgangen ble avvist fordi brukeren har adressebeskyttelse":l.error?.statuskode===404?"Finner ikke person knyttet til fødselsnummer":"Det oppstod en feil ved søk på fødselsnummer"})})]}),o.length>0&&e.jsxs("div",{className:"mt-8",children:[e.jsx(P,{size:"medium",children:"Utvalgte jobbsøkere"}),o.map(t=>e.jsxs(p.New,{className:"flex flex-row items-center justify-between font-bold",background:"raised",borderColor:"neutral-subtleA",borderRadius:"xlarge",borderWidth:"1",paddingInline:"space-16",paddingBlock:"space-12",children:[e.jsxs("div",{children:[t.fornavn," ",t.etternavn," (",t.fødselsnummer,")"]}),e.jsxs("div",{children:[(!t.aktørId||m)&&e.jsx(w,{variant:"success",children:"Fått jobben"}),e.jsx(y,{icon:e.jsx(G,{}),variant:"tertiary",onClick:()=>g(o.filter(u=>u.fødselsnummer!==t.fødselsnummer)),children:"Fjern"})]})]},t.fødselsnummer))]})]})};te.__docgenInfo={description:"",methods:[],displayName:"LeggTilKandidater",props:{callBack:{required:!0,tsType:{name:"signature",type:"function",raw:"(valgteKandidater: ValgtKandidatProp[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"ValgtKandidatProp"}],raw:"ValgtKandidatProp[]"},name:"valgteKandidater"}],return:{name:"void"}}},description:""},initielleKandidater:{required:!1,tsType:{name:"Array",elements:[{name:"ValgtKandidatProp"}],raw:"ValgtKandidatProp[]"},description:""},synlighetSomModal:{required:!1,tsType:{name:"boolean"},description:""},lukkModal:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},tilFormidling:{required:!1,tsType:{name:"boolean"},description:""}}};export{te as L};
