import{bh as h,bR as V,bj as d,r as m,bS as w,bT as D,A as j,bU as T,bl as C,bV as B,bW as P,bE as S}from"./iframe-DxqhZqaS.js";import{f as E}from"./index-CqTTEDZl.js";import{t as I}from"./utils-wnTDovxS.js";function M(){const{rekrutteringstreffId:t,startLagring:n,stoppLagring:o}=h(),{data:l,mutate:r}=V(t),s=l?.[0],{getValues:a,setValue:g}=d();return{lagre:m.useCallback(async()=>{if(!t)return;const i=(a().htmlContent??"").toString();if(i.trim().length!==0)try{const c=s?.opprettetAvPersonNavn||s?.opprettetAvPersonNavident||"Markedskontakt",u={htmlContent:i,tittel:"Om treffet",opprettetAvPersonNavn:c,opprettetAvPersonBeskrivelse:"Markedskontakt",sendesTilJobbsokerTidspunkt:E(new Date,"Europe/Oslo","yyyy-MM-dd'T'HH:mm:ssXXX")};n("innlegg"),s?.id?await w(t,s.id,u):await D(t,u),r(),g("htmlContent",i,{shouldDirty:!1})}catch(c){new j({message:"Lagring av innlegg feilet.",error:c})}finally{o("innlegg")}},[a,s,r,t,n,o,g]),innlegg:s}}function O(){const{rekrutteringstreffId:t,startLagring:n,stoppLagring:o}=h(),{mutate:l}=T(t),{treff:r}=C(),{getValues:s}=d(),a=m.useCallback(()=>{const e=s(),f=I(e.fraDato??null,e.fraTid)??r?.fraTid??null,i=I(e.tilDato??e.fraDato??null,e.tilTid)??r?.tilTid??null,c=I(e.svarfristDato??null,e.svarfristTid)??r?.svarfrist??null,u=typeof e.tittel=="string"?e.tittel.trim():"";return{tittel:u.length>0?u:r?.tittel??"Treff uten navn",beskrivelse:e.beskrivelse??r?.beskrivelse??null,fraTid:f,tilTid:i,svarfrist:c,gateadresse:e.gateadresse??r?.gateadresse??null,postnummer:e.postnummer??r?.postnummer??null,poststed:e.poststed??r?.poststed??null,kommune:e.kommune??r?.kommune??null,kommunenummer:e.kommunenummer??r?.kommunenummer??null,fylke:e.fylke??r?.fylke??null,fylkesnummer:e.fylkesnummer??r?.fylkesnummer??null}},[s,r]);return{lagre:m.useCallback(async()=>{if(!t)return;const e=a();try{n("rekrutteringstreff"),await B(t,e),l()}finally{o("rekrutteringstreff")}},[a,t,l,n,o]),byggRekrutteringstreffDto:a}}const N=()=>{try{return!1}catch{return!1}},x=t=>{const n=P(t?.hendelser);return n===S.INVITERE||n===S.FULLFÃ˜RE};function F(){const{watch:t,formState:n}=d(),o=t("tittelKiFeil")??!1,l=t("htmlContentKiFeil")??!1,r=!!o||!!l,s=!!(n.errors&&Object.keys(n.errors).some(c=>c!=="root")),a=r||s,g=!!n?.errors?.tittel,e=!!n?.errors?.htmlContent,f=!!t("tittelKiSjekket"),i=!!t("htmlContentKiSjekket");return{harFeil:a,harKiFeil:r,harAndreSkjemafeil:s,tittelKiFeil:o,innleggKiFeil:l,harTittelFeil:g,harInnleggFeil:e,tittelKiSjekket:f,innleggKiSjekket:i}}const A=(t,n,o,l)=>t||!n?!1:!l||o;function J(){const{rekrutteringstreffId:t}=h(),{treff:n}=C(),{getValues:o,trigger:l,formState:r}=d(),{lagre:s,byggRekrutteringstreffDto:a}=O(),{tittelKiFeil:g,tittelKiSjekket:e}=F(),f=m.useCallback(async(u,p)=>{if(!t||!await l(u&&u.length>0?u:void 0,{shouldFocus:!1}))return;if(r?.errors?.root?.type==="manualPeriod"){const v=a();if((v?.fraTid??null)!==(n?.fraTid??null)||(v?.tilTid??null)!==(n?.tilTid??null))return}const k=o(),y=typeof k.tittel=="string"?k.tittel.trim():"",b=y.length>0&&y!==(n?.tittel??"");A(p??!1,b,g,e)||await s()},[t,n,a,l,r,o,s,e,g]),i=m.useCallback(async()=>{},[]);return{autosave:m.useMemo(()=>K(n)?i:f,[n,i,f])}}function W(){const{rekrutteringstreffId:t}=h(),{data:n}=T(t),{getValues:o,trigger:l}=d(),{lagre:r,innlegg:s}=M(),{harInnleggFeil:a,innleggKiFeil:g,innleggKiSjekket:e}=F(),f=m.useCallback(async(u,p)=>{if(!t||u&&u.length&&!await l(u,{shouldFocus:!1}))return;const k=(o().htmlContent??"").toString();if(!(k.trim().length>0)||a)return;const b=s?.htmlContent??"",v=k.trim().length>0&&k!==b;A(p??!1,v,g,e)||await r()},[t,l,o,r,s,a,g,e]),i=m.useCallback(async()=>{},[]);return{autosave:m.useMemo(()=>K(n)?i:f,[n,i,f])}}const K=t=>x(t)&&N();export{N as a,J as b,x as e,W as u};
