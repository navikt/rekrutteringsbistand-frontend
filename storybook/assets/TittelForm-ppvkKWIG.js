import{b5 as y,bL as v,bT as w,r as P,j as e,H as D,C as S,B as A,b7 as C,bU as F,d as V,at as _,az as G}from"./iframe-dDyLELCN.js";import{T as N}from"./TextField-DJ0Xg_Zy.js";import{T as I,S as z}from"./TidspunktForm-YaGiH5-2.js";import{B as x}from"./Box-CWCuGFT8.js";import{K as Y}from"./KiAnalyseIntro-CS_U4Iou.js";import{K as H}from"./KiAnalysePanel-CeOzvjIX.js";import{u as X}from"./useFormFeltMedKiValidering-BeK3D2Xh.js";import{S as q}from"./Skeleton-DtldA4-E.js";const r={GATEADRESSE:"gateadresse",POSTNUMMER:"postnummer",POSTSTED:"poststed",FYLKE:"fylke",FYLKESNUMMER:"fylkesnummer",KOMMUNE:"kommune",KOMMUNENUMMER:"kommunenummer"},b=({control:n})=>{const{setValue:a,clearErrors:d,setError:g,trigger:h}=y(),o=v({control:n,name:r.POSTNUMMER}),{data:l,isLoading:m}=w(o||"");return P.useEffect(()=>{if(!o||o.length!==4||m)return;const t={shouldDirty:!0,shouldValidate:!0};l?.korrigertNavnBy?(a(r.POSTSTED,l.korrigertNavnBy,t),a(r.KOMMUNE,l.kommune.korrigertNavn,t),a(r.KOMMUNENUMMER,l.kommune.kommunenummer,t),a(r.FYLKE,l.fylke.korrigertNavn,t),a(r.FYLKESNUMMER,l.fylke.fylkesnummer,t),d(r.POSTSTED)):(a(r.POSTSTED,"",t),a(r.KOMMUNE,"",t),a(r.KOMMUNENUMMER,"",t),a(r.FYLKE,"",t),a(r.FYLKESNUMMER,"",t),g(r.POSTSTED,{type:"manual",message:"Ukjent poststed"}))},[o,m,l,a,g,d]),e.jsxs("div",{className:"space-y-4",children:[e.jsx(D,{level:"3",size:"small",children:"Sted"}),e.jsx(S,{name:r.GATEADRESSE,control:n,render:({field:t,fieldState:u})=>e.jsx(N,{...t,value:t.value??"",label:"Gateadresse",error:u.error?.message,maxLength:100,onBlur:t.onBlur})}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(S,{name:r.POSTNUMMER,control:n,render:({field:t,fieldState:u})=>e.jsx(N,{...t,value:t.value??"",label:"Postnummer",htmlSize:12,error:u.error?.message,onChange:T=>{const c=T.target.value.replace(/\D/g,"");d([r.POSTNUMMER,r.POSTSTED]),a(r.POSTSTED,"",{shouldDirty:!1,shouldValidate:!0}),c.length<=4&&t.onChange(c),c.length===4&&h([r.POSTNUMMER])},onBlur:t.onBlur})}),e.jsx(A,{className:`mt-3 pt-8 ${v({control:n,name:r.POSTSTED})?"":"aksel-error-message"}`,children:v({control:n,name:r.POSTSTED})||(o&&o.length===4&&!m?"Ukjent poststed":"")})]})]})};b.__docgenInfo={description:"",methods:[],displayName:"StedForm"};const W=()=>{const{control:n}=y();return e.jsxs("div",{className:"space-y-8",children:[e.jsx(D,{level:"2",size:"medium",children:"Praktiske forhold"}),e.jsx(x.New,{background:"neutral-moderate",borderRadius:"xlarge",padding:"3",children:e.jsx(I,{control:n})}),e.jsx(x.New,{background:"neutral-moderate",borderRadius:"xlarge",padding:"3",children:e.jsx(z,{control:n})}),e.jsx(x.New,{background:"neutral-moderate",borderRadius:"xlarge",padding:"3",children:e.jsx(b,{control:n})})]})};W.__docgenInfo={description:"",methods:[],displayName:"PraktiskeForhold"};const $="Treff uten navn",K=({onUpdated:n})=>{const{treff:a}=C(),d=a?a.tittel??null:void 0,{clearErrors:g,formState:{isSubmitting:h}}=y(),o=P.useRef(null),{analyse:l,analyseError:m,validating:t,kiErrorBorder:u,harGodkjentKiFeil:T,showAnalysis:c,erRedigeringAvPublisertTreff:U,validerMedKiOgLagreVedGodkjenning:j,onGodkjennKiFeil:L,watchedValue:p,control:O,setValue:k,kiLoggLoading:M}=X({feltType:"tittel",fieldName:"tittel",savedValue:d,onUpdated:n}),R=F-(typeof p=="string"?p.length:0),B=()=>{k("tittel","",{shouldValidate:!0,shouldDirty:!0,shouldTouch:!0}),o.current?.focus()};return e.jsxs("section",{className:"space-y-3",children:[M&&e.jsx(q,{variant:"text"}),!M&&e.jsxs(e.Fragment,{children:[e.jsx(Y,{title:"Navn på treffet"}),e.jsxs("div",{className:"relative w-full",onBlur:i=>{const f=i.currentTarget;setTimeout(async()=>{!f.contains(document.activeElement)&&!h&&await j()},0)},children:[p&&e.jsx(V,{type:"button",onClick:B,"aria-label":"Tøm tittel feltet",variant:"tertiary",size:"small",className:"absolute top-[2rem] right-2 h-8 -translate-y-1/2 p-1",title:"Tøm feltet",children:e.jsx(_,{"aria-hidden":!0,fontSize:"1.25rem"})}),e.jsx("div",{className:"flex items-start",children:e.jsx(S,{control:O,name:"tittel",render:({field:i,fieldState:f})=>e.jsx(N,{...i,value:i.value??"",ref:s=>{i.ref(s),o.current=s},label:"Navn på treffet",hideLabel:!0,maxLength:F,className:"w-full pt-2",error:f.error?.message||(u?"Brudd på retningslinjer":void 0),"aria-invalid":!!(f.error||u),autoComplete:"off",autoCorrect:"off",spellCheck:!1,onChange:s=>{i.onChange(s),s.target.value.trim().length>0&&g("tittel")},onBlur:()=>{i.onBlur()},onFocus:()=>{const s=i.value;if(!s||typeof s!="string")return;s.trim()===$&&k("tittel","",{shouldValidate:!1,shouldDirty:!1,shouldTouch:!1})},onKeyDown:s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),(async()=>{const E=s.currentTarget;await j(),E?.blur()})())}})})})]}),e.jsxs(G,{className:"text-gray-400",children:[R," tegn igjen"]}),e.jsx(H,{validating:t,analyse:l,analyseError:m,harGodkjentKiFeil:T,showAnalysis:c,erRedigeringAvPublisertTreff:U,onGodkjennKiFeil:L,ariaLabel:"Analyse av tittel"})]})]})};K.displayName="TittelForm";K.__docgenInfo={description:"",methods:[],displayName:"TittelForm",props:{onUpdated:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{W as P,b as S,K as T};
