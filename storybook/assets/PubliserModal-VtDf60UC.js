import{ab as Y,r as u,s as P,ax as Z,h as $,i as j,B as ee,m as te,y as se,t as oe,z as re,u as ne,c as le,gI as ie,j as s,b as M,H as L,w as ae,R as de}from"./iframe-BZGI7Ig_.js";import{o as ce}from"./oppdaterStilling-pxr69sPD.js";import{u as ue}from"./useStilling-DdqFY49I.js";import{D as H}from"./DatoVelger-Bbr8E6Do.js";import{p as B}from"./parse-CG8pKw-3.js";import{f as _,i as R}from"./format-DCzO9vOU.js";import{p as pe}from"./parseISO-DJIM71K9.js";import{U as ge}from"./umamiEvents-BDpRy9-M.js";import{a as me}from"./index.esm-DrM6Kbjf.js";import{M as V}from"./Modal-0KuFj30Z.js";import{B as fe}from"./Box-B9qWBmGB.js";import{C as be}from"./Checkbox-CVyHKrRn.js";import{c as ye}from"./useDescendant-yAaYD9qp.js";import{u as ve}from"./useControllableState-DL5RPXQs.js";import{T as z}from"./TextField-D94asoPI.js";u.createContext(null);const[he,Je,xe,ke]=ye(),[je,U]=Y({name:"ToggleGroupContext",hookName:"useToggleGroupContext",providerName:"ToggleGroupProvider",errorMessage:"<ToggleGroup.Item> needs to be wrapped within <ToggleGroup>"});function Se({value:e,disabled:r=!1,onFocus:n,onClick:t,onKeyDown:o},d){const{setSelectedValue:p,setFocusedValue:b,selectedValue:g,focusedValue:x}=U(),{register:v,descendants:m}=ke({disabled:r,value:e}),c=e===g,h=()=>b(e),S=u.useCallback(f=>{const w=m.values().findIndex(a=>a.value===x),I={ArrowLeft:()=>{var a;const i=m.prevEnabled(w,!1);(a=i?.node)===null||a===void 0||a.focus()},ArrowRight:()=>{var a;const i=m.nextEnabled(w,!1);(a=i?.node)===null||a===void 0||a.focus()},Home:()=>{var a;const i=m.firstEnabled();(a=i?.node)===null||a===void 0||a.focus()},End:()=>{var a;const i=m.lastEnabled();(a=i?.node)===null||a===void 0||a.focus()}},O=f.shiftKey||f.ctrlKey||f.altKey||f.metaKey,D=I[f.key];D&&!O?(f.preventDefault(),D(f)):f.key==="Tab"&&g&&setTimeout(()=>b(g))},[m,x,g,b]);return{ref:Z([v,d]),isSelected:c,isFocused:x===e,onClick:P(t,()=>g!==e&&p(e)),onFocus:r?void 0:P(n,h),onKeyDown:P(o,S)}}var Te=function(e,r){var n={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&r.indexOf(t)<0&&(n[t]=e[t]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,t=Object.getOwnPropertySymbols(e);o<t.length;o++)r.indexOf(t[o])<0&&Object.prototype.propertyIsEnumerable.call(e,t[o])&&(n[t[o]]=e[t[o]]);return n};const we=u.forwardRef((e,r)=>{var{className:n,children:t,icon:o,label:d,value:p,onClick:b,onFocus:g,onKeyDown:x}=e,v=Te(e,["className","children","icon","label","value","onClick","onFocus","onKeyDown"]);const{cn:m}=$(),c=Se({value:p,onClick:b,onFocus:g,disabled:!1,onKeyDown:x},r),h=U();return j.createElement("button",Object.assign({},v,{ref:c.ref,className:m("navds-toggle-group__button",n),type:"button",role:"radio","aria-checked":c.isSelected,"data-selected":c.isSelected,tabIndex:c.isFocused?0:-1,onClick:c.onClick,onFocus:c.onFocus,onKeyDown:c.onKeyDown}),j.createElement(ee,{as:"span",className:m("navds-toggle-group__button-inner"),size:h?.size},t??j.createElement(j.Fragment,null,o,d)))});function Oe({onChange:e,value:r,defaultValue:n=""}){const[t,o]=u.useState(n),[d,p]=ve({defaultValue:n,value:r,onChange:e});return u.useEffect(()=>{r!=null&&o(r)},[r]),{selectedValue:d,setSelectedValue:p,focusedValue:t,setFocusedValue:o}}var Ne=function(e,r){var n={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&r.indexOf(t)<0&&(n[t]=e[t]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,t=Object.getOwnPropertySymbols(e);o<t.length;o++)r.indexOf(t[o])<0&&Object.prototype.propertyIsEnumerable.call(e,t[o])&&(n[t[o]]=e[t[o]]);return n};const E=u.forwardRef((e,r)=>{var{className:n,children:t,onChange:o,size:d="medium",label:p,value:b,defaultValue:g,"aria-describedby":x,variant:v,fill:m=!1,"data-color":c}=e,h=Ne(e,["className","children","onChange","size","label","value","defaultValue","aria-describedby","variant","fill","data-color"]);const{cn:S}=$(),f=te(!1),w=xe(),N=Oe({defaultValue:g,value:b,onChange:o}),T=Object.assign(Object.assign({},N),{size:d}),C=se();!b&&!g&&console.error("ToggleGroup without value or defaultvalue is not allowed"),!b&&!g&&console.error("ToggleGroup needs either a value or defaultValue");let y;return f?y=v:y=v??"action",j.createElement(he,{value:w},j.createElement(je,Object.assign({},T),j.createElement("div",{className:S("navds-toggle-group__wrapper",n,{"navds-toggle-group__wrapper--fill":m}),"data-color":c??Ce(y)},p&&j.createElement(oe,{size:d,className:S("navds-toggle-group__label"),id:C},p),j.createElement("div",Object.assign({},h,{ref:r,className:S("navds-toggle-group",`navds-toggle-group--${d}`,{[`navds-toggle-group--${y}`]:y}),"aria-describedby":re(x,!!p&&C)||void 0,role:"radiogroup"}),t))))});function Ce(e){switch(e){case"action":return"accent";case"neutral":return"neutral";default:return}}E.Item=we;const De=e=>e.replace(/^(\d{4}-\d{2}-\d{2}T\d{2}:\d{2})(?!:)/,"$1:00").replace(/^(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})\.(\d{3})\d+(.*)$/,"$1.$2$3"),A=e=>{if(!e)return null;if(/^\d{2}\.\d{2}\.\d{4}$/.test(e)){const n=B(e,"dd.MM.yyyy",new Date);return R(n)?_(n,"yyyy-MM-dd'T'00:00:00"):null}const r=pe(De(e));return R(r)?_(r,"yyyy-MM-dd'T'HH:mm:ss"):null},Ee=e=>{const r=A(e.stilling?.published),n=A(e.stilling?.expires);return{...e,stilling:{...e.stilling,properties:{...e.stilling.properties,tags:typeof e.stilling?.properties?.tags=="string"?e.stilling?.properties?.tags:JSON.stringify(e.stilling?.properties?.tags??[]),workday:typeof e.stilling?.properties?.workday=="string"?e.stilling?.properties?.workday:JSON.stringify(e.stilling?.properties?.workday??[]),workhours:typeof e.stilling?.properties?.workhours=="string"?e.stilling?.properties?.workhours:JSON.stringify(e.stilling?.properties?.workhours??[])},published:r,expires:n}}};function _e({disabled:e}){const{brukerData:r,valgtNavKontor:n}=ne(),t=u.useRef(null),{watch:o,setValue:d,getValues:p}=me(),{track:b}=le(),g=ie(),x=o("stilling.privacy"),v=o("stilling.published"),m=o("stilling.expires"),c=o("stilling.properties.applicationemail"),h=o("stilling.properties.applicationurl"),[S,f]=u.useState(!1),w=ue(p().stilling.uuid),N=l=>{if(l)try{return _(new Date(l),"dd.MM.yyyy")}catch{return}},[T,C]=u.useState(N(v)),[y,I]=u.useState(N(m)),[O,D]=u.useState(x==="SHOW_ALL"),a=h?"url":"email",[i,J]=u.useState(a),[F,W]=u.useState(c??""),[G,q]=u.useState(h??""),K=l=>{if(!l)return null;const k=B(l,"dd.MM.yyyy",new Date);return _(k,"yyyy-MM-dd'T'HH:mm:ss")},Q=async()=>{f(!0);try{d("stilling.published",K(T),{shouldDirty:!0}),d("stilling.expires",K(y),{shouldDirty:!0}),d("stilling.privacy",O?"SHOW_ALL":"INTERNAL_NOT_SHOWN",{shouldDirty:!0}),O&&(i==="email"?(d("stilling.properties.applicationemail",F||null,{shouldDirty:!0}),d("stilling.properties.applicationurl",null,{shouldDirty:!0})):(d("stilling.properties.applicationurl",G||null,{shouldDirty:!0}),d("stilling.properties.applicationemail",null,{shouldDirty:!0})));const l=Ee(p()),k={...l,stillingsinfo:{...l.stillingsinfo},stilling:{...l.stilling,status:"ACTIVE",administration:{...l.stilling.administration,status:"DONE"},firstPublished:!0}};b(ge.Stilling.ny_stilling_info,{yrkestittel:k.stilling.categoryList?.[0]?.name,sektor:k.stilling.properties?.sector,ansettelsesform:k.stilling.properties?.engagementtype,arbeidstidsordning:k.stilling?.properties?.jobarrangement,omfangIProsent:k.stilling.properties?.jobpercentage,arbeidssted:k.stilling.locationList});try{await ce(k,{eierNavident:r.ident,eierNavn:r.navn,eierNavKontorEnhetId:n?.navKontor})}catch(X){alert("Feil ved opprettelse av stilling"),new de({message:"Feil ved opprettelse av stilling",error:X})}t.current?.close(),w.mutate(),g.push(`/stilling/${p().stilling.uuid}`)}catch{alert("Uventet feil ved publisering")}finally{f(!1)}};return s.jsxs(s.Fragment,{children:[s.jsx(M,{size:"small",disabled:e,onClick:()=>t.current?.showModal(),children:"Publiser"}),s.jsxs(V,{ref:t,header:{heading:"Publiser stillingsoppdraget"},children:[s.jsxs(V.Body,{children:[s.jsxs(fe.New,{background:"neutral-soft",padding:"6",className:"mb-8",children:[s.jsx(L,{size:"small",className:"mb-2",children:"Dette skjer når du publiserer oppdraget"}),s.jsxs("ul",{className:"list-disc pl-5 text-sm mb-4",children:[s.jsx("li",{children:"Stillingsoppdraget blir synlig for Nav-ansatte i rekrutteringsbistand."}),s.jsx("li",{children:"Ansatte hos arbeidsgiveren på Min Side Arbeidsgiver på nav.no (med Altinn-tilgang)."}),s.jsx("li",{children:"Jobbsøkere som får stillingen delt i aktivitetsplanen."})]}),s.jsx(ae,{size:"small",children:"Ikke alt må være helt perfekt! Du kan når som helst endre eller avpublisere oppdraget."})]}),s.jsxs("div",{className:"grid gap-6",children:[s.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[s.jsx(H,{disablePastDates:!0,label:"Publiseringsdato",valgtDato:T,tilDato:y,setDato:l=>C(l)}),s.jsx(H,{disablePastDates:!0,label:"Siste visningsdato",valgtDato:y,fraDato:T,setDato:l=>I(l)})]}),s.jsx(be,{checked:O,onChange:l=>D(l.target.checked),children:"Publiser stillingsoppdraget offentlig på arbeidsplassen.no også"}),O&&s.jsxs("div",{children:[s.jsx(L,{size:"small",className:"mb-4",children:"Hvordan skal jobbsøker søke?"}),s.jsxs(E,{fill:!0,defaultValue:i,onChange:l=>J(l),children:[s.jsx(E.Item,{value:"email",label:"E-post"}),s.jsx(E.Item,{value:"url",label:"Søknadsskjema"})]}),i==="email"&&s.jsx("div",{className:"mt-4",children:s.jsx(z,{label:"E-post",value:F,onChange:l=>W(l.target.value)})}),i==="url"&&s.jsx("div",{className:"mt-4",children:s.jsx(z,{label:"Lenke til søknadsskjema",value:G,onChange:l=>q(l.target.value)})})]})]})]}),s.jsxs(V.Footer,{children:[s.jsx(M,{loading:S,type:"button",onClick:Q,children:"Publiser oppdraget"}),s.jsx(M,{type:"button",variant:"secondary",onClick:()=>t.current?.close(),children:"Avbryt"})]})]})]})}_e.__docgenInfo={description:"",methods:[],displayName:"PubliserModal",props:{disabled:{required:!0,tsType:{name:"boolean"},description:""}}};export{_e as P,Ee as m};
