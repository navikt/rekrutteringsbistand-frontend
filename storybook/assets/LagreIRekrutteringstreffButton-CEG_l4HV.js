import{ao as $,h1 as B,r as p,u as z,j as e,d as k,S as A,ar as F,R as H}from"./iframe-DYYFo0EH.js";import{u as E}from"./useJobbsøkere-BlT-oSse.js";import{u as P}from"./useRekrutteringstreffOversikt-Bd0xlJ4Y.js";import{u as T}from"./KandidatSøkMarkerteContext-BhTOZfXm.js";import{S as _}from"./PersonPlus-BgEmH1ic.js";import{M as j}from"./Modal-CNZnnLcK.js";import{T as s}from"./Table-JoC5ff2C.js";import{C as y}from"./Checkbox-CJUM0Iab.js";import{L as J}from"./Link-CNFJiH9C.js";const V=a=>`${B.internUrl}/${a}/jobbsoker`,C=(a,m)=>$(V(a),m),q=({rekrutteringstreffId:a,kandidatsokKandidater:m})=>{const u=p.useRef(null),[n,h]=p.useState(!1),[i,f]=p.useState([]),{visVarsel:g}=z(),{markerteKandidater:d,fjernMarkerteKandidater:L}=T(),R=E(a),x=P(),S=()=>u.current?.showModal(),w=()=>{n||u.current?.close()},K=r=>f(t=>t.includes(r)?t.filter(o=>o!==r):[...t,r]),b=async r=>{if(!d||d.length===0||n)return;h(!0);let t=!1;const o=d.map(l=>{const c=m.find(M=>M.arenaKandidatnr===l);return c?(c.fodselsnummer,{fødselsnummer:c.fodselsnummer,fornavn:c.fornavn??null,etternavn:c.etternavn??null,kandidatnummer:c.arenaKandidatnr??null}):null}).filter(l=>l&&l.fødselsnummer);try{if(a)await C(a,o),R.mutate?.();else if(r&&r.length>0)await Promise.all(r.map(l=>C(l,o))),x.mutate();else{g({type:"info",tekst:"Velg minst ett rekrutteringstreff"}),h(!1);return}g({type:"success",tekst:`${d.length} kandidat${d.length>1?"er":""} lagret i rekrutteringstreff`}),L(),t=!0}catch(l){new H({message:"Feil ved lagring av kandidater i rekrutteringstreff",error:l}),g({type:"error",tekst:"Feil ved lagring av kandidater i rekrutteringstreff"})}finally{h(!1),t&&u.current?.close()}},v=()=>{a?b():S()};return e.jsxs(e.Fragment,{children:[e.jsx(k,{variant:"tertiary",onClick:v,icon:e.jsx(_,{"aria-hidden":!0}),disabled:d?.length===0||n,loading:n,children:a?"Legg til markerte kandidater":"Lagre i rekrutteringstreff"}),e.jsxs(j,{width:600,ref:u,onClose:()=>{n&&u.current?.showModal()},header:{heading:`Lagre ${d?.length||0} kandidat i rekrutteringstreff`},children:[e.jsx(j.Body,{children:e.jsx(A,{hooks:[x],children:r=>n?e.jsx(F,{}):e.jsx(e.Fragment,{children:e.jsxs(s,{zebraStripes:!0,children:[e.jsx(s.Header,{children:e.jsxs(s.Row,{children:[e.jsx(s.DataCell,{children:e.jsx(y,{checked:i.length===r.length,indeterminate:i.length>0&&i.length!==r.length,onChange:()=>{i.length?f([]):f(r.map(t=>t.id))},hideLabel:!0,children:"Velg alle rader"})}),e.jsx(s.HeaderCell,{scope:"col",children:"Rekrutteringstreff"})]})}),e.jsx(s.Body,{children:r.map((t,o)=>e.jsxs(s.Row,{selected:i.includes(t.id),children:[e.jsx(s.DataCell,{className:"w-3",children:e.jsx(y,{hideLabel:!0,checked:i.includes(t.id),onChange:()=>K(t.id),"aria-labelledby":`id-${t.id}`,children:" "})}),e.jsx(s.HeaderCell,{scope:"row",children:e.jsx(J,{href:`rekrutteringstreff/${t.id}`,children:t.tittel??"Ukjent tittel"})})]},t.id+o))})]})})})}),e.jsxs(j.Footer,{children:[e.jsx(k,{disabled:n||i.length===0,type:"button",size:"small",loading:n,onClick:()=>void b(i),children:"Lagre"}),e.jsx(k,{disabled:n,type:"button",size:"small",variant:"secondary",onClick:w,children:"Avbryt"})]})]})]})};q.__docgenInfo={description:"",methods:[],displayName:"LagreIRekrutteringstreffButton",props:{rekrutteringstreffId:{required:!1,tsType:{name:"string"},description:""},kandidatsokKandidater:{required:!0,tsType:{name:"Array",elements:[{name:"z.infer",elements:[{name:"KandidatSøkKandidatSchema"}],raw:"z.infer<typeof KandidatSøkKandidatSchema>"}],raw:"KandidatsokKandidat[]"},description:""}}};export{q as L};
