import{r as p,m as z,R as k,j as e,ax as F,ak as _,k as H,f as K,u as L,h as B,e as w,S as P,A as V,x as E}from"./iframe-Ejs43Sks.js";import{u as J,A as m}from"./useForespurteOmDelingAvCv-_psjc9e_.js";import{u as U}from"./KandidatlisteContext-BjpbXg5q.js";import{U as $}from"./umamiEvents-D8PysN3T.js";import{M as A}from"./Modal-BP64UtCa.js";import{T as d}from"./Table-BaoKt02T.js";import{C as q}from"./ComboboxProvider-DuxFp4uU.js";var Z=function(t,o){var l={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&o.indexOf(s)<0&&(l[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(t);a<s.length;a++)o.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(t,s[a])&&(l[s[a]]=t[s[a]]);return l};const W=p.forwardRef((t,o)=>{var{title:l,titleId:s}=t,a=Z(t,["title","titleId"]);let n=z();return n=l?s||"title-"+n:void 0,k.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 24 24",focusable:!1,role:"img",ref:o,"aria-labelledby":n},a),l?k.createElement("title",{id:n},l):null,k.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M5.75 20.25V3.75h12.5v9.75a.75.75 0 0 0 1.5 0v-10c0-.69-.56-1.25-1.25-1.25h-13c-.69 0-1.25.56-1.25 1.25v17c0 .69.56 1.25 1.25 1.25h1.742a.75.75 0 0 0 0-1.5zm5.2-14.1a.75.75 0 0 1 .15 1.05l-1.5 2a.75.75 0 0 1-1.13.08l-1-1a.75.75 0 0 1 1.06-1.06l.389.388L9.9 6.3a.75.75 0 0 1 1.05-.15M13 7.25a.75.75 0 0 0 0 1.5h2.5a.75.75 0 0 0 0-1.5zm-3.514 5.204a.75.75 0 0 1 .819-.14l9 4a.75.75 0 0 1 0 1.371l-9 4a.75.75 0 0 1-1.007-.948L10.699 17l-1.401-3.737a.75.75 0 0 1 .188-.809m1.845 1.958.689 1.838H14a.75.75 0 0 1 0 1.5h-1.98l-.69 1.838L17.154 17z",clipRule:"evenodd"}))}),S=({opprettetAvNavn:t,stillingstittel:o})=>{const l=p.useRef(null),s=p.useCallback(n=>{if(n){const c=n.contentWindow?.document,x=c?.getElementById("tittel"),u=c?.getElementById("stillingstittel"),j=c?.getElementById("avsender");x&&(x.innerText=o||"stilling"),u&&(u.innerText=o||"stilling"),j&&(j.innerHTML=t)}},[t,o]);p.useEffect(()=>{s(l.current)},[s]);const a=n=>{l.current=n,s(n)};return e.jsx("iframe",{title:"forhåndsvisning",className:"border-border-divider h-[30rem] max-h-full w-full rounded-lg border",onLoad:n=>a(n.currentTarget),src:`${F.internUrl}/template`})};S.__docgenInfo={description:"",methods:[],displayName:"ForhåndsvisningAvEpost",props:{opprettetAvNavn:{required:!0,tsType:{name:"string"},description:""},stillingstittel:{required:!1,tsType:{name:"string"},description:""}}};const G=t=>`${H.internUrl}/veileder/kandidatlister/${t}/deltekandidater`,Q=async t=>await _(G(t.kandidatlisteId),{epostMottakere:t.mailadresser,epostTekst:"",kandidater:t.kandidatnummerListe,navKontor:t.navKontor}),X=({markerteKandidater:t,sidebar:o})=>{const{track:l}=K(),[s,a]=p.useState(!1),[n,c]=p.useState(!1),{valgtNavKontor:x}=L(),{stillingsData:u}=B(),{kandidatlisteId:j,reFetchKandidatliste:D,kandidatlisteRawData:I}=U(),N=J(u.stilling.uuid),C=u.stilling.contactList?.map(i=>i.email).filter(i=>i!==null&&i.trim()!=="")||[],[f,b]=p.useState(C),M=async i=>{l($.Stilling.del_kandidat_med_arbeidsgiver,{antall:i.length}),a(!0),await Q({kandidatlisteId:j,kandidatnummerListe:i,mailadresser:f,navKontor:x?.navKontor??""}).then(()=>{a(!1),b([]),c(!1),D()})},R=i=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(i);return e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"text-nowrap",onClick:()=>c(!0),disabled:t.length===0,variant:o?"primary":"tertiary",icon:e.jsx(W,{title:"Del med arbeidsgiver"}),children:"Del CV med arbeidsgiver"}),e.jsx(A,{className:"overflow-visible",width:"medium",open:n,onClose:()=>c(!1),"aria-label":"Del kandidater med arbeidsgiver",header:{heading:"Del med arbeidsgiver"},children:e.jsx(P,{hooks:[N],children:i=>{const h=t.filter(r=>{const v=(r.aktørid&&i[r.aktørid])??null;return(v?v?.some(y=>y.svar?.harSvartJa===!0):null)?r:null}),T=h.length===t.length;return e.jsxs(e.Fragment,{children:[e.jsxs(A.Body,{className:"overflow-visible",children:[!T&&e.jsx(V,{variant:"warning",size:"small",className:"mb-4",children:e.jsxs(E,{children:[h.length===0?"Kandidaten(e) ":`${t.length-h.length} av kandidatene har `,"har ikke svart eller svart nei på om CV-en kan deles."]})}),e.jsx(m,{size:"small",headingSize:"xsmall",className:"my-4",children:e.jsxs(m.Item,{children:[e.jsx(m.Header,{children:"Vis kandidater"}),e.jsx(m.Content,{children:e.jsxs(d,{size:"small",children:[e.jsx(d.Header,{children:e.jsxs(d.Row,{children:[e.jsx(d.HeaderCell,{scope:"col",children:"Navn"}),e.jsx(d.HeaderCell,{scope:"col",children:"Fødselsnr."}),e.jsx(d.HeaderCell,{scope:"col",children:"Kan deles"})]})}),e.jsx(d.Body,{children:t?.map(({fornavn:r,etternavn:v,fodselsnr:g},y)=>e.jsxs(d.Row,{children:[e.jsxs(d.HeaderCell,{scope:"row",children:[r," ",v]}),e.jsx(d.DataCell,{children:g}),e.jsx(d.DataCell,{children:g&&h.some(O=>O.fodselsnr===g)?"Ja":"Nei"})]},y))})]})})]})}),e.jsx(E,{children:"Send en e-post med kandidater med arbeidsgiveren."}),e.jsx(q,{className:"my-4 ",allowNewValues:!0,label:"E-post til arbeidsgiver",options:C,selectedOptions:f,shouldAutocomplete:!1,isMultiSelect:!0,onToggleSelected:(r,v)=>{v?R(r)&&b([...f,r]):b(f.filter(g=>g!==r))}}),e.jsx(m,{children:e.jsxs(m.Item,{children:[e.jsx(m.Header,{children:"Forhåndsvis e-posten"}),e.jsx(m.Content,{children:e.jsx(S,{stillingstittel:u.stilling.title,opprettetAvNavn:I.opprettetAv.navn})})]})})]}),e.jsxs(A.Footer,{children:[e.jsx(w,{variant:"secondary",onClick:()=>c(!1),children:"Avbryt"}),e.jsx(w,{loading:s,disabled:h.length===0||f.length===0,variant:"primary",onClick:()=>M(h.map(r=>r.kandidatnr).filter(r=>r!==null)),children:"Del kandidatene"})]})]})}})})]})};X.__docgenInfo={description:"",methods:[],displayName:"DelMedArbeidsgiver",props:{markerteKandidater:{required:!0,tsType:{name:"Array",elements:[{name:"z.infer",elements:[{name:"kandidaterSchema"}],raw:"z.infer<typeof kandidaterSchema>"}],raw:"KandidatListeKandidatDTO[]"},description:""},sidebar:{required:!1,tsType:{name:"boolean"},description:""}}};export{X as D,S as F};
