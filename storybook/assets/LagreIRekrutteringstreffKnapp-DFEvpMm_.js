import{r as p,bh as $,u as z,bi as H,bj as _,j as e,d as g,S as B,ad as E,bk as b,E as T}from"./iframe-jqaI6nix.js";import{u as A}from"./KandidatSøkMarkerteContext-VO3_lRjv.js";import{S as P}from"./PersonPlus-B1MuCQf2.js";import{M as k}from"./Modal-B-RDzvQt.js";import{T as t}from"./Table-D4pNq3sZ.js";import{a as y}from"./Checkbox-BbBByMyr.js";import{L as V}from"./Link-B0wBbhpE.js";const q=({rekrutteringstreffId:i,kandidatsokKandidater:K})=>{const u=p.useRef(null),[r,h]=p.useState(!1),[s,m]=p.useState([]),L=$(),{visVarsel:f}=z(),{markerteKandidater:d,fjernMarkerteKandidater:C}=A(),S=H(i),j=_(),w=()=>u.current?.showModal(),R=()=>{r||u.current?.close()},v=n=>m(a=>a.includes(n)?a.filter(o=>o!==n):[...a,n]),x=async n=>{if(!d||d.length===0||r)return;h(!0);let a=!1;const o=d.map(l=>{const c=K.find(F=>F.arenaKandidatnr===l);return c?(c.fodselsnummer,{fødselsnummer:c.fodselsnummer,fornavn:c.fornavn??null,etternavn:c.etternavn??null,kandidatnummer:c.arenaKandidatnr??null}):null}).filter(l=>l&&l.fødselsnummer);try{if(i)await b(i,o),S.mutate?.();else if(n&&n.length>0)await Promise.all(n.map(l=>b(l,o))),j.mutate();else{f({type:"info",tekst:"Velg minst ett rekrutteringstreff"}),h(!1);return}f({type:"success",tekst:`${d.length} kandidat${d.length>1?"er":""} lagret i rekrutteringstreff`}),C(),a=!0,i&&L.push(`/rekrutteringstreff/${i}?visFane=jobbsøkere`)}catch(l){new T({message:"Feil ved lagring av kandidater i rekrutteringstreff",error:l}),f({type:"error",tekst:"Feil ved lagring av kandidater i rekrutteringstreff"})}finally{h(!1),a&&u.current?.close()}},M=()=>{i?x():w()};return e.jsxs(e.Fragment,{children:[e.jsx(g,{variant:"tertiary",onClick:M,icon:e.jsx(P,{"aria-hidden":!0}),disabled:d?.length===0||r,loading:r,children:i?"Legg til jobbsøkere og fullfør":"Lagre i rekrutteringstreff"}),e.jsxs(k,{width:600,ref:u,onClose:()=>{r&&u.current?.showModal()},header:{heading:`Lagre ${d?.length||0} kandidat i rekrutteringstreff`},children:[e.jsx(k.Body,{children:e.jsx(B,{hooks:[j],children:n=>r?e.jsx(E,{}):e.jsx(e.Fragment,{children:e.jsxs(t,{zebraStripes:!0,children:[e.jsx(t.Header,{children:e.jsxs(t.Row,{children:[e.jsx(t.DataCell,{children:e.jsx(y,{checked:s.length===n.length,indeterminate:s.length>0&&s.length!==n.length,onChange:()=>{s.length?m([]):m(n.map(a=>a.id))},hideLabel:!0,children:"Velg alle rader"})}),e.jsx(t.HeaderCell,{scope:"col",children:"Rekrutteringstreff"})]})}),e.jsx(t.Body,{children:n.map((a,o)=>e.jsxs(t.Row,{selected:s.includes(a.id),children:[e.jsx(t.DataCell,{className:"w-3",children:e.jsx(y,{hideLabel:!0,checked:s.includes(a.id),onChange:()=>v(a.id),"aria-labelledby":`id-${a.id}`,children:" "})}),e.jsx(t.HeaderCell,{scope:"row",children:e.jsx(V,{href:`rekrutteringstreff/${a.id}`,children:a.tittel??"Ukjent tittel"})})]},a.id+o))})]})})})}),e.jsxs(k.Footer,{children:[e.jsx(g,{disabled:r||s.length===0,type:"button",size:"small",loading:r,onClick:()=>void x(s),children:"Lagre"}),e.jsx(g,{disabled:r,type:"button",size:"small",variant:"secondary",onClick:R,children:"Avbryt"})]})]})]})};q.__docgenInfo={description:"",methods:[],displayName:"LagreIRekrutteringstreffKnapp",props:{rekrutteringstreffId:{required:!1,tsType:{name:"string"},description:""},kandidatsokKandidater:{required:!0,tsType:{name:"Array",elements:[{name:"z.infer",elements:[{name:"KandidatSøkKandidatSchema"}],raw:"z.infer<typeof KandidatSøkKandidatSchema>"}],raw:"KandidatsokKandidat[]"},description:""}}};export{q as L};
