import{h4 as P,hF as j,r as y,j as e,H as k,aP as E,B as I,hb as _,a0 as M,e as z,Y as G}from"./iframe-CGQVJkZv.js";import{b as A}from"./useAutosave-CHdaxfUe.js";import{u as H}from"./usePamPostdata-B-mYfJ2i.js";import{T as N}from"./TextField-DDMQglYu.js";import{T as X,S as q}from"./TidspunktForm-VCDJmJL6.js";import{K as W}from"./KiAnalyse-DN5V2c9Q.js";import{K as Y}from"./KiAnalysePanel-D7WNWaRh.js";import{u as $}from"./useFormFeltMedKiValidering-D0FjtJp3.js";import{M as b}from"./mutations-ButWvaNd.js";import{S as J}from"./Skeleton-1ERJl7II.js";import{T as Q}from"./Tag-BYGMQyUB.js";const r={GATEADRESSE:"gateadresse",POSTNUMMER:"postnummer",POSTSTED:"poststed"},R=({control:s})=>{const{setValue:l,clearErrors:o,setError:T,trigger:S}=P(),{save:g}=A(),a=j({control:s,name:r.POSTNUMMER}),{data:d,isLoading:m}=H(a||"");return y.useEffect(()=>{!a||a.length!==4||m||(d?.korrigertNavnBy?(l(r.POSTSTED,d.korrigertNavnBy,{shouldDirty:!0,shouldValidate:!0}),o(r.POSTSTED)):(l(r.POSTSTED,"",{shouldDirty:!0,shouldValidate:!0}),T(r.POSTSTED,{type:"manual",message:"Ukjent poststed"})))},[a,m,d,l,T,o]),e.jsxs("div",{className:"space-y-4",children:[e.jsx(k,{level:"3",size:"small",children:"Sted"}),e.jsx(E,{name:r.GATEADRESSE,control:s,render:({field:n,fieldState:u})=>e.jsx(N,{...n,value:n.value??"",label:"Gateadresse",error:u.error?.message,onBlur:()=>{n.onBlur(),g([r.GATEADRESSE])}})}),e.jsxs("div",{className:"flex gap-4 items-start",children:[e.jsx(E,{name:r.POSTNUMMER,control:s,render:({field:n,fieldState:u})=>e.jsx(N,{...n,value:n.value??"",label:"Postnummer",htmlSize:12,error:u.error?.message,onChange:p=>{const c=p.target.value.replace(/\D/g,"");o([r.POSTNUMMER,r.POSTSTED]),l(r.POSTSTED,"",{shouldDirty:!1,shouldValidate:!0}),c.length<=4&&n.onChange(c),c.length===4&&S([r.POSTNUMMER])},onBlur:()=>{n.onBlur(),g([r.POSTNUMMER,r.POSTSTED])}})}),e.jsx(I,{className:`pt-8 ${j({control:s,name:r.POSTSTED})?"":"aksel-error-message"}`,children:j({control:s,name:r.POSTSTED})||(a&&a.length===4&&!m?"Ukjent poststed":"")})]})]})};R.__docgenInfo={description:"",methods:[],displayName:"StedForm"};const Z=()=>{const{control:s}=P();return e.jsxs("div",{className:"space-y-8",children:[e.jsx(k,{level:"2",size:"medium",children:"Praktiske forhold"}),e.jsx(X,{control:s}),e.jsx(q,{control:s}),e.jsx(R,{control:s})]})};Z.__docgenInfo={description:"",methods:[],displayName:"PraktiskeForhold"};const O="Treff uten navn",B=({onUpdated:s})=>{const{treff:l,harPublisert:o}=_(),T=l?l.tittel??null:void 0,{clearErrors:S,formState:{isSubmitting:g}}=P(),a=y.useRef(null),{save:d}=A(),{analyse:m,analyseError:n,validating:u,kiErrorBorder:p,harGodkjentKiFeil:c,showAnalysis:V,erRedigeringAvPublisertTreff:C,runValidationAndMaybeSave:D,onGodkjennKiFeil:K,watchedValue:v,control:L,setValue:F,kiLoggLoading:x}=$({feltType:"tittel",fieldName:"tittel",savedValue:T,saveCallback:d,onUpdated:s}),U=b-(typeof v=="string"?v.length:0),w=()=>{F("tittel","",{shouldValidate:!0,shouldDirty:!0,shouldTouch:!0}),a.current?.focus()};return y.useEffect(()=>{if(!l||x)return;const i=!o,h=(v??"").trim(),t=h.length===0||h===O;if(i&&t&&a.current){const f=setTimeout(()=>{a.current?.focus()},100);return()=>clearTimeout(f)}},[l,x,o]),e.jsxs("section",{className:"space-y-3",children:[x&&e.jsx(J,{variant:"text"}),!x&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{level:"2",size:"medium",children:"Navn på treffet"}),e.jsx(Q,{variant:"alt1",size:"medium",children:"KI-støtte"})]}),e.jsxs(M,{className:"text-[var(--ax-text-neutral-subtle)]",children:["Ikke skriv ",e.jsx("u",{children:"personopplysninger"})," og ",e.jsx("u",{children:"diskriminerende"})," ","innhold."]}),e.jsxs("div",{className:"relative w-full",children:[v&&e.jsx(z,{type:"button",onClick:w,"aria-label":"Tøm tittel feltet",variant:"tertiary",size:"small",className:"absolute right-2 top-[2rem] -translate-y-1/2 h-8 p-1",title:"Tøm feltet",children:e.jsx(G,{"aria-hidden":!0,fontSize:"1.25rem"})}),e.jsx("div",{className:"flex items-start",children:e.jsx(E,{control:L,name:"tittel",render:({field:i,fieldState:h})=>e.jsx(N,{...i,value:i.value??"",ref:t=>{i.ref(t),a.current=t},label:"Navn på treffet",hideLabel:!0,maxLength:b,className:"w-full pt-2",error:h.error?.message||(p?"Brudd på retningslinjer":void 0),"aria-invalid":!!(h.error||p),autoComplete:"off",autoCorrect:"off",spellCheck:!1,onChange:t=>{i.onChange(t),t.target.value.trim().length>0&&S("tittel")},onBlur:async()=>{i.onBlur(),setTimeout(async()=>{!u&&!g&&await D()},0)},onFocus:()=>{const t=i.value;if(!t||typeof t!="string")return;t.trim()===O&&F("tittel","",{shouldValidate:!1,shouldDirty:!1,shouldTouch:!1})},onKeyDown:t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),(async()=>{const f=t.currentTarget;await D(),f?.blur()})())}})})})]}),e.jsxs(M,{className:"text-gray-400",children:[U," tegn igjen"]}),e.jsx(W,{}),e.jsx(Y,{validating:u,analyse:m,analyseError:n,harGodkjentKiFeil:c,showAnalysis:V,erRedigeringAvPublisertTreff:C,onGodkjennKiFeil:K,ariaLabel:"Analyse av tittel"})]})]})};B.displayName="TittelForm";B.__docgenInfo={description:"",methods:[],displayName:"TittelForm",props:{onUpdated:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{Z as P,R as S,B as T};
