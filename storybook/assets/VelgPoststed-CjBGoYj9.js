import{h4 as F,d as q,il as z,r as c,j as t,x as L,e as b,Y as N,aP as T,B}from"./iframe-Dbv-ZY6m.js";import{B as $}from"./Box-BukE00JN.js";import{T as k}from"./TextField-BdcLrO50.js";import{S as D}from"./Plus-D-XUQHMz.js";import{u as O,G as w}from"./usePamGeografi-Ce4owbln.js";import{a as h}from"./util-zb_msfsb.js";import{C as G}from"./ComboboxProvider-CEuHV2Eh.js";import{u as I}from"./usePamPostdata-B58PYVA6.js";function K(){const{control:g,register:m,getValues:d,formState:{errors:i}}=F(),f=q(),{fields:u,append:r,remove:x}=z({control:g,name:"stilling.contactList"}),l=c.useRef(!1);return c.useEffect(()=>{if(!l.current){if(u.length===0){const n=f?.stillingsData?.stilling?.contactList??[];n.length>0?n.forEach(a=>r({name:a.name??"",title:a.title??"",email:a.email??"",phone:a.phone??""})):r({name:"",title:"",email:"",phone:""})}l.current=!0}},[]),t.jsxs("div",{className:"flex flex-col gap-4",children:[u.map((n,a)=>{const o=`stilling.contactList.${a}`,e=i?.stilling?.contactList?.[a]??{};return t.jsxs($.New,{background:"neutral-moderate",padding:"3",borderRadius:"large",className:"flex flex-col gap-3",children:[t.jsxs("div",{className:"py-1 flex justify-between items-start",children:[t.jsxs(L,{className:"font-semibold",children:["Kontakt ",a+1]}),t.jsx(b,{size:"small",type:"button",variant:"tertiary",icon:t.jsx(N,{}),disabled:u.length===1,onClick:()=>x(a),title:"fjern",children:"Fjern"})]}),t.jsx(k,{label:"Navn",...m(`${o}.name`),error:e?.name?.message}),t.jsx(k,{label:"Tittel",...m(`${o}.title`),error:e?.title?.message}),t.jsx(L,{children:"Velg hvordan de kan nÃ¥s (minst en)"}),t.jsx(k,{label:"E-post",type:"email",...m(`${o}.email`,{validate:p=>{const y=d(`${o}.phone`);return!p&&!y?"Fyll inn e-post eller telefon":!0}}),error:e?.email?.message}),t.jsx(k,{label:"Telefonnummer",type:"tel",...m(`${o}.phone`,{validate:p=>{const y=d(`${o}.email`);return!p&&!y?"Fyll inn telefon eller e-post":!0}}),error:e?.phone?.message})]},n.id)}),t.jsx("div",{children:t.jsx(b,{type:"button",variant:"tertiary",icon:t.jsx(D,{}),size:"small",onClick:()=>r({name:"",title:"",email:"",phone:""}),children:"Legg til kontaktperson"})})]})}K.__docgenInfo={description:"",methods:[],displayName:"LeggTilKontaktperson"};const M=({lokasjoner:g,leggTilLokasjon:m,fjernLokasjonId:d})=>{const i=O(),[f,u]=c.useState([]),[r,x]=c.useState(""),[l,n]=c.useState(!1),a=g;c.useEffect(()=>{r.length>1&&u([...i.data?.filter(e=>e.type===w.KOMMUNE).filter(e=>e.navn.toLowerCase().includes(r.toLocaleLowerCase())).map(e=>`${h(e.navn)} (kommune)`)??[],...i.data?.filter(e=>e.type===w.FYLKE).filter(e=>e.navn.toLowerCase().includes(r.toLocaleLowerCase())).map(e=>`${h(e.navn)} (fylke)`)??[],...i.data?.filter(e=>e.type===w.LAND)?.filter(e=>e.navn.toLowerCase().includes(r.toLocaleLowerCase())).map(e=>`${h(e.navn)} (land)`)??[]])},[i.data,r]);const o=(e,p)=>{const y=e.match(/\(([^)]+)\)$/),v=y?y[1]:"",P=e.replace(/\s*\([^)]*\)$/,"").trim(),s=i.data?.filter(j=>j.type.toLowerCase()===v.toLowerCase()).find(j=>j.navn.toLowerCase()===P.toLowerCase());if(p&&s)m({address:s.lokasjon.adresse,postalCode:null,city:s.lokasjon.poststed,county:s.lokasjon.fylke,municipal:s.lokasjon.kommune,municipalCode:s.lokasjon.kommunenummer,country:s.lokasjon.land});else{const j=a.find(C=>{const S=s?.lokasjon.kommune&&C.municipal===s.lokasjon.kommune,V=s?.lokasjon.fylke&&C.county===s.lokasjon.fylke,E=s?.lokasjon.land&&C.country===s.lokasjon.land;return v.toLowerCase()==="kommune"?S:v.toLowerCase()==="fylke"?V:v.toLowerCase()==="land"?E:!1});j?.id&&d(j.id)}};return t.jsx(G,{isListOpen:l,disabled:i.isLoading,toggleListButton:!1,selectedOptions:a.map(e=>e.municipal?`${h(e.municipal)} (kommune)`:e.county?`${h(e.county)} (fylke)`:e.country?`${h(e.country)} (land)`:""),onChange:e=>{n(e.length>0),x(e)},onToggleSelected:(e,p)=>{o(e,p)},label:"",description:"Du kan velge flere kommuner, fylker eller land",options:f,isMultiSelect:!0})};M.__docgenInfo={description:"",methods:[],displayName:"VelgKommuneFylkeEllerLand",props:{lokasjoner:{required:!0,tsType:{name:"Array",elements:[{name:"GeografiDTOmedId"}],raw:"GeografiDTOmedId[]"},description:""},leggTilLokasjon:{required:!0,tsType:{name:"signature",type:"function",raw:"(lokasjon: GeografiDTO) => void",signature:{arguments:[{type:{name:"z.infer",elements:[{name:"LocationSchema"}],raw:"z.infer<typeof LocationSchema>"},name:"lokasjon"}],return:{name:"void"}}},description:""},fjernLokasjonId:{required:!0,tsType:{name:"signature",type:"function",raw:"(id: string) => void",signature:{arguments:[{type:{name:"string"},name:"id"}],return:{name:"void"}}},description:""}}};const _=({control:g,lokasjonsFelt:m,index:d,fjern:i,oppdaterPoststed:f,postSted:u})=>{const[r,x]=c.useState(""),l=I(r);return c.useEffect(()=>{if(!l.isLoading){const n=l.data?.korrigertNavnBy;l.data&&n&&n!==u&&f(l.data)}},[l,u,f,d]),t.jsx($.New,{background:"neutral-moderate",padding:"3",borderRadius:"large",children:t.jsxs("div",{children:[t.jsxs("div",{className:"py-3 flex justify-between",children:[t.jsxs(L,{children:["Adresse ",d+1]}),t.jsx("div",{children:t.jsx(b,{size:"small",type:"button",variant:"tertiary",icon:t.jsx(N,{}),onClick:()=>i(),title:"fjern",children:"Fjern"})})]}),t.jsxs("div",{className:"flex flex-col gap-4",children:[t.jsx(T,{name:`${m}.${d}.address`,control:g,render:({field:n})=>t.jsx(k,{label:"Gateadresse",...n,value:n.value||""})}),t.jsxs("div",{className:"flex flex-row gap-4 justify-baseline",children:[t.jsx("div",{className:"w-32",children:t.jsx(T,{name:`${m}.${d}.postalCode`,control:g,render:({field:n})=>t.jsx(k,{label:"Postnummer",type:"number",maxLength:4,...n,value:n.value||"",onChange:a=>{x(a.target.value);const o=a.target.value.replace(/\D/g,"");o.length<=4&&n.onChange(o)}})})}),t.jsxs("div",{className:"flex-1",children:[t.jsx(B,{weight:"semibold",children:"Poststed"}),t.jsx("div",{className:"mt-4",children:t.jsx(L,{children:u})})]})]})]})]})})};_.__docgenInfo={description:"",methods:[],displayName:"VelgPoststed",props:{control:{required:!0,tsType:{name:"Control",elements:[{name:"any"}],raw:"Control<any>"},description:""},lokasjonsFelt:{required:!0,tsType:{name:"string"},description:""},index:{required:!0,tsType:{name:"number"},description:""},fjern:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},oppdaterPoststed:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: PamPostdataDTO) => void",signature:{arguments:[{type:{name:"z.infer",elements:[{name:"PostdataSchema"}],raw:"z.infer<typeof PostdataSchema>"},name:"value"}],return:{name:"void"}}},description:""},postSted:{required:!0,tsType:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}]},description:""}}};export{K as L,_ as V,M as a};
