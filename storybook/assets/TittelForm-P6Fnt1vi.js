import{b0 as j,bE as p,bL as z,r as F,j as e,H as N,C as E,B as G,a_ as H,bb as X,bB as q,bM as b,d as W,ah as $,ap as J,f as Q}from"./iframe-BXziY_Zi.js";import{b as R}from"./useAutosave-DEGCgcg-.js";import{T as x}from"./TextField-BsVmJ4PS.js";import{T as Y,S as Z}from"./TidspunktForm--eeIg-Sa.js";import{K as ee}from"./KiAnalyse-BvaCJ7lK.js";import{K as te}from"./KiAnalysePanel-Cs98fY7E.js";import{u as se}from"./useKiAnalyse-D8AHlyta.js";import{S as re}from"./Skeleton-B7ynU7FB.js";const t={GATEADRESSE:"gateadresse",POSTNUMMER:"postnummer",POSTSTED:"poststed"},A=({control:r})=>{const{setValue:o,clearErrors:u,setError:f,trigger:S}=j(),{save:d}=R(),n=p({control:r,name:t.POSTNUMMER}),{data:i,isLoading:c}=z(n||"");return F.useEffect(()=>{!n||n.length!==4||c||(i?.korrigertNavnBy?(o(t.POSTSTED,i.korrigertNavnBy,{shouldDirty:!0,shouldValidate:!0}),u(t.POSTSTED)):(o(t.POSTSTED,"",{shouldDirty:!0,shouldValidate:!0}),f(t.POSTSTED,{type:"manual",message:"Ukjent poststed"})))},[n,c,i,o,f,u]),e.jsxs("div",{className:"space-y-4",children:[e.jsx(N,{level:"3",size:"small",children:"Sted"}),e.jsx(E,{name:t.GATEADRESSE,control:r,render:({field:a,fieldState:g})=>e.jsx(x,{...a,value:a.value??"",label:"Gateadresse",error:g.error?.message,onBlur:()=>{a.onBlur(),d([t.GATEADRESSE])}})}),e.jsxs("div",{className:"flex gap-4 items-start",children:[e.jsx(E,{name:t.POSTNUMMER,control:r,render:({field:a,fieldState:g})=>e.jsx(x,{...a,value:a.value??"",label:"Postnummer",htmlSize:12,error:g.error?.message,onChange:v=>{const m=v.target.value.replace(/\D/g,"");u([t.POSTNUMMER,t.POSTSTED]),o(t.POSTSTED,"",{shouldDirty:!1,shouldValidate:!0}),m.length<=4&&a.onChange(m),m.length===4&&S([t.POSTNUMMER])},onBlur:()=>{a.onBlur(),d([t.POSTNUMMER,t.POSTSTED])}})}),e.jsx(G,{className:`pt-8 ${p({control:r,name:t.POSTSTED})?"":"aksel-error-message"}`,children:p({control:r,name:t.POSTSTED})||(n&&n.length===4&&!c?"Ukjent poststed":"")})]})]})};A.__docgenInfo={description:"",methods:[],displayName:"StedForm"};const ae=()=>{const{control:r}=j();return e.jsxs("div",{className:"space-y-8",children:[e.jsx(N,{level:"2",size:"medium",children:"Praktiske forhold"}),e.jsx(Y,{control:r}),e.jsx(Z,{control:r}),e.jsx(A,{control:r})]})};ae.__docgenInfo={description:"",methods:[],displayName:"PraktiskeForhold"};const ne="Treff uten navn",M=({onUpdated:r})=>{const{rekrutteringstreffId:o}=H(),{treff:u}=X(),f=u?u.tittel??null:void 0,{setLagret:S,isLoading:d}=q(o,"tittel"),{control:n,setValue:i,getValues:c,trigger:a,clearErrors:g,formState:{isSubmitting:v}}=j(),m=F.useRef(null),h=p({control:n,name:"tittel"}),O=b-(typeof h=="string"?h.length:0),{save:B}=R(),L=async l=>{try{await B(["tittel"],l)}catch(T){new Q({message:"Lagring av tittel feilet.",error:T})}finally{r?.()}},{analyse:C,analyseError:K,validating:k,kiErrorBorder:D,forceSave:w,showAnalysis:V,erRedigeringAvPublisertTreff:U,runValidationAndMaybeSave:P,onForceSave:_}=se({feltType:"tittel",fieldName:"tittel",watchedValue:h,triggerRHF:a,getValues:c,setValue:i,setKiFeilFieldName:"tittelKiFeil",saveCallback:L,setKiLagret:S,setKiSjekketFieldName:"tittelKiSjekket",savedValue:f}),I=()=>{i("tittel","",{shouldValidate:!0,shouldDirty:!0,shouldTouch:!0}),m.current?.focus()};return e.jsxs("section",{className:"space-y-3",children:[d&&e.jsx(re,{variant:"text"}),!d&&e.jsxs(e.Fragment,{children:[e.jsx(N,{level:"2",size:"medium",children:"Navn på treffet"}),e.jsxs("div",{className:"relative w-full",children:[h&&e.jsx(W,{type:"button",onClick:I,"aria-label":"Tøm tittel feltet",variant:"tertiary",size:"small",className:"absolute right-2 top-[2rem] -translate-y-1/2 h-8 p-1",title:"Tøm feltet",children:e.jsx($,{"aria-hidden":!0,fontSize:"1.25rem"})}),e.jsx("div",{className:"flex items-start",children:e.jsx(E,{control:n,name:"tittel",render:({field:l,fieldState:T})=>e.jsx(x,{...l,value:l.value??"",ref:s=>{l.ref(s),m.current=s},label:"Navn på treffet",hideLabel:!0,maxLength:b,className:"w-full pt-2",error:T.error?.message||(D?"Brudd på retningslinjer":void 0),"aria-invalid":!!(T.error||D),autoComplete:"off",autoCorrect:"off",spellCheck:!1,onChange:s=>{l.onChange(s),s.target.value.trim().length>0&&g("tittel")},onBlur:async()=>{l.onBlur(),setTimeout(async()=>{!k&&!v&&await P()},0)},onFocus:()=>{const s=l.value;if(!s||typeof s!="string")return;s.trim()===ne&&i("tittel","",{shouldValidate:!1,shouldDirty:!1,shouldTouch:!1})},onKeyDown:s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),(async()=>{const y=s.currentTarget;await P(),y?.blur()})())}})})})]}),e.jsxs(J,{className:"text-gray-400",children:[O," tegn igjen"]}),e.jsx(ee,{}),e.jsx(te,{validating:k,analyse:C,analyseError:K,forceSave:w,showAnalysis:V,erRedigeringAvPublisertTreff:U,onForceSave:_,ariaLabel:"Analyse av tittel"})]})]})};M.displayName="TittelForm";M.__docgenInfo={description:"",methods:[],displayName:"TittelForm",props:{onUpdated:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{ae as P,A as S,M as T};
