import{r as p,aO as j,j as e,e as a,aP as h,w as m}from"./iframe-05oBaVfn.js";import{o as v,a as b}from"./nyhet-admin-DwCmd-JH.js";import{R as w}from"./RikTekstEditor-CNhkI7RQ.js";import{S as k}from"./Pencil-BOV4gfCh.js";import{M as s}from"./Modal-BVQTtIOQ.js";import{T as E}from"./TextField-BpSkih8q.js";function S({eksisterendeNyhet:r,refetch:u}){const n=p.useRef(null),[i,l]=p.useState(!1),{control:d,handleSubmit:f,reset:c,formState:{errors:x}}=j({defaultValues:r||{tittel:"",innhold:""}}),y=async t=>{if(r){const o={...r,...t};l(!0);try{await v(o)}catch(g){throw new m({message:"Noe gikk galt ved oppdatering av nyhet",error:g})}}else try{await b(t)}catch(o){throw new m({message:"Noe gikk galt ved oppretting av nyhet",error:o})}u(),l(!1),n.current?.close(),c()};return e.jsxs("div",{children:[r?e.jsx(a,{onClick:()=>n.current?.showModal(),variant:"tertiary",icon:e.jsx(k,{}),children:"Endre"}):e.jsx(a,{size:"small",onClick:()=>n.current?.showModal(),children:r?"Oppdater nyhet":"Opprett nyhet"}),e.jsx(s,{className:"w-full",ref:n,header:{heading:r?"Oppdater nyhet":"Opprett ny nyhet"},children:e.jsxs("form",{onSubmit:f(y),children:[e.jsx(s.Body,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx(h,{name:"tittel",control:d,rules:{required:"Tittel er pÃ¥krevd"},render:({field:t})=>e.jsx(E,{...t,label:"Tittel",error:x.tittel?.message})}),e.jsxs("div",{children:[e.jsx("label",{className:"navds-label mb-2 block",children:"Innhold"}),e.jsx(h,{name:"innhold",control:d,render:({field:t})=>e.jsx(w,{utviklerExtensions:!0,id:"oppdater-nyhet",tekst:t.value??"",onChange:t.onChange})})]})]})}),e.jsxs(s.Footer,{children:[e.jsx(a,{loading:i,type:"submit",children:"Oppdater nyhet"}),e.jsx(a,{loading:i,type:"button",variant:"secondary",onClick:()=>{c(),n.current?.close()},children:"Avbryt"})]})]})})]})}S.__docgenInfo={description:"",methods:[],displayName:"EndreNyhetModal",props:{eksisterendeNyhet:{required:!1,tsType:{name:"z.infer",elements:[{name:"nyheterSchema"}],raw:"z.infer<typeof nyheterSchema>"},description:""},refetch:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{S as E};
