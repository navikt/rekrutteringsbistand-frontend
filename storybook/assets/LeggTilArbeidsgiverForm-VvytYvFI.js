import{j as e,H as E,B as T,r as s,at as C,d as A,b6 as P,L as B,b2 as L,b3 as I,b9 as _,bb as N,E as R,S as H,ba as V}from"./iframe-BA8lGxgc.js";import{e as D}from"./util-Cu4x6vVJ.js";import{c as W}from"./stilling-util-BjBixF7p.js";import{B as $}from"./Box-BxtLu52g.js";import{T as K}from"./Tag-CYMsqiOQ.js";import{S as J}from"./Trash-C1yt_cag.js";import{M as S}from"./Modal-FL_hfnIr.js";import{C as X}from"./ComboboxProvider-2RS3xeRh.js";import{H as G}from"./VStack-DqzLThnb.js";const w=({navn:d,adresse:a,status:o,organisasjonsnummer:l,actionSlot:u})=>{const m=[a?.adresse,[a?.postnummer,a?.poststed].filter(Boolean).join(" "),a?.kommune].filter(c=>c&&String(c).trim().length>0).join(", ");return e.jsxs($.New,{background:"neutral-softA",borderRadius:"xlarge",padding:"4",marginBlock:"2",className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(E,{level:"3",size:"xsmall",children:W(d||"")}),e.jsxs(T,{size:"small",className:"mt-1",children:[l&&e.jsxs(e.Fragment,{children:["Org.nr. ",l,m?"  ":""]}),m]})]}),e.jsxs("div",{className:"ml-2 flex items-center gap-2 self-start",children:[o&&e.jsx(K,{size:"medium",variant:"info",children:D(o)}),u]})]})};w.__docgenInfo={description:"",methods:[],displayName:"ArbeidsgiverKort",props:{organisasjonsnummer:{required:!0,tsType:{name:"string"},description:""},navn:{required:!0,tsType:{name:"string"},description:""},organisasjonsform:{required:!1,tsType:{name:"string"},description:""},antallAnsatte:{required:!1,tsType:{name:"number"},description:""},adresse:{required:!1,tsType:{name:"union",raw:"ArbeidsgiverAdresse | null",elements:[{name:"signature",type:"object",raw:`{
  adresse?: string;
  postnummer?: string;
  poststed?: string;
  kommune?: string;
  kommunenummer?: string;
  land?: string;
  landkode?: string;
}`,signature:{properties:[{key:"adresse",value:{name:"string",required:!1}},{key:"postnummer",value:{name:"string",required:!1}},{key:"poststed",value:{name:"string",required:!1}},{key:"kommune",value:{name:"string",required:!1}},{key:"kommunenummer",value:{name:"string",required:!1}},{key:"land",value:{name:"string",required:!1}},{key:"landkode",value:{name:"string",required:!1}}]}},{name:"null"}]},description:""},status:{required:!1,tsType:{name:"string"},description:""},naringskoder:{required:!1,tsType:{name:"union",raw:"naringskode[] | null",elements:[{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  kode?: string;
  beskrivelse?: string;
}`,signature:{properties:[{key:"kode",value:{name:"string",required:!1}},{key:"beskrivelse",value:{name:"string",required:!1}}]}}],raw:"naringskode[]"},{name:"null"}]},description:""},actionSlot:{required:!1,tsType:{name:"ReactNode"},description:""}}};const F=({navn:d,loading:a,disabled:o,onConfirm:l,onCancel:u,onAfterClose:m,onOpen:c,arbeidsgivereHook:y,variant:p="trash",triggerLabel:i,triggerAriaLabel:f,renderTrigger:t})=>{const h=s.useRef(null),[v,b]=s.useState(null),j=s.useCallback(()=>{b("close")},[]),k=s.useCallback(()=>{o||a||(c?.(),b("open"))},[o,a,c]),q=s.useCallback(async()=>{await Promise.resolve(l()),y.mutate(),j()},[l,y,j]),r=s.useCallback(()=>{a||(u?.(),j())},[a,u,j]),n=s.useMemo(()=>p==="cross"?e.jsx(C,{"aria-hidden":!0}):e.jsx(J,{"aria-hidden":!0}),[p]),g=!!a||!!o;s.useEffect(()=>{if(!v)return;const x=h.current,O=setTimeout(()=>{if(!x){b(null);return}v==="open"?x.showModal():(x.close(),m?.()),b(null)},0);return()=>clearTimeout(O)},[v,m]);const M=s.useMemo(()=>{const x=p==="cross"?e.jsx(A,{size:"xsmall",variant:"tertiary",icon:n,onClick:k,"aria-label":f||i||"Fjern arbeidsgiver fra treffet",disabled:g}):e.jsx(A,{size:"small",variant:"tertiary",icon:n,onClick:k,disabled:g,children:i||"Slett"});return t?t({button:x,open:k,disabled:g}):x},[t,p,n,k,g,f,i]);return e.jsxs(e.Fragment,{children:[M,e.jsxs(S,{ref:h,header:{heading:"Slett arbeidsgiver"},children:[e.jsx(S.Body,{children:d&&e.jsxs(T,{children:["Er du sikker på at du vil slette ",d," fra dette rekrutteringstreffet?"]})}),e.jsxs(S.Footer,{children:[e.jsx(A,{variant:"danger",onClick:q,loading:!!a,disabled:!!a,children:"Slett"}),e.jsx(A,{variant:"secondary",onClick:r,disabled:!!a,children:"Avbryt"})]})]})]})};F.__docgenInfo={description:"",methods:[],displayName:"SlettArbeidsgiverModal",props:{navn:{required:!1,tsType:{name:"string"},description:""},loading:{required:!1,tsType:{name:"boolean"},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:""},onConfirm:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void | Promise<void>",signature:{arguments:[],return:{name:"union",raw:"void | Promise<void>",elements:[{name:"void"},{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}]}}},description:""},onCancel:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onAfterClose:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onOpen:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},arbeidsgivereHook:{required:!0,tsType:{name:"Pick",elements:[{name:"SWRResponse",elements:[{name:"z.infer",elements:[{name:"ArbeidsgivereSchema"}],raw:"z.infer<typeof ArbeidsgivereSchema>"}],raw:"SWRResponse<ArbeidsgivereDTO>"},{name:"literal",value:"'mutate'"}],raw:"Pick<SWRResponse<ArbeidsgivereDTO>, 'mutate'>"},description:""},variant:{required:!1,tsType:{name:"union",raw:"'trash' | 'cross'",elements:[{name:"literal",value:"'trash'"},{name:"literal",value:"'cross'"}]},description:"",defaultValue:{value:"'trash'",computed:!1}},triggerLabel:{required:!1,tsType:{name:"string"},description:""},triggerAriaLabel:{required:!1,tsType:{name:"string"},description:""},renderTrigger:{required:!1,tsType:{name:"signature",type:"function",raw:`(args: {
  button: ReactNode;
  open: () => void;
  disabled: boolean;
}) => ReactNode`,signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  button: ReactNode;
  open: () => void;
  disabled: boolean;
}`,signature:{properties:[{key:"button",value:{name:"ReactNode",required:!0}},{key:"open",value:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}},required:!0}},{key:"disabled",value:{name:"boolean",required:!0}}]}},name:"args"}],return:{name:"ReactNode"}}},description:""}}};const z=({arbeidsgiverCallback:d,valgtArbeidsgiver:a,labelText:o,placeholder:l})=>{const[u,m]=s.useState(""),{isLoading:c,error:y,data:p}=P(u),[i,f]=s.useState(a??null);return s.useEffect(()=>{i&&d(i)},[i,d]),e.jsxs(s.Fragment,{children:[e.jsx("div",{role:"search",children:e.jsx(X,{isLoading:c,label:o??"Arbeidsgivers navn eller organisasjonsnummer",options:p?.map(t=>`${t.navn} - ${t.organisasjonsnummer}`)??[],shouldAutocomplete:!0,toggleListButton:!1,onChange:t=>m(t),onToggleSelected:t=>{const h=t.split(" - ").at(-1),v=p?.find(b=>b.organisasjonsnummer===h);v&&f(v)},placeholder:l})}),y&&e.jsx(B,{className:"mt-8",variant:"error",children:JSON.stringify(y)})]})};z.__docgenInfo={description:"",methods:[],displayName:"VelgArbeidsgiver",props:{children:{required:!1,tsType:{name:"union",raw:"ReactNode | undefined",elements:[{name:"ReactNode"},{name:"undefined"}]},description:""},arbeidsgiverCallback:{required:!0,tsType:{name:"signature",type:"function",raw:"(arbeidsgiver: ArbeidsgiverDTO) => void",signature:{arguments:[{type:{name:"z.infer",elements:[{name:"ArbeidsgiverSchema"}],raw:"z.infer<typeof ArbeidsgiverSchema>"},name:"arbeidsgiver"}],return:{name:"void"}}},description:""},valgtArbeidsgiver:{required:!1,tsType:{name:"union",raw:"ArbeidsgiverDTO | null",elements:[{name:"z.infer",elements:[{name:"ArbeidsgiverSchema"}],raw:"z.infer<typeof ArbeidsgiverSchema>"},{name:"null"}]},description:""},labelText:{required:!1,tsType:{name:"string"},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""}}};const Q=({variant:d="inline",onCompleted:a})=>{const{rekrutteringstreffId:o}=L(),l=I(o),u=_(o),{data:m}=l,[c,y]=s.useState(!1),p=async r=>{if(r)try{y(!0),await V(o,r.arbeidsgiverTreffId??r.organisasjonsnummer),u.mutate()}finally{y(!1)}},[i,f]=s.useState(null),[t,h]=s.useState([]),[v,b]=s.useState(!1),j=s.useMemo(()=>new Set((m??[]).map(r=>r.organisasjonsnummer)),[m]),k=r=>{h(n=>n.filter(g=>g.organisasjonsnummer!==r))};s.useEffect(()=>{!m||!i||(async()=>{try{if(j.has(i.organisasjonsnummer)){f(null);return}if(d==="modal"){h(r=>r.some(g=>g.organisasjonsnummer===i.organisasjonsnummer)?r:[...r,i]),f(null);return}await N(o,{organisasjonsnummer:i.organisasjonsnummer,navn:i.navn,næringskoder:i.naringskoder}),l.mutate(),u.mutate()}catch(r){throw new R({message:"Feiler når prøver å legge til arbeidsgiver.",error:r})}finally{f(null)}})()},[i,d,j,o,l,u,m]);const q=async()=>{if(t.length!==0){b(!0);try{for(const r of t)await N(o,{organisasjonsnummer:r.organisasjonsnummer,navn:r.navn,næringskoder:r.naringskoder});l.mutate(),u.mutate(),h([]),a?.()}catch(r){throw new R({message:"Feiler når prøver å legge til arbeidsgiver(e).",error:r})}finally{b(!1)}}};return e.jsx(H,{hooks:[l],children:r=>e.jsxs("div",{className:d==="modal"?"space-y-3":"space-y-4",children:[e.jsx("div",{children:e.jsx(z,{arbeidsgiverCallback:f,valgtArbeidsgiver:i,labelText:"Finn arbeidsgiver",placeholder:"Søk på navn, organisasjonsnummer"})}),d==="modal"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[t.map(n=>e.jsxs("div",{className:"relative",children:[e.jsx(w,{navn:n.navn,organisasjonsnummer:n.organisasjonsnummer,adresse:n.adresse??void 0}),e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx(A,{size:"xsmall",variant:"tertiary",onClick:()=>k(n.organisasjonsnummer),"aria-label":`Fjern ${n.navn}`,children:e.jsx(C,{"aria-hidden":!0})})})]},n.organisasjonsnummer)),t.length===0&&e.jsx(T,{size:"small",children:"Ingen arbeidsgivere valgt ennå"})]}),e.jsx(G,{gap:"2",justify:"end",children:e.jsx(A,{type:"button",onClick:q,disabled:t.length===0||v,loading:v,children:"Legg til"})})]}),d==="inline"&&e.jsx(e.Fragment,{children:Array.isArray(r)&&r.length>0?e.jsx("ul",{children:r.map((n,g)=>e.jsx("li",{children:e.jsxs("div",{className:"relative",children:[e.jsx(w,{navn:n.navn,organisasjonsnummer:n.organisasjonsnummer,adresse:{adresse:"TODO: adresse må lagres i backend for å kunne hentes her"}}),e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx(F,{navn:n.navn,loading:c,disabled:c,onConfirm:()=>p(n),arbeidsgivereHook:l,variant:"cross",triggerAriaLabel:`Fjern ${n.navn}`})})]})},g))}):e.jsx(T,{children:"Ingen arbeidsgivere lagt til"})})]})})};Q.__docgenInfo={description:"",methods:[],displayName:"LeggTilArbeidsgiverForm",props:{variant:{required:!1,tsType:{name:"union",raw:"'inline' | 'modal'",elements:[{name:"literal",value:"'inline'"},{name:"literal",value:"'modal'"}]},description:"",defaultValue:{value:"'inline'",computed:!1}},onCompleted:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{w as A,Q as L,F as S,z as V};
