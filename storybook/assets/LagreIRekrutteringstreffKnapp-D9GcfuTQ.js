import{N as F,bs as z,r as g,bt as A,u as H,bu as B,bv as E,j as e,d as k,S as P,al as T,x as _}from"./iframe-Dx5p-74P.js";import{u as J}from"./KandidatSøkMarkerteContext-CqGQMdFH.js";import{S as N}from"./PersonPlus-B6_-1jh1.js";import{M as b}from"./Modal-CXmacE1j.js";import{T as s}from"./Table-h4k2qJMe.js";import{a as y}from"./Checkbox-Dy7wwy-t.js";import{L as V}from"./Link-CQRIlL-P.js";const q=n=>`${z.internUrl}/${n}/jobbsoker`,K=(n,h)=>F(q(n),h),D=({rekrutteringstreffId:n,kandidatsokKandidater:h})=>{const u=g.useRef(null),[r,m]=g.useState(!1),[l,f]=g.useState([]),L=A(),{visVarsel:p}=H(),{markerteKandidater:d,fjernMarkerteKandidater:C}=J(),R=B(n),j=E(),S=()=>u.current?.showModal(),w=()=>{r||u.current?.close()},v=t=>f(a=>a.includes(t)?a.filter(o=>o!==t):[...a,t]),x=async t=>{if(!d||d.length===0||r)return;m(!0);let a=!1;const o=d.map(i=>{const c=h.find($=>$.arenaKandidatnr===i);return c?(c.fodselsnummer,{fødselsnummer:c.fodselsnummer,fornavn:c.fornavn??null,etternavn:c.etternavn??null,kandidatnummer:c.arenaKandidatnr??null}):null}).filter(i=>i&&i.fødselsnummer);try{if(n)await K(n,o),R.mutate?.();else if(t&&t.length>0)await Promise.all(t.map(i=>K(i,o))),j.mutate();else{p({type:"info",tekst:"Velg minst ett rekrutteringstreff"}),m(!1);return}p({type:"success",tekst:`${d.length} kandidat${d.length>1?"er":""} lagret i rekrutteringstreff`}),C(),a=!0,n&&L.push(`/rekrutteringstreff/${n}?visFane=jobbsøkere`)}catch(i){new _({message:"Feil ved lagring av kandidater i rekrutteringstreff",error:i}),p({type:"error",tekst:"Feil ved lagring av kandidater i rekrutteringstreff"})}finally{m(!1),a&&u.current?.close()}},M=()=>{n?x():S()};return e.jsxs(e.Fragment,{children:[e.jsx(k,{variant:"tertiary",onClick:M,icon:e.jsx(N,{"aria-hidden":!0}),disabled:d?.length===0||r,loading:r,children:n?"Legg til jobbsøkere og fullfør":"Lagre i rekrutteringstreff"}),e.jsxs(b,{width:600,ref:u,onClose:()=>{r&&u.current?.showModal()},header:{heading:`Lagre ${d?.length||0} kandidat i rekrutteringstreff`},children:[e.jsx(b.Body,{children:e.jsx(P,{hooks:[j],children:t=>r?e.jsx(T,{}):e.jsx(e.Fragment,{children:e.jsxs(s,{zebraStripes:!0,children:[e.jsx(s.Header,{children:e.jsxs(s.Row,{children:[e.jsx(s.DataCell,{children:e.jsx(y,{checked:l.length===t.length,indeterminate:l.length>0&&l.length!==t.length,onChange:()=>{l.length?f([]):f(t.map(a=>a.id))},hideLabel:!0,children:"Velg alle rader"})}),e.jsx(s.HeaderCell,{scope:"col",children:"Rekrutteringstreff"})]})}),e.jsx(s.Body,{children:t.map((a,o)=>e.jsxs(s.Row,{selected:l.includes(a.id),children:[e.jsx(s.DataCell,{className:"w-3",children:e.jsx(y,{hideLabel:!0,checked:l.includes(a.id),onChange:()=>v(a.id),"aria-labelledby":`id-${a.id}`,children:" "})}),e.jsx(s.HeaderCell,{scope:"row",children:e.jsx(V,{href:`rekrutteringstreff/${a.id}`,children:a.tittel??"Ukjent tittel"})})]},a.id+o))})]})})})}),e.jsxs(b.Footer,{children:[e.jsx(k,{disabled:r||l.length===0,type:"button",size:"small",loading:r,onClick:()=>void x(l),children:"Lagre"}),e.jsx(k,{disabled:r,type:"button",size:"small",variant:"secondary",onClick:w,children:"Avbryt"})]})]})]})};D.__docgenInfo={description:"",methods:[],displayName:"LagreIRekrutteringstreffKnapp",props:{rekrutteringstreffId:{required:!1,tsType:{name:"string"},description:""},kandidatsokKandidater:{required:!0,tsType:{name:"Array",elements:[{name:"z.infer",elements:[{name:"KandidatSøkKandidatSchema"}],raw:"z.infer<typeof KandidatSøkKandidatSchema>"}],raw:"KandidatsokKandidat[]"},description:""}}};export{D as L};
