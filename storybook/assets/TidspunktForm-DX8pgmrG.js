import{Q as ve,t as P,T as we,U as J,r as o,j as y,B as Y,C as H,bg as ee,bV as _,bj as qe,f as te,H as ne,bh as X,bZ as Ce}from"./iframe-BieBZBrC.js";import{b as re}from"./useAutosave-bRigfo09.js";import{i as K,k as R}from"./utils-6cKbvcej.js";import{p as se}from"./parseISO-GHa_kk7l.js";import{C as xe}from"./ComboboxProvider-BpTtKutv.js";import{i as B}from"./isSameDay-a63IO36A.js";import{u as Se,D as Z}from"./useDatepicker-B8Jvsl7b.js";import"./Date.Input-YnMHaQ4h.js";function Ee(e,i,a){return ve(e,+P(e)+i)}function Ie(e,i,a){return Ee(e,i*we)}function je(e,i,a){const n=P(e,a?.in);return n.setTime(n.getTime()+i*J),n}function Re(e){return i=>{const n=(e?Math[e]:Math.trunc)(i);return n===0?0:n}}function Me(e,i){return+P(e)-+P(i)}function Ne(e,i,a){const n=Me(e,i)/J;return Re(a?.roundingMethod)(n)}const z=[0,30],j=Array.from({length:24},(e,i)=>z.map(a=>`${String(i).padStart(2,"0")}:${String(a).padStart(2,"0")}`)).flat(),Oe=/^([01]\d|2[0-3]):([0-5]\d)$/,Be=e=>{const i=e.match(/^(\d{1,2})(?::?(\d{0,2}))?$/);if(!i)return null;const a=Math.min(parseInt(i[1]||"0",10)||0,23),n=parseInt(i[2]||"0",10)||0,c=z.reduce((l,u)=>Math.abs(u-n)<Math.abs(l-n)?u:l,z[0]);return`${String(a).padStart(2,"0")}:${String(c).padStart(2,"0")}`};function ae({value:e,onChange:i,onBlur:a,label:n="Klokkeslett",hideLabel:c,disabled:l,error:u,className:f,options:m,maxTime:d}){const p=o.useRef(null),k=o.useRef(!1),h=o.useRef(!1),T=o.useMemo(()=>{const t=m??j;return d?t.filter(s=>s<=d):t},[m,d]),[r,g]=o.useState(e??""),[E,C]=o.useState(!1),v=o.useRef(!1),$=o.useRef(e),x=o.useRef(!1),I=o.useRef(!1),S=o.useCallback(t=>Oe.test(t)&&(!d||t<=d),[d]),F=o.useCallback(t=>!t||/^[\d:]*$/.test(t),[]),ue=o.useCallback((t,s)=>d&&s>d||t.includes(s)?t:[...t,s].sort(),[d]),V=e&&S(e)?ue(T,e):T,M=o.useMemo(()=>V,[V]),U=()=>{const t=p.current;if(!t||typeof document>"u")return null;const s=t.getAttribute("aria-controls");return s?document.getElementById(s):null},de=o.useCallback(()=>{if(k.current)return;const t=p.current;if(!t||t.getAttribute("aria-expanded")!=="true")return;const s=U();if(!s)return;let D=s.querySelector("[role='option'][aria-selected='true']");if(!D&&e&&(D=Array.from(s.querySelectorAll("[role='option']")).find(b=>b.textContent?.trim()===e)||null),!D)return;const q=D.closest("[role='listbox']")||D.parentElement;if(q){const b=D.offsetTop,O=b+D.offsetHeight,W=q.scrollTop,ke=W+q.clientHeight;if(b<W+4){q.scrollTop=Math.max(b-4,0);return}if(O>ke-4){const be=Math.max(b-4,0);q.scrollTop=be}}},[e]),A=o.useCallback(()=>{},[de]),N=o.useCallback(t=>{const s=t.trim();return s===""?(v.current?e&&i(""):g(e??""),!0):S(s)?(s!==e&&i(s),!0):(g(e??""),!1)},[S,i,e]),ce=o.useCallback(t=>{if(x.current&&t===""){x.current=!1;return}!v.current&&t!==""&&(v.current=!0),!(t===""&&!v.current)&&(g(t===""?"":t),t!==""&&C(!0))},[]),fe=o.useCallback(t=>{const s=t.relatedTarget,D=U(),q=h.current;if(h.current=!1,!q&&(I.current||(s&&D?D.contains(s):!1))){I.current=!1,a?.(t);return}if(I.current=!1,!v.current&&(r===""||r===$.current)){g(e??""),a?.(t);return}N(r),C(!0),a?.(t)},[N,r,a,e]),G=o.useCallback((t,s)=>{const D=V;let w=(b=>b&&S(b)?D.indexOf(b):-1)(t);if(w===-1){const b=Be(r);w=b?D.indexOf(b):-1}if(w===-1){const b=r||e||"",O=D.indexOf(b);w=O>=0?O:0}return D[(w+s+D.length)%D.length]},[V,S,r,e]),Q=o.useCallback((t,s)=>{const D=G(t,s);v.current=!0,x.current=!0,g(D)},[G]),me=o.useCallback(t=>{const s=t.key;if(s==="ArrowDown"||s==="ArrowUp"){t.preventDefault(),t.stopPropagation(),Q(r||e,s==="ArrowDown"?1:-1);return}if(s==="Enter"){x.current=!0,!N(r??"")&&e&&g(e),C(!0);return}if(s==="Tab"){h.current=!0,x.current=!0,!N(r??"")&&e&&g(e),C(!0);return}},[N,r,Q,e]),pe=o.useCallback(t=>{const s=t.nativeEvent,D="data"in s?s.data:null;F(D)||t.preventDefault()},[F]),ge=o.useCallback(t=>{const s=t.clipboardData.getData("text");F(s)||t.preventDefault()},[F]),Te=o.useCallback(t=>{const s=t.target,D=s.tagName==="INPUT",q=s.getAttribute("role")==="option"||!!s.closest("[role='option']"),w=!!s.closest("[role='listbox']");(q||w)&&(I.current=!0),w&&(k.current=!0),D||q||w||(p.current?.focus(),t.preventDefault(),x.current=!0)},[]),De=o.useCallback(()=>{k.current=!1,v.current=!1,$.current=e,C(!1),x.current=!0,I.current=!1,h.current=!1,A()},[A,e]);o.useEffect(()=>{const t=e??"",s=setTimeout(()=>{g(t)},0);return()=>clearTimeout(s)},[e]),o.useEffect(()=>{const t=p.current;if(!t)return;const s=new MutationObserver(()=>{t.getAttribute("aria-expanded")==="true"&&A()});return s.observe(t,{attributes:!0,attributeFilter:["aria-expanded"]}),()=>s.disconnect()},[A]);const ye=o.useMemo(()=>{const t=r&&S(r)&&M.includes(r)?r:e&&S(e)&&M.includes(e)?e:void 0;return t?[t]:[]},[r,e,S,M]),he=`${f??"w-[7rem]"} focus-within:outline-none focus-visible:outline-none focus-within:ring-0 focus-visible:ring-0`;return y.jsx(xe,{ref:p,label:n,hideLabel:c,disabled:l,error:u,className:he,options:M,filteredOptions:M,allowNewValues:!0,toggleListButton:!0,isListOpen:E?!1:void 0,value:r,inputClassName:"min-w-0",shouldShowSelectedOptions:!1,selectedOptions:ye,onMouseDownCapture:Te,onFocus:De,onToggleSelected:(t,s)=>{s&&(x.current=!0,I.current=!1,g(t),$.current=t,v.current=!1,i(t),C(!0))},onChange:ce,onBlur:fe,onKeyDownCapture:me,onBeforeInput:pe,onPaste:ge})}ae.__docgenInfo={description:"",methods:[],displayName:"TimeInput",props:{value:{required:!1,tsType:{name:"string"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},onBlur:{required:!1,tsType:{name:"ReactFocusEventHandler",raw:"React.FocusEventHandler<HTMLInputElement>",elements:[{name:"HTMLInputElement"}]},description:""},label:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"'Klokkeslett'",computed:!1}},hideLabel:{required:!1,tsType:{name:"boolean"},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:""},error:{required:!1,tsType:{name:"union",raw:"ReactNode | boolean",elements:[{name:"ReactNode"},{name:"boolean"}]},description:""},className:{required:!1,tsType:{name:"string"},description:""},options:{required:!1,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""},maxTime:{required:!1,tsType:{name:"string"},description:""}}};function ie(e,i,a,n=15){return o.useMemo(()=>{const c=e??null,l=i??null,u=a??null;if(!c||!l||!K(u)||!B(c,l))return j;const f=R(l,u);if(!f)return j;const m=je(f,n);if(!B(f,m))return n>0?[]:j;const d=m.getTime(),p=n>0;return j.filter(h=>{const T=R(c,h);return T?p?T.getTime()>=d:T.getTime()<=d:!1})},[e,i,a,n])}function oe(e,i){const a=o.useRef(null);return o.useEffect(()=>()=>{a.current&&clearTimeout(a.current)},[]),{scheduleSave:o.useCallback(()=>{a.current&&clearTimeout(a.current),a.current=window.setTimeout(()=>{a.current=null,e(i)},0)},[e,i])}}function le({label:e,value:i,onChange:a,onBlur:n,error:c,from:l=new Date,to:u=new Date("2040-12-31"),disabled:f}){const{inputProps:m,datepickerProps:d,selectedDay:p,setSelected:k}=Se({defaultSelected:i??void 0,fromDate:l,toDate:u,onDateChange:r=>a(r??null)}),h=o.useCallback(r=>!r||/^[\d./-]*$/.test(r),[]);o.useEffect(()=>{const r=i??void 0,g=p??void 0;(r&&(!g||g.getTime()!==r.getTime())||!r&&g)&&k(r)},[i,p,k]);const T=r=>{m.onBlur?.(r),n?.()};return y.jsx(Z,{mode:"single",...d,children:y.jsx(Z.Input,{...m,hideLabel:!0,label:e,error:c?c.message||!0:void 0,disabled:f,onBlur:T,onBeforeInput:r=>{const g=r.nativeEvent,E="data"in g?g.data:null;if(!h(E)){r.preventDefault();return}m.onBeforeInput?.(r)},onPaste:r=>{const g=r.clipboardData.getData("text");if(!h(g)){r.preventDefault();return}m.onPaste?.(r)},placeholder:"dd.mm.책책책책"})})}le.__docgenInfo={description:"",methods:[],displayName:"ControlledDatePicker",props:{label:{required:!0,tsType:{name:"string"},description:""},value:{required:!0,tsType:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}]},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(d: Date | null) => void",signature:{arguments:[{type:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}]},name:"d"}],return:{name:"void"}}},description:""},onBlur:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},error:{required:!1,tsType:{name:"FieldError"},description:""},from:{required:!1,tsType:{name:"Date"},description:"",defaultValue:{value:"new Date()",computed:!1}},to:{required:!1,tsType:{name:"Date"},description:"",defaultValue:{value:"new Date('2040-12-31')",computed:!1}},disabled:{required:!1,tsType:{name:"boolean"},description:""}}};function L({label:e,nameDato:i,nameTid:a,control:n,disabledDato:c,disabledTid:l,hideDato:u,dateFrom:f,dateTo:m,timeOptions:d,onDatoBlur:p,onTidBlur:k,timeMax:h}){return y.jsxs("div",{className:"flex gap-4 items-start",children:[e&&y.jsx("div",{className:"flex items-center min-w-fit mt-3",children:y.jsx(Y,{size:"small",children:e})}),!u&&y.jsx(H,{name:i,control:n,rules:{required:"Dato er obligatorisk"},render:({field:T,fieldState:r})=>y.jsx(le,{label:e??"",value:T.value,onChange:g=>T.onChange(g),onBlur:()=>{T.onBlur(),p?.()},error:r.error,disabled:c,from:f,to:m})}),u&&y.jsx(H,{name:i,control:n,render:({field:T})=>{const r=T.value;return y.jsx("input",{type:"hidden",value:r instanceof Date?r.toISOString():"",onChange:()=>{}})}}),y.jsx(H,{name:a,control:n,rules:{required:"Tid er obligatorisk"},render:({field:T,fieldState:r})=>{const g=typeof T.value=="string"?T.value:"";return y.jsx(ae,{value:g,onChange:T.onChange,label:"Klokkeslett",hideLabel:!0,error:r.error?.message,disabled:l,onBlur:()=>{T.onBlur(),k?.()},className:"w-24",options:d??j,maxTime:h})}})]})}L.__docgenInfo={description:"",methods:[],displayName:"DatoTidRad",props:{label:{required:!1,tsType:{name:"string"},description:""},nameDato:{required:!0,tsType:{name:"Path",elements:[{name:"T"}],raw:"Path<T>"},description:""},nameTid:{required:!0,tsType:{name:"Path",elements:[{name:"T"}],raw:"Path<T>"},description:""},control:{required:!0,tsType:{name:"Control",elements:[{name:"T"}],raw:"Control<T>"},description:""},disabledDato:{required:!1,tsType:{name:"boolean"},description:""},disabledTid:{required:!1,tsType:{name:"boolean"},description:""},hideDato:{required:!1,tsType:{name:"boolean"},description:""},dateFrom:{required:!1,tsType:{name:"Date"},description:""},dateTo:{required:!1,tsType:{name:"Date"},description:""},timeOptions:{required:!1,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""},onDatoBlur:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onTidBlur:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},timeMax:{required:!1,tsType:{name:"string"},description:""}}};const Fe=e=>e?se(e):null,Ve=e=>e?te(se(e),"HH:mm"):"",Ae=({control:e})=>{const{autosave:i}=re(),{setValue:a}=ee(),[n,c]=_({control:e,name:["svarfristDato","svarfristTid"]}),[l,u]=_({control:e,name:["fraDato","fraTid"]}),{treff:f}=qe(),{scheduleSave:m}=oe(i,["fraDato","fraTid","tilDato","tilTid","svarfristDato","svarfristTid"]),d=ie(n,l,u,0);return o.useEffect(()=>{f&&(!n&&f.svarfrist&&a("svarfristDato",Fe(f.svarfrist),{shouldValidate:!1,shouldDirty:!1}),!c&&f.svarfrist&&a("svarfristTid",Ve(f.svarfrist),{shouldValidate:!1,shouldDirty:!1}))},[f,n,c,a]),o.useEffect(()=>{if(!l||!K(u))return;const p=R(l??null,u??null),k=R(n??null,c??null);!p||!k||k.getTime()>p.getTime()&&(a("svarfristDato",new Date(l),{shouldDirty:!0,shouldValidate:!1}),a("svarfristTid",u,{shouldDirty:!0,shouldValidate:!1}),m())},[l,u,n,c,a,m]),y.jsxs("div",{className:"space-y-4",children:[y.jsx(ne,{level:"3",size:"small",children:"Svarfrist"}),y.jsx("div",{children:y.jsx(L,{nameDato:"svarfristDato",nameTid:"svarfristTid",control:e,dateTo:l??void 0,timeOptions:d,onDatoBlur:m,onTidBlur:m})})]})};Ae.__docgenInfo={description:"",methods:[],displayName:"SvarfristForm",props:{control:{required:!0,tsType:{name:"Control",elements:[{name:"signature",type:"object",raw:`{
  tittel?: string;
  gateadresse?: string | null;
  postnummer?: string | null;
  poststed?: string | null;
  fraDato?: Date | null;
  fraTid?: string;
  tilDato?: Date | null;
  tilTid?: string;
  svarfristDato?: Date | null;
  svarfristTid?: string;
}`,signature:{properties:[{key:"tittel",value:{name:"string",required:!1}},{key:"gateadresse",value:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}],required:!1}},{key:"postnummer",value:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}],required:!1}},{key:"poststed",value:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}],required:!1}},{key:"fraDato",value:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}],required:!1}},{key:"fraTid",value:{name:"string",required:!1}},{key:"tilDato",value:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}],required:!1}},{key:"tilTid",value:{name:"string",required:!1}},{key:"svarfristDato",value:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}],required:!1}},{key:"svarfristTid",value:{name:"string",required:!1}}]}}],raw:"Control<RekrutteringstreffFormValues>"},description:""}}};function Pe(e,i,a=1){return{adjustEndTime:o.useCallback((c,l,u,f,m,d)=>{if(!c||!K(l))return!1;const p=R(c,l);if(!p)return!1;const h=R(u??c,f),T=a>0;if(h?T?h.getTime()>p.getTime():h.getTime()<p.getTime():!1)return!1;const g=Ie(p,a),E=X(g),C=te(g,"HH:mm");let v=!1;return(!u||X(u).getTime()!==E.getTime())&&(e(m,E,{shouldDirty:!0,shouldValidate:!1}),v=!0),f!==C&&(e(d,C,{shouldDirty:!0,shouldValidate:!1}),v=!0),v&&i(),v},[e,i,a])}}const Le=(e,i,a,n)=>{if(!e||!a)return"";const c=(f,m)=>{const[d,p]=m.split(":").map(Number),k=new Date(f);return k.setHours(d,p,0,0),k},l=c(e,i),u=c(a,n);if(B(l,u)){const f=Ne(u,l);if(f===0)return"0 minutt";const m=Math.abs(f),d=Math.floor(m/60),p=m%60,k=f<0?"-":"",h=[];return d>0&&h.push(`${d} time${d>1?"r":""}`),p>0&&h.push(`${p} minutt`),`${k}${h.join(" ")}`}else{const f=Ce(u,l),m=f>=0?f+1:f;return`${m} dag${Math.abs(m)!==1?"er":""}`}},$e=({control:e})=>{const{setValue:i}=ee(),{autosave:a}=re(),[n,c,l,u]=_({control:e,name:["fraDato","fraTid","tilDato","tilTid"]}),[f,m]=o.useState(n&&l?!B(n,l):!1),{scheduleSave:d}=oe(a,["fraDato","fraTid","tilDato","tilTid","svarfristDato","svarfristTid"]),{adjustEndTime:p}=Pe(i,d,1),k=ie(l??n,n,c,1);o.useEffect(()=>{const T=n&&l?!B(n,l):!1,r=setTimeout(()=>{m(g=>g===T?g:T)},0);return()=>clearTimeout(r)},[n,l]),o.useEffect(()=>{p(n,c,l,u,"tilDato","tilTid")},[n,c,l,u,p]);const h=o.useMemo(()=>!n||!c||!u?"":Le(n,c,l??n,u),[n,c,l,u]);return y.jsxs("div",{className:"space-y-4",children:[y.jsx("div",{className:"flex justify-between items-center",children:y.jsx(ne,{level:"3",size:"small",children:"Tid"})}),y.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[y.jsx(L,{nameDato:"fraDato",nameTid:"fraTid",control:e,onDatoBlur:d,onTidBlur:d,timeMax:"22:59"}),y.jsx(L,{label:"Til",nameDato:"tilDato",nameTid:"tilTid",control:e,hideDato:!f,dateFrom:n??void 0,timeOptions:k,onDatoBlur:d,onTidBlur:d}),y.jsx(Y,{size:"small",className:"mt-3",children:h||"Velg tid"})]})]})};$e.__docgenInfo={description:"",methods:[],displayName:"TidspunktForm",props:{control:{required:!0,tsType:{name:"Control",elements:[{name:"signature",type:"object",raw:`{
  tittel?: string;
  gateadresse?: string | null;
  postnummer?: string | null;
  poststed?: string | null;
  fraDato?: Date | null;
  fraTid?: string;
  tilDato?: Date | null;
  tilTid?: string;
  svarfristDato?: Date | null;
  svarfristTid?: string;
}`,signature:{properties:[{key:"tittel",value:{name:"string",required:!1}},{key:"gateadresse",value:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}],required:!1}},{key:"postnummer",value:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}],required:!1}},{key:"poststed",value:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}],required:!1}},{key:"fraDato",value:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}],required:!1}},{key:"fraTid",value:{name:"string",required:!1}},{key:"tilDato",value:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}],required:!1}},{key:"tilTid",value:{name:"string",required:!1}},{key:"svarfristDato",value:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}],required:!1}},{key:"svarfristTid",value:{name:"string",required:!1}}]}}],raw:"Control<RekrutteringstreffFormValues>"},description:""}}};export{Ae as S,$e as T};
