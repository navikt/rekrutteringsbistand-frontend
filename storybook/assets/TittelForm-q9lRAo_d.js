import{h4 as j,hB as p,r as R,j as e,H as N,aP as E,B as z,h2 as G,hb as H,e as X,Y as q,a0 as W,w as Y}from"./iframe-CKFsWzOg.js";import{b}from"./useAutosave-DP0Eqwnf.js";import{u as $}from"./usePamPostdata-2IAl1OCa.js";import{T as x}from"./TextField-DHcFQWjN.js";import{T as J,S as Q}from"./TidspunktForm-CisMJTkM.js";import{K as Z}from"./KiAnalyse-BhZ9DFLB.js";import{K as ee}from"./KiAnalysePanel-B6BrNxlT.js";import{u as te}from"./useKiAnalyse-BFQy_aNj.js";import{M as F}from"./mutations-DICN2vG5.js";import{u as se}from"./useKiLogg-B2FGgZYF.js";import{S as re}from"./Skeleton-CtsYoFg7.js";const t={GATEADRESSE:"gateadresse",POSTNUMMER:"postnummer",POSTSTED:"poststed"},A=({control:r})=>{const{setValue:l,clearErrors:u,setError:g,trigger:S}=j(),{save:c}=b(),n=p({control:r,name:t.POSTNUMMER}),{data:i,isLoading:d}=$(n||"");return R.useEffect(()=>{!n||n.length!==4||d||(i?.korrigertNavnBy?(l(t.POSTSTED,i.korrigertNavnBy,{shouldDirty:!0,shouldValidate:!0}),u(t.POSTSTED)):(l(t.POSTSTED,"",{shouldDirty:!0,shouldValidate:!0}),g(t.POSTSTED,{type:"manual",message:"Ukjent poststed"})))},[n,d,i,l,g,u]),e.jsxs("div",{className:"space-y-4",children:[e.jsx(N,{level:"3",size:"small",children:"Sted"}),e.jsx(E,{name:t.GATEADRESSE,control:r,render:({field:a,fieldState:f})=>e.jsx(x,{...a,value:a.value??"",label:"Gateadresse",error:f.error?.message,onBlur:()=>{a.onBlur(),c([t.GATEADRESSE])}})}),e.jsxs("div",{className:"flex gap-4 items-start",children:[e.jsx(E,{name:t.POSTNUMMER,control:r,render:({field:a,fieldState:f})=>e.jsx(x,{...a,value:a.value??"",label:"Postnummer",htmlSize:12,error:f.error?.message,onChange:v=>{const m=v.target.value.replace(/\D/g,"");u([t.POSTNUMMER,t.POSTSTED]),l(t.POSTSTED,"",{shouldDirty:!1,shouldValidate:!0}),m.length<=4&&a.onChange(m),m.length===4&&S([t.POSTNUMMER])},onBlur:()=>{a.onBlur(),c([t.POSTNUMMER,t.POSTSTED])}})}),e.jsx(z,{className:`pt-8 ${p({control:r,name:t.POSTSTED})?"":"aksel-error-message"}`,children:p({control:r,name:t.POSTSTED})||(n&&n.length===4&&!d?"Ukjent poststed":"")})]})]})};A.__docgenInfo={description:"",methods:[],displayName:"StedForm"};const ae=()=>{const{control:r}=j();return e.jsxs("div",{className:"space-y-8",children:[e.jsx(N,{level:"2",size:"medium",children:"Praktiske forhold"}),e.jsx(J,{control:r}),e.jsx(Q,{control:r}),e.jsx(A,{control:r})]})};ae.__docgenInfo={description:"",methods:[],displayName:"PraktiskeForhold"};const ne="Treff uten navn",M=({onUpdated:r})=>{const{rekrutteringstreffId:l}=G(),{treff:u}=H(),g=u?u.tittel??null:void 0,{setLagret:S,isLoading:c}=se(l,"tittel"),{control:n,setValue:i,getValues:d,trigger:a,clearErrors:f,formState:{isSubmitting:v}}=j(),m=R.useRef(null),h=p({control:n,name:"tittel"}),O=F-(typeof h=="string"?h.length:0),{save:B}=b(),K=async o=>{try{await B(["tittel"],o)}catch(T){new Y({message:"Lagring av tittel feilet.",error:T})}finally{r?.()}},{analyse:L,analyseError:w,validating:k,kiErrorBorder:P,forceSave:C,showAnalysis:V,erRedigeringAvPublisertTreff:U,runValidationAndMaybeSave:D,onForceSave:_}=te({feltType:"tittel",fieldName:"tittel",watchedValue:h,triggerRHF:a,getValues:d,setValue:i,setKiFeilFieldName:"tittelKiFeil",saveCallback:K,setKiLagret:S,setKiSjekketFieldName:"tittelKiSjekket",savedValue:g}),I=()=>{i("tittel","",{shouldValidate:!0,shouldDirty:!0,shouldTouch:!0}),m.current?.focus()};return e.jsxs("section",{className:"space-y-3",children:[c&&e.jsx(re,{variant:"text"}),!c&&e.jsxs(e.Fragment,{children:[e.jsx(N,{level:"2",size:"medium",children:"Navn på treffet"}),e.jsxs("div",{className:"relative w-full",children:[h&&e.jsx(X,{type:"button",onClick:I,"aria-label":"Tøm tittel feltet",variant:"tertiary",size:"small",className:"absolute right-2 top-[2rem] -translate-y-1/2 h-8 p-1",title:"Tøm feltet",children:e.jsx(q,{"aria-hidden":!0,fontSize:"1.25rem"})}),e.jsx("div",{className:"flex items-start",children:e.jsx(E,{control:n,name:"tittel",render:({field:o,fieldState:T})=>e.jsx(x,{...o,value:o.value??"",ref:s=>{o.ref(s),m.current=s},label:"Navn på treffet",hideLabel:!0,maxLength:F,className:"w-full pt-2",error:T.error?.message||(P?"Brudd på retningslinjer":void 0),"aria-invalid":!!(T.error||P),autoComplete:"off",autoCorrect:"off",spellCheck:!1,onChange:s=>{o.onChange(s),s.target.value.trim().length>0&&f("tittel")},onBlur:async()=>{o.onBlur(),setTimeout(async()=>{!k&&!v&&await D()},0)},onFocus:()=>{const s=o.value;if(!s||typeof s!="string")return;s.trim()===ne&&i("tittel","",{shouldValidate:!1,shouldDirty:!1,shouldTouch:!1})},onKeyDown:s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),(async()=>{const y=s.currentTarget;await D(),y?.blur()})())}})})})]}),e.jsxs(W,{className:"text-gray-400",children:[O," tegn igjen"]}),e.jsx(Z,{}),e.jsx(ee,{validating:k,analyse:L,analyseError:w,forceSave:C,showAnalysis:V,erRedigeringAvPublisertTreff:U,onForceSave:_,ariaLabel:"Analyse av tittel"})]})]})};M.displayName="TittelForm";M.__docgenInfo={description:"",methods:[],displayName:"TittelForm",props:{onUpdated:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{ae as P,A as S,M as T};
