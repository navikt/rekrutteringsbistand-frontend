import{be as h,bP as L,bg as p,r as m,bQ as w,bR as D,x as P,bS as C,bj as K,bT as j,bU as B,bC as F}from"./iframe-B4tn9iAN.js";import{f as E}from"./index-CNWXVBIo.js";import{t as I}from"./utils-D_6hlYTF.js";function M(){const{rekrutteringstreffId:t,startLagring:r,stoppLagring:o}=h(),{data:l,mutate:n}=L(t),s=l?.[0],{getValues:i,setValue:u}=p();return{lagre:m.useCallback(async()=>{if(!t)return;const a=(i().htmlContent??"").toString();if(a.trim().length!==0)try{const g=s?.opprettetAvPersonNavn||s?.opprettetAvPersonNavident||"Markedskontakt",f={htmlContent:a,tittel:"Om treffet",opprettetAvPersonNavn:g,opprettetAvPersonBeskrivelse:"Markedskontakt",sendesTilJobbsokerTidspunkt:E(new Date,"Europe/Oslo","yyyy-MM-dd'T'HH:mm:ssXXX")};r("innlegg"),s?.id?await w(t,s.id,f):await D(t,f),n(),u("htmlContent",a,{shouldDirty:!1})}catch(g){new P({message:"Lagring av innlegg feilet.",error:g})}finally{o("innlegg")}},[i,s,n,t,r,o,u]),innlegg:s}}function O(){const{rekrutteringstreffId:t,startLagring:r,stoppLagring:o}=h(),{mutate:l}=C(t),{treff:n}=K(),{getValues:s}=p(),i=m.useCallback(()=>{const e=s(),c=I(e.fraDato??null,e.fraTid)??n?.fraTid??null,a=I(e.tilDato??e.fraDato??null,e.tilTid)??n?.tilTid??null,g=I(e.svarfristDato??null,e.svarfristTid)??n?.svarfrist??null,f=typeof e.tittel=="string"?e.tittel.trim():"";return{tittel:f.length>0?f:n?.tittel??"Treff uten navn",beskrivelse:e.beskrivelse??n?.beskrivelse??null,fraTid:c,tilTid:a,svarfrist:g,gateadresse:e.gateadresse??n?.gateadresse??null,postnummer:e.postnummer??n?.postnummer??null,poststed:e.poststed??n?.poststed??null,kommune:e.kommune??n?.kommune??null,kommunenummer:e.kommunenummer??n?.kommunenummer??null,fylke:e.fylke??n?.fylke??null,fylkesnummer:e.fylkesnummer??n?.fylkesnummer??null}},[s,n]);return{lagre:m.useCallback(async()=>{if(!t)return;const e=i();try{r("rekrutteringstreff"),await j(t,e),l()}finally{o("rekrutteringstreff")}},[i,t,l,r,o]),byggRekrutteringstreffDto:i}}const x=()=>{try{return!1}catch{return!1}},N=t=>{const r=B(t?.hendelser);return r===F.INVITERE||r===F.FULLFÃ˜RE};function A(){const{watch:t,formState:r}=p(),o=t("tittelKiFeil")??!1,l=t("htmlContentKiFeil")??!1,n=!!o||!!l,s=!!(r.errors&&Object.keys(r.errors).some(g=>g!=="root")),i=n||s,u=!!r?.errors?.tittel,e=!!r?.errors?.htmlContent,c=!!t("tittelKiSjekket"),a=!!t("htmlContentKiSjekket");return{harFeil:i,harKiFeil:n,harAndreSkjemafeil:s,tittelKiFeil:o,innleggKiFeil:l,harTittelFeil:u,harInnleggFeil:e,tittelKiSjekket:c,innleggKiSjekket:a}}const R=(t,r,o,l)=>t||!r?!1:!l||o;function J(){const{rekrutteringstreffId:t}=h(),{treff:r}=K(),{getValues:o,trigger:l,formState:n}=p(),{lagre:s,byggRekrutteringstreffDto:i}=O(),{tittelKiFeil:u,tittelKiSjekket:e}=A(),c=m.useCallback(async(f,d)=>{if(!t||!await l(f&&f.length>0?f:void 0,{shouldFocus:!1}))return;if(n?.errors?.root?.type==="manualPeriod"){const v=i();if((v?.fraTid??null)!==(r?.fraTid??null)||(v?.tilTid??null)!==(r?.tilTid??null))return}const b=o(),k=typeof b.tittel=="string"?b.tittel.trim():"",S=k.length>0&&k!==(r?.tittel??"");R(d??!1,S,u,e)||await s()},[t,r,i,l,n,o,s,e,u]),a=m.useCallback(async(f,d)=>{},[]);return{autosave:m.useMemo(()=>V(r)?a:c,[r,a,c])}}function Q(){const{rekrutteringstreffId:t}=h(),{data:r}=C(t),{getValues:o,trigger:l,formState:n}=p(),{lagre:s,innlegg:i}=M(),{harInnleggFeil:u,innleggKiFeil:e,innleggKiSjekket:c}=A(),a=m.useCallback(async(d,y)=>{if(!t||d&&d.length&&!await l(d,{shouldFocus:!1}))return;const k=(o().htmlContent??"").toString();if(!(k.trim().length>0)||u)return;const v=i?.htmlContent??"",T=k.trim().length>0&&k!==v;R(y??!1,T,e,c)||await s()},[t,r,l,n,o,s,i,u,e,c]),g=m.useCallback(async(d,y)=>{},[]);return{autosave:m.useMemo(()=>V(r)?g:a,[r,g,a])}}const V=t=>N(t)&&x();export{x as a,J as b,N as e,Q as u};
