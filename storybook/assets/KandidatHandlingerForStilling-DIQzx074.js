import{av as K,k as b,r as m,j as t,e as T,u as S,h as N,w}from"./iframe-C8Gl0mmh.js";import{K as x}from"./KandidatTyper-CkRsvxsW.js";import{u as h}from"./KandidatlisteContext-BYtw_0rU.js";import{D as _}from"./DelMedArbeidsgiver-C1h4JUIX.js";import{D as M}from"./DelMedKandidatModal-DabdzHrL.js";import{E as j,a as C}from"./EndreArkivertStatusModal-Ceta_XyF.js";import{S as E,F as I}from"./FjernFåttJobbenKnapp-CzUc_sQA.js";import{K as k,S as D}from"./KandidatHendelseTagVisning-BDiWw1A-.js";import{a as V}from"./KandidatHendelseTag-C0cN80A6.js";import{R}from"./RegistrerFåttJobbenKnapp-VJB2C921.js";import{S as U}from"./SendSmsModal-3hBRtEtf.js";import{V as $}from"./VelgInternStatus-DsyOcnIl.js";import{A as o}from"./useForespurteOmDelingAvCv-DL-yWNCM.js";const B=(e,r)=>`${b.internUrl}/veileder/kandidatlister/${e}/kandidater/${r}/utfall`,J=async(e,r,a,s)=>await K(B(a,s),{utfall:e,navKontor:r}),q=async(e,r,a)=>await K(`${b.internUrl}/veileder/kandidat/arbeidsgiverliste/${e}/${r}`,{navKontor:a}),y=({kandidatnummer:e,navKontor:r})=>{const[a,s]=m.useState(!1),{reFetchKandidatliste:n,kandidatlisteId:i}=h(),l=async()=>{s(!0),await q(i,e,r).finally(()=>{s(!1),n()})};return t.jsx(T,{loading:a,icon:t.jsx(E,{}),variant:"tertiary",size:"small",className:"self-center",onClick:l,children:"Fjern CV fra arbeidsgiver"})};y.__docgenInfo={description:"",methods:[],displayName:"FjernDelingMedArbeidsgiver",props:{kandidatnummer:{required:!0,tsType:{name:"string"},description:""},navKontor:{required:!0,tsType:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}]},description:""}}};const A=({kandidatHendelser:e})=>{const a=[...e.cvHendelser??[],...e.utfallsendringer??[],...e.varsler??[]].filter(s=>s!==void 0).sort((s,n)=>(n.dato?.getTime()||0)-(s.dato?.getTime()||0));return t.jsx("div",{className:"flex flex-col gap-4",children:a.map((s,n)=>t.jsx(k,{kandidatHendelse:s},n))})};A.__docgenInfo={description:"",methods:[],displayName:"KandidatHendelser",props:{kandidatHendelser:{required:!0,tsType:{name:"KandidatHendelser"},description:""}}};const L=({kandidat:e})=>{const{valgtNavKontor:r}=S(),{stillingsData:a,kandidatlisteInfo:s}=N(),{reFetchKandidatliste:n,lukketKandidatliste:i,kandidatlisteId:l}=h(),[u,f]=m.useState(!1),c=m.useRef(null),g=e.kandidatHendelser.utfallsendringer?.some(d=>"sendtTilArbeidsgiversKandidatliste"in d.raw&&d.raw.sendtTilArbeidsgiversKandidatliste),H=e.utfall===x.FATT_JOBBEN,p=e.kandidatHendelser.utfallsendringer?.some(d=>d.tekst===V.CV_slettet_hos_arbeidsgiver),v=async d=>{f(!0);try{await J(d,r?.navKontor??"",l,e.kandidatnr),n()}catch(F){new w({message:"Feil ved endring av utfall",error:F})}f(!1)};return t.jsxs("div",{className:"flex flex-col gap-4",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsxs("div",{children:[t.jsx("div",{className:"mb-2",children:a.stilling.title}),e.arkivert?t.jsx(D,{kandidat:e}):t.jsx(k,{sidebar:!0,kandidatHendelse:e.kandidatHendelser.sisteHendelse})]}),t.jsx("div",{children:s&&t.jsx($,{lukketKandidatliste:s.kandidatlisteStatus==="LUKKET",kandidatnr:e.kandidatnr,status:e.status})})]}),!e.arkivert&&!H&&!g&&!p&&t.jsxs("div",{className:"grid grid-rows-2 gap-2",children:[t.jsx(M,{markerteKandidater:[e],fjernAllMarkering:()=>{},sidebar:!0}),t.jsx(_,{markerteKandidater:[e],sidebar:!0})]}),e.arkivert?t.jsx(j,{lukketKandidatliste:i,slettet:e.arkivert,modalRef:c}):t.jsxs("div",{className:"grid grid-cols-2 gap-2 justify-between @3xl:flex @3xl:justify-between",children:[t.jsx(U,{markerteKandidater:[e],fjernAllMarkering:()=>{},sidebar:!0}),t.jsx("div",{children:e.utfall!==x.FATT_JOBBEN?t.jsx(R,{loading:u,endreUtfallForKandidat:v,lukketKandidatliste:i}):t.jsx(I,{loading:u,endreUtfallForKandidat:v,lukketKandidatliste:i})}),!p&&g&&t.jsx(y,{kandidatnummer:e.kandidatnr,navKontor:r?.navKontor??null}),t.jsx("div",{className:"flex flex-1 justify-end",children:t.jsx(j,{lukketKandidatliste:i,slettet:e.arkivert,modalRef:c})})]}),t.jsx(C,{modalRef:c,kandidat:e,kandidatlisteId:l}),t.jsx(o,{children:t.jsxs(o.Item,{children:[t.jsx(o.Header,{children:"Vis alle hendelser og varsler"}),t.jsx(o.Content,{children:t.jsx(A,{kandidatHendelser:e.kandidatHendelser})})]})})]})};L.__docgenInfo={description:"",methods:[],displayName:"KandidatHandlingerForStilling",props:{kandidat:{required:!0,tsType:{name:"KandidatVisningProps"},description:""}}};export{L as K};
