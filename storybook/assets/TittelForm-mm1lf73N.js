import{h4 as N,hD as x,r as y,j as e,H as R,aP as j,B as _,hb as G,w as U,e as I,Y as z,a0 as H}from"./iframe-snWmX9TD.js";import{u as M,T as X,S as q}from"./TidspunktForm-DiUP2nI5.js";import{u as W}from"./usePamPostdata-DusoqQB8.js";import{T as k}from"./TextField-DYhhoii-.js";import{B as E}from"./Box-PJe9VxjM.js";import{K as Y}from"./KiAnalyseIntro-8aS2wmqq.js";import{K as $}from"./KiAnalysePanel-B9pNC17S.js";import{u as J}from"./useFormFeltMedKiValidering-CVIp0iq2.js";import{M as b}from"./mutations-vaUN8hyr.js";import{S as Q}from"./Skeleton-3kfY4cqI.js";const r={GATEADRESSE:"gateadresse",POSTNUMMER:"postnummer",POSTSTED:"poststed"},O=({control:a})=>{const{setValue:l,clearErrors:u,setError:f,trigger:p}=N(),{autosave:d}=M(),o=x({control:a,name:r.POSTNUMMER}),{data:c,isLoading:m}=W(o||"");return y.useEffect(()=>{!o||o.length!==4||m||(c?.korrigertNavnBy?(l(r.POSTSTED,c.korrigertNavnBy,{shouldDirty:!0,shouldValidate:!0}),u(r.POSTSTED)):(l(r.POSTSTED,"",{shouldDirty:!0,shouldValidate:!0}),f(r.POSTSTED,{type:"manual",message:"Ukjent poststed"})))},[o,m,c,l,f,u]),e.jsxs("div",{className:"space-y-4",children:[e.jsx(R,{level:"3",size:"small",children:"Sted"}),e.jsx(j,{name:r.GATEADRESSE,control:a,render:({field:s,fieldState:g})=>e.jsx(k,{...s,value:s.value??"",label:"Gateadresse",error:g.error?.message,onBlur:()=>{s.onBlur(),d([r.GATEADRESSE])}})}),e.jsxs("div",{className:"flex gap-4 items-start",children:[e.jsx(j,{name:r.POSTNUMMER,control:a,render:({field:s,fieldState:g})=>e.jsx(k,{...s,value:s.value??"",label:"Postnummer",htmlSize:12,error:g.error?.message,onChange:T=>{const h=T.target.value.replace(/\D/g,"");u([r.POSTNUMMER,r.POSTSTED]),l(r.POSTSTED,"",{shouldDirty:!1,shouldValidate:!0}),h.length<=4&&s.onChange(h),h.length===4&&p([r.POSTNUMMER])},onBlur:()=>{s.onBlur(),d([r.POSTNUMMER,r.POSTSTED])}})}),e.jsx(_,{className:`pt-8 ${x({control:a,name:r.POSTSTED})?"":"aksel-error-message"}`,children:x({control:a,name:r.POSTSTED})||(o&&o.length===4&&!m?"Ukjent poststed":"")})]})]})};O.__docgenInfo={description:"",methods:[],displayName:"StedForm"};const Z=()=>{const{control:a}=N();return e.jsxs("div",{className:"space-y-8",children:[e.jsx(R,{level:"2",size:"medium",children:"Praktiske forhold"}),e.jsx(E.New,{background:"neutral-moderate",borderRadius:"xlarge",padding:"3",children:e.jsx(X,{control:a})}),e.jsx(E.New,{background:"neutral-moderate",borderRadius:"xlarge",padding:"3",children:e.jsx(q,{control:a})}),e.jsx(E.New,{background:"neutral-moderate",borderRadius:"xlarge",padding:"3",children:e.jsx(O,{control:a})})]})};Z.__docgenInfo={description:"",methods:[],displayName:"PraktiskeForhold"};const ee="Treff uten navn",B=({onUpdated:a})=>{const{treff:l}=G(),u=l?l.tittel??null:void 0,{clearErrors:f,formState:{isSubmitting:p}}=N(),d=y.useRef(null),{autosave:o}=M(),c=y.useCallback(async(n,i)=>{try{await o(n,i)}catch(t){new U({message:"Lagring av tittel feilet.",error:t})}finally{a?.()}},[o,a]),{analyse:m,analyseError:s,validating:g,kiErrorBorder:T,harGodkjentKiFeil:h,showAnalysis:w,erRedigeringAvPublisertTreff:A,validerMedKiOgLagreVedGodkjenning:D,onGodkjennKiFeil:L,watchedValue:v,control:C,setValue:P,kiLoggLoading:F}=J({feltType:"tittel",fieldName:"tittel",savedValue:u,saveCallback:c,onUpdated:a}),V=b-(typeof v=="string"?v.length:0),K=()=>{P("tittel","",{shouldValidate:!0,shouldDirty:!0,shouldTouch:!0}),d.current?.focus()};return e.jsxs("section",{className:"space-y-3",children:[F&&e.jsx(Q,{variant:"text"}),!F&&e.jsxs(e.Fragment,{children:[e.jsx(Y,{title:"Navn på treffet"}),e.jsxs("div",{className:"relative w-full",onBlur:n=>{const i=n.currentTarget;setTimeout(async()=>{!i.contains(document.activeElement)&&!p&&await D()},0)},children:[v&&e.jsx(I,{type:"button",onClick:K,"aria-label":"Tøm tittel feltet",variant:"tertiary",size:"small",className:"absolute right-2 top-[2rem] -translate-y-1/2 h-8 p-1",title:"Tøm feltet",children:e.jsx(z,{"aria-hidden":!0,fontSize:"1.25rem"})}),e.jsx("div",{className:"flex items-start",children:e.jsx(j,{control:C,name:"tittel",render:({field:n,fieldState:i})=>e.jsx(k,{...n,value:n.value??"",ref:t=>{n.ref(t),d.current=t},label:"Navn på treffet",hideLabel:!0,maxLength:b,className:"w-full pt-2",error:i.error?.message||(T?"Brudd på retningslinjer":void 0),"aria-invalid":!!(i.error||T),autoComplete:"off",autoCorrect:"off",spellCheck:!1,onChange:t=>{n.onChange(t),t.target.value.trim().length>0&&f("tittel")},onBlur:()=>{n.onBlur()},onFocus:()=>{const t=n.value;if(!t||typeof t!="string")return;t.trim()===ee&&P("tittel","",{shouldValidate:!1,shouldDirty:!1,shouldTouch:!1})},onKeyDown:t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),(async()=>{const S=t.currentTarget;await D(),S?.blur()})())}})})})]}),e.jsxs(H,{className:"text-gray-400",children:[V," tegn igjen"]}),e.jsx($,{validating:g,analyse:m,analyseError:s,harGodkjentKiFeil:h,showAnalysis:w,erRedigeringAvPublisertTreff:A,onGodkjennKiFeil:L,ariaLabel:"Analyse av tittel"})]})]})};B.displayName="TittelForm";B.__docgenInfo={description:"",methods:[],displayName:"TittelForm",props:{onUpdated:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{Z as P,O as S,B as T};
