import{aG as E,j as e,S as K,O as S,u as b,r as p,aH as P,aq as $,d as k,A as I,aI as R,Q as B}from"./iframe-ft6w6Wdm.js";import{L as D}from"./Link-Bjy5BopZ.js";import{l as L}from"./leggTilKandidat-C8a0SmWC.js";import{u as v}from"./KandidatSøkMarkerteContext-BCFUmMxF.js";import{U as _}from"./umamiEvents-DmzFNrn7.js";import{M as y}from"./Modal-DOeJNTlv.js";import{T as r}from"./Table-BQm8IdVL.js";import{a as C}from"./Checkbox-Dx75utL-.js";import{P as q}from"./Pagination-sPddZ0Hk.js";import{S as M}from"./PersonPlus-DBBJ0P2w.js";const w=({stillingsId:i})=>{const c=E(i);return e.jsx(K,{hooks:[c],children:d=>e.jsx(D,{href:`stilling/${i}`,children:d.stilling.title??"Ukjent tittel"})})};w.__docgenInfo={description:"",methods:[],displayName:"KandidatlisteTittel",props:{stillingsId:{required:!0,tsType:{name:"string"},description:""}}};const F=({onClose:i})=>{const{track:c}=S(),{visVarsel:d}=b(),{markerteKandidater:n,fjernMarkerteKandidater:x}=v(),[g,m]=p.useState(1),l=P(g>1?g-1:0),[s,h]=p.useState([]),[u,H]=p.useState(!1),T=a=>h(o=>o.includes(a)?o.filter(t=>t!==a):[...o,a]);return e.jsxs(y,{onClose:i,open:!0,width:800,header:{heading:`Lagre ${n?.length||0} kandidat i kandidatlister`},children:[e.jsx(y.Body,{children:e.jsx(K,{hooks:[l],children:a=>{const o=Math.floor(a.antall/8);return u?e.jsx($,{}):e.jsxs(e.Fragment,{children:[e.jsxs(r,{zebraStripes:!0,children:[e.jsx(r.Header,{children:e.jsxs(r.Row,{children:[e.jsx(r.DataCell,{children:e.jsx(C,{checked:s.length===a.liste.length,indeterminate:s.length>0&&s.length!==a.liste.length,onChange:()=>{s.length?h([]):h(a.liste.map(t=>t.stillingId))},hideLabel:!0,children:"Velg alle rader"})}),e.jsx(r.HeaderCell,{scope:"col",children:"Stilling"}),e.jsx(r.HeaderCell,{scope:"col",children:"Organisasjon"}),e.jsx(r.HeaderCell,{scope:"col",children:"Antall stillinger"})]})}),e.jsx(r.Body,{children:a.liste?.map((t,j)=>e.jsxs(r.Row,{selected:s.includes(t.stillingId),children:[e.jsx(r.DataCell,{children:e.jsx(C,{hideLabel:!0,checked:s.includes(t.stillingId),onChange:()=>T(t.stillingId),"aria-labelledby":`id-${t.stillingId}`,children:" "})}),e.jsx(r.HeaderCell,{scope:"row",children:e.jsx(w,{stillingsId:t.stillingId})}),e.jsx(r.DataCell,{children:t.organisasjonNavn}),e.jsx(r.DataCell,{children:t.antallStillinger})]},t.stillingId+j))})]}),e.jsx(q,{className:"my-8 flex justify-center",size:"small",page:g,onPageChange:m,count:o>0?o:1})]})}})}),e.jsxs(y.Footer,{children:[e.jsx(k,{disabled:u||s.length===0,type:"button",onClick:()=>{N(s,i,H)},children:"Lagre"}),e.jsx(k,{disabled:u,type:"button",variant:"secondary",onClick:i,children:"Avbryt"})]})]});async function N(a,o,t){if(!(!n||n.length===0)){if(t(!0),a.length!==0){c(_.Stilling.legg_til_markerte_kandidater,{antallKandidater:n?.length,kilde:"Kandidatsøk",antallStillinger:a.length});const j=a.map(f=>L(n,f));try{await Promise.all(j),d({type:"success",tekst:`${n.length}  kandidat${n.length>1?"er":""} lagret i rekrutteringstreff`}),x(),o()}catch(f){new I({message:"Feil ved lagring av kandidater i kandidatliste",error:f}),d({type:"error",tekst:"Feil ved lagring av kandidater i kandidatliste"})}}t(!1)}}};F.__docgenInfo={description:"",methods:[],displayName:"LagreIKandidatlisteModal",props:{onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};const A=({stillingsId:i})=>{const{track:c}=S(),{erEier:d,stillingsData:n,refetchKandidatliste:x}=R(),g=B(n,d),{visVarsel:m}=b(),{markerteKandidater:l,fjernMarkerteKandidater:s}=v();async function h(){if(!(!l||l.length===0)&&i){c(_.Stilling.legg_til_markerte_kandidater,{antallKandidater:l?.length,kilde:"Finn kandidater"});try{await L(l,i),m({type:"success",tekst:`${l.length}  kandidat${l.length>1?"er":""} lagret i kandiatliste`}),s()}catch(u){new I({message:"Feil ved lagring av kandidater i kandidatliste",error:u}),m({type:"error",tekst:"Feil ved lagring av kandidater i kandidatliste"})}}}return e.jsx(k,{variant:"tertiary",onClick:()=>{h(),setTimeout(()=>{g.mutate(),x?.()},1e3)},icon:e.jsx(M,{"aria-hidden":!0}),disabled:l?.length===0,children:"Legg til markerte kandidater"})},O=({stillingsId:i})=>{const{markerteKandidater:c}=v(),[d,n]=p.useState(!1);return i?e.jsx(A,{stillingsId:i}):e.jsxs("div",{className:"flex",children:[e.jsx(k,{variant:"tertiary",onClick:()=>n(!0),icon:e.jsx(M,{"aria-hidden":!0}),disabled:c?.length===0,children:"Lagre i kandidatliste"}),d&&e.jsx(F,{onClose:()=>n(!1)})]})};O.__docgenInfo={description:"",methods:[],displayName:"LagreIKandidatlisteButton",props:{stillingsId:{required:!1,tsType:{name:"string"},description:""}}};export{w as K,O as L};
