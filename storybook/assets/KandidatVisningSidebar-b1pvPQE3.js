import{W as b,K as k,r as m,j as t,b as T,u as N,R as _}from"./iframe--aQMagBM.js";import{a as w}from"./StillingsContext-DZ7500xJ.js";import{K as j}from"./KandidatTyper-CkRsvxsW.js";import{u}from"./KandidatlisteContext-fubJ-EHq.js";import{D as M}from"./DelMedArbeidsgiver-BanTRNxf.js";import{D as C}from"./DelMedKandidatModal-xnyJaYrV.js";import{E as K,a as E}from"./EndreArkivertStatusModal-B0KZvziK.js";import{S as I,F as V}from"./FjernFåttJobbenKnapp-Dht_0stH.js";import{K as h,S as D}from"./KandidatHendelseTagVisning-DRlZd43A.js";import{K as R}from"./KandidatHendelseTag-D1ik4fHf.js";import{R as U}from"./RegistrerFåttJobbenKnapp-CqZRQNED.js";import{S as $}from"./SendSmsModal-CYDrk7HN.js";import{V as q}from"./VelgInternStatus-iUvFqx6D.js";import{A as o}from"./useForespurteOmDelingAvCv-DQ69Yz0_.js";const B=(e,r)=>`${k.internUrl}/veileder/kandidatlister/${e}/kandidater/${r}/utfall`,J=async(e,r,n,s)=>await b(B(n,s),{utfall:e,navKontor:r}),L=async(e,r,n)=>await b(`${k.internUrl}/veileder/kandidat/arbeidsgiverliste/${e}/${r}`,{navKontor:n}),y=({kandidatnummer:e,navKontor:r})=>{const[n,s]=m.useState(!1),{reFetchKandidatliste:a,kandidatlisteId:i}=u(),l=async()=>{s(!0),await L(i,e,r).finally(()=>{s(!1),a()})};return t.jsx(T,{loading:n,icon:t.jsx(I,{}),variant:"tertiary",size:"small",className:"self-center",onClick:l,children:"Fjern CV fra arbeidsgiver"})};y.__docgenInfo={description:"",methods:[],displayName:"FjernDelingMedArbeidsgiver",props:{kandidatnummer:{required:!0,tsType:{name:"string"},description:""},navKontor:{required:!0,tsType:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}]},description:""}}};const A=({kandidatHendelser:e})=>{const n=[...e.cvHendelser??[],...e.utfallsendringer??[],...e.varsler??[]].filter(s=>s!==void 0).sort((s,a)=>(a.dato?.getTime()||0)-(s.dato?.getTime()||0));return t.jsx("div",{className:"flex flex-col gap-4",children:n.map((s,a)=>t.jsx(h,{kandidatHendelse:s},a))})};A.__docgenInfo={description:"",methods:[],displayName:"KandidatHendelser",props:{kandidatHendelser:{required:!0,tsType:{name:"KandidatHendelser"},description:""}}};const H=({kandidat:e})=>{const{valgtNavKontor:r}=N(),{stillingsData:n,kandidatlisteInfo:s}=w(),{reFetchKandidatliste:a,lukketKandidatliste:i,kandidatlisteId:l}=u(),[p,f]=m.useState(!1),c=m.useRef(null),g=e.kandidatHendelser.utfallsendringer?.some(d=>"sendtTilArbeidsgiversKandidatliste"in d.raw&&d.raw.sendtTilArbeidsgiversKandidatliste),F=e.utfall===j.FATT_JOBBEN,v=e.kandidatHendelser.utfallsendringer?.some(d=>d.tekst===R.CV_slettet_hos_arbeidsgiver),x=async d=>{f(!0);try{await J(d,r?.navKontor??"",l,e.kandidatnr),a()}catch(S){new _({message:"Feil ved endring av utfall",error:S})}f(!1)};return t.jsxs("div",{className:"flex flex-col gap-4",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsxs("div",{children:[t.jsx("div",{className:"mb-2",children:n.stilling.title}),e.arkivert?t.jsx(D,{kandidat:e}):t.jsx(h,{sidebar:!0,kandidatHendelse:e.kandidatHendelser.sisteHendelse})]}),t.jsx("div",{children:s&&t.jsx(q,{lukketKandidatliste:s.kandidatlisteStatus==="LUKKET",kandidatnr:e.kandidatnr,status:e.status})})]}),!e.arkivert&&!F&&!g&&!v&&t.jsxs("div",{className:"grid grid-rows-2 gap-2",children:[t.jsx(C,{markerteKandidater:[e],fjernAllMarkering:()=>{},sidebar:!0}),t.jsx(M,{markerteKandidater:[e],sidebar:!0})]}),e.arkivert?t.jsx(K,{lukketKandidatliste:i,slettet:e.arkivert,modalRef:c}):t.jsxs("div",{className:"grid grid-cols-2 gap-2 justify-between @3xl:flex @3xl:justify-between",children:[t.jsx($,{markerteKandidater:[e],fjernAllMarkering:()=>{},sidebar:!0}),t.jsx("div",{children:e.utfall!==j.FATT_JOBBEN?t.jsx(U,{loading:p,endreUtfallForKandidat:x,lukketKandidatliste:i}):t.jsx(V,{loading:p,endreUtfallForKandidat:x,lukketKandidatliste:i})}),!v&&g&&t.jsx(y,{kandidatnummer:e.kandidatnr,navKontor:r?.navKontor??null}),t.jsx("div",{className:"flex flex-1 justify-end",children:t.jsx(K,{lukketKandidatliste:i,slettet:e.arkivert,modalRef:c})})]}),t.jsx(E,{modalRef:c,kandidat:e,kandidatlisteId:l}),t.jsx(o,{children:t.jsxs(o.Item,{children:[t.jsx(o.Header,{children:"Vis alle hendelser og varsler"}),t.jsx(o.Content,{children:t.jsx(A,{kandidatHendelser:e.kandidatHendelser})})]})})]})};H.__docgenInfo={description:"",methods:[],displayName:"KandidatHandlingerForStilling",props:{kandidat:{required:!0,tsType:{name:"KandidatVisningProps"},description:""}}};const O=({kandidatnr:e})=>{const{kandidater:r}=u(),n=r.find(s=>s.kandidatnr===e);return n?t.jsx(H,{kandidat:n}):null};O.__docgenInfo={description:"",methods:[],displayName:"KandidatVisningSidebar",props:{kandidatnr:{required:!0,tsType:{name:"string"},description:""}}};export{O as K};
