import{cJ as h,V as F,r as d,j as e,d as _,u as V,aw as w,cH as K,D as C}from"./iframe-BI30XQnF.js";import{F as E}from"./FullførStillingModal-ClbzROrq.js";import{u as b}from"./KandidatlisteContext-BnxcNx4Y.js";import{D}from"./DelMedArbeidsgiver--40g4PTA.js";import{D as I}from"./DelMedKandidatModal-79C5Qek_.js";import{E as S,a as J}from"./EndreArkivertStatusModal-niJVMDnL.js";import{S as R,F as U}from"./FjernFåttJobbenKnapp-Jqn89ps1.js";import{K as k,S as $}from"./KandidatHendelseTagVisning-C3G5qC-y.js";import{a as B}from"./KandidatHendelseTag-CSskVXBJ.js";import{R as q}from"./RegistrerFåttJobbenKnapp-CrmGXgIj.js";import{S as L,a as O}from"./SendSmsModal-ClPdngXh.js";import{V as P}from"./VelgInternStatus-hVtdaYEf.js";import{A as c}from"./Accordion-D21lTEVU.js";const z=(s,r)=>`${F.internUrl}/veileder/kandidatlister/${s}/kandidater/${r}/utfall`,G=async(s,r,a,t)=>await h(z(a,t),{utfall:s,navKontor:r}),Q=async(s,r,a)=>await h(`${F.internUrl}/veileder/kandidat/arbeidsgiverliste/${s}/${r}`,{navKontor:a}),H=({kandidatnummer:s,navKontor:r})=>{const[a,t]=d.useState(!1),{reFetchKandidatliste:n,kandidatlisteId:i}=b(),o=async()=>{t(!0),await Q(i,s,r).finally(()=>{t(!1),n()})};return e.jsx(_,{loading:a,icon:e.jsx(R,{}),variant:"tertiary",size:"small",className:"self-center",onClick:o,children:"Fjern CV fra arbeidsgiver"})};H.__docgenInfo={description:"",methods:[],displayName:"FjernDelingMedArbeidsgiver",props:{kandidatnummer:{required:!0,tsType:{name:"string"},description:""},navKontor:{required:!0,tsType:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}]},description:""}}};const y=({kandidatHendelser:s})=>{const a=[...s.cvHendelser??[],...s.utfallsendringer??[],...s.varsler??[]].filter(t=>t!==void 0).sort((t,n)=>(n.dato?.getTime()||0)-(t.dato?.getTime()||0));return e.jsx("div",{className:"flex flex-col gap-4",children:a.map((t,n)=>e.jsx(k,{kandidatHendelse:t},n))})};y.__docgenInfo={description:"",methods:[],displayName:"KandidatHendelser",props:{kandidatHendelser:{required:!0,tsType:{name:"KandidatHendelser"},description:""}}};const W=({kandidat:s})=>{const{valgtNavKontor:r}=V(),{stillingsData:a,kandidatlisteInfo:t}=w(),{reFetchKandidatliste:n,lukketKandidatliste:i,kandidatlisteId:o}=b(),[f,u]=d.useState(!1),m=d.useRef(null),[A,g]=d.useState(!1),[M,p]=d.useState(!1),v=s.kandidatHendelser.utfallsendringer?.some(l=>"sendtTilArbeidsgiversKandidatliste"in l.raw&&l.raw.sendtTilArbeidsgiversKandidatliste),T=s.utfall===K.FATT_JOBBEN,x=s.kandidatHendelser.utfallsendringer?.some(l=>l.tekst===B.CV_slettet_hos_arbeidsgiver),j=async l=>{u(!0);try{await G(l,r?.navKontor??"",o,s.kandidatnr),n()}catch(N){new C({message:"Feil ved endring av utfall",error:N})}u(!1)};return e.jsxs("div",{className:"@container flex flex-col gap-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"mb-2",children:["Kanditatliste for ",a.stilling.title]}),s.arkivert?e.jsx($,{kandidat:s}):e.jsx(k,{sidebar:!0,kandidatHendelse:s.kandidatHendelser.sisteHendelse})]}),e.jsx("div",{children:t&&e.jsx(P,{lukketKandidatliste:t.kandidatlisteStatus==="LUKKET",kandidatnr:s.kandidatnr,status:s.status})})]}),!s.arkivert&&!T&&!v&&!x&&e.jsxs("div",{className:"grid grid-cols-1 gap-2 @md:grid-cols-2",children:[e.jsx(I,{markerteKandidater:[s],fjernAllMarkering:()=>{},sidebar:!0}),e.jsx(D,{markerteKandidater:[s],sidebar:!0})]}),s.arkivert?e.jsx("div",{className:"flex flex-1 justify-end",children:e.jsx(S,{lukketKandidatliste:i,slettet:s.arkivert,modalRef:m})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 gap-2 @md:grid-cols-2",children:[e.jsx(L,{markerteKandidater:[s],setVisSendSmsModal:p}),s.utfall!==K.FATT_JOBBEN?e.jsx(q,{loading:f,endreUtfallForKandidat:j,lukketKandidatliste:i,visFullførStillingModal:g}):e.jsx(U,{loading:f,endreUtfallForKandidat:j,lukketKandidatliste:i}),!x&&v&&e.jsx(H,{kandidatnummer:s.kandidatnr,navKontor:r?.navKontor??null})]}),e.jsx("div",{className:"flex flex-1 justify-end",children:e.jsx(S,{lukketKandidatliste:i,slettet:s.arkivert,modalRef:m})})]}),e.jsx(J,{modalRef:m,kandidat:s,kandidatlisteId:o}),A&&e.jsx(E,{setVisModal:()=>g(!1)}),M&&e.jsx(O,{markerteKandidater:[s],fjernAllMarkering:()=>{},setVisSendSmsModal:()=>p(!1)}),e.jsx(c,{children:e.jsxs(c.Item,{children:[e.jsx(c.Header,{children:"Vis alle hendelser og varsler"}),e.jsx(c.Content,{children:e.jsx(y,{kandidatHendelser:s.kandidatHendelser})})]})})]})};W.__docgenInfo={description:"",methods:[],displayName:"KandidatHandlingerForStilling",props:{kandidat:{required:!0,tsType:{name:"KandidatVisningProps"},description:""}}};export{W as K};
