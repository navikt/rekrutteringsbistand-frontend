import{C as tt,t as se,al as rt,am as Ie,o as fe,a8 as nt,h1 as me,ao as Ne,W as B,h0 as te,r as u,R as J,X as st,j as s,L as at,B as ie,H as z,G as Se,d as it,a0 as ot,a3 as lt}from"./iframe-CW8P7ZDD.js";import{L as ut}from"./LeggTilArbeidsgiverForm-DXa_5h0D.js";import{I as dt,a as Re,u as ge}from"./useRekrutteringstreffData-BuySZj-Q.js";import{K as Fe,a as Ae}from"./KiAnalysePanel-CkvZBOx5.js";import{t as ue,a as ct,i as pe,k as Z}from"./utils-CK4vWKe9.js";import{o as ft,M as xe}from"./mutations-BauCygr2.js";import{u as he}from"./useRekrutteringstreff-CUiSzAnD.js";import{b as je}from"./constants-p05mtcHt.js";import{g as mt}from"./rekrutteringstreff-BNtU3qMz.js";import{a as H,b as _,C as U}from"./index.esm-Cxjo2a4M.js";import{u as gt,a as Pe}from"./useKiLogg-g9vHIEPn.js";import{R as pt}from"./RikTekstEditor-BeRBADEz.js";import{S as Me}from"./Skeleton-CcDXh5Ey.js";import{u as ht}from"./usePamPostdata-VGU1QwnQ.js";import{T as de}from"./TextField-B3lADhjg.js";import{C as Tt}from"./ComboboxProvider-Cryw7v8i.js";import{i as ee}from"./isSameDay-DCMr_Fw8.js";import{u as yt,D as Ee}from"./useDatepicker-BPyJ9lHf.js";import"./Date.Input-BxC2c25T.js";import{p as Oe}from"./parseISO-CcmPCjvl.js";import{f as Le,m as kt}from"./format-BGF-tAX-.js";import{B as ne}from"./Box-WJh-mQoH.js";function vt(e,t,n){return tt(e,+se(e)+t)}function bt(e,t,n){return vt(e,t*rt)}function Dt(e,t,n){const r=se(e,n?.in);return r.setTime(r.getTime()+t*Ie),r}function St(e){return t=>{const r=(e?Math[e]:Math.trunc)(t);return r===0?0:r}}function xt(e,t){return+se(e)-+se(t)}function jt(e,t,n){const r=xt(e,t)/Ie;return St(n?.roundingMethod)(r)}const Ve=fe({tittel:B().min(1,"Tittel kan ikke være tom"),htmlContent:B().min(1,"Innhold kan ikke være tomt"),opprettetAvPersonNavn:B().nullable().optional(),opprettetAvPersonBeskrivelse:B().min(1,"OpprettetAvPersonBeskrivelse kan ikke være tomt"),sendesTilJobbsokerTidspunkt:B().min(1,"SendesTilJobbsokerTidspunkt kan ikke være tomt")}),Be=dt,Et=e=>`${me.internUrl}/${e}/innlegg`,wt=(e,t)=>`${me.internUrl}/${e}/innlegg/${t}`,Ct=async(e,t)=>{Ve.parse(t);const n=await Ne(Et(e),t);return Be.parse(n)},It=async(e,t,n)=>{Ve.parse(n);const r=await nt(wt(e,t),n);return Be.parse(r)},qe=()=>{try{return!1}catch{return!1}},Ke=e=>{const t=mt(e?.hendelser);return t===je.INVITERE||t===je.FULLFØRE},_e=(e,t)=>t?!1:Ke(e)&&qe();function oe(){const{rekrutteringstreffId:e,startLagring:t,stoppLagring:n}=te(),{data:r,mutate:f}=he(e),{getValues:c,trigger:a,formState:m}=H(),g=u.useCallback(()=>{const l=c(),h=ue(l.fraDato??null,l.fraTid)??r?.fraTid??null,T=ue(l.tilDato??l.fraDato??null,l.tilTid)??r?.tilTid??null,y=ue(l.svarfristDato??null,l.svarfristTid)??r?.svarfrist??null,i=typeof l.tittel=="string"?l.tittel.trim():"";return{...(i.length>0||r?.tittel&&r.tittel.trim().length>0)&&{tittel:i.length>0?i:r?.tittel},beskrivelse:l.beskrivelse??r?.beskrivelse??null,fraTid:h,tilTid:T,svarfrist:y,gateadresse:l.gateadresse??r?.gateadresse??null,postnummer:l.postnummer??r?.postnummer??null,poststed:l.poststed??r?.poststed??null}},[c,r]);return{save:u.useCallback(async(l,h)=>{if(!e||_e(r,h))return;const T=!l||l.length===0;if(!await a(T?void 0:l,{shouldFocus:!1})||m?.errors?.root?.type==="manualPeriod")return;const i=g();try{t("rekrutteringstreff"),await ft(e,i),f()}finally{n("rekrutteringstreff")}},[g,e,a,r,f,m?.errors,t,n])}}function Nt(){const{rekrutteringstreffId:e,startLagring:t,stoppLagring:n}=te(),{data:r}=he(e),{data:f,mutate:c}=Re(e),a=f?.[0],{getValues:m,trigger:g,setValue:d}=H();return{save:u.useCallback(async(h,T)=>{if(!e||_e(r,T)||h&&h.length&&!await g(h,{shouldFocus:!1}))return;const y=(m("htmlContent")??"").toString();if(y.trim())try{const i=a?.opprettetAvPersonNavn||a?.opprettetAvPersonNavident||"Markedskontakt",k={htmlContent:y,tittel:"Om treffet",opprettetAvPersonNavn:i,opprettetAvPersonBeskrivelse:"Markedskontakt",sendesTilJobbsokerTidspunkt:ct(new Date,"Europe/Oslo","yyyy-MM-dd'T'HH:mm:ssXXX")};t("innlegg"),a?.id?await It(e,a.id,k):await Ct(e,k),c(),d("htmlContent",y,{shouldDirty:!1})}catch(i){new J({message:"Lagring av innlegg feilet.",error:i})}finally{n("innlegg")}},[m,a,c,e,t,n,d,r,g])}}const Rt=(e=":id")=>`${me.internUrl}/${e}/ki/valider`,Ft=fe({feltType:B(),tekst:B()}),At=fe({loggId:B(),bryterRetningslinjer:st(),begrunnelse:B()}),Pt=async(e,{arg:t})=>{const n=t.tekst.replace(/<[^>]+>/g," ").replace(/\s+/g," ").trim(),r={...t,tekst:n};Ft.parse(t);const f=await Ne(e,r);return At.parse(f)},Mt=e=>gt(Rt(e??":id"),Pt),we=e=>e==null?"":String(e).replace(/<[^>]+>/g," ").replace(/\s+/g," ").trim();function He(e){const{feltType:t,fieldName:n,watchedValue:r,triggerRHF:f,getValues:c,setValue:a,setKiFeilFieldName:m,saveCallback:g,setKiLagret:d,requireHasCheckedToShow:l,setKiSjekketFieldName:h,savedValue:T}=e,{rekrutteringstreffId:y}=te(),{data:i}=he(y),k=Ke(i)&&qe(),{trigger:A,data:v,reset:S,error:F,isMutating:I}=Mt(y),[E,N]=u.useState(null),[R,O]=u.useState(!1),[L,x]=u.useState(!1);u.useEffect(()=>{x(!1),O(!1),N(null),S(),h&&a(h,!1,{shouldDirty:!1,shouldValidate:!1,shouldTouch:!1})},[r,S,h,a]);const j=!!v&&!F&&v?.bryterRetningslinjer&&!R;u.useEffect(()=>{const G=!!v&&!F&&!!v?.bryterRetningslinjer&&!R;a(m,G,{shouldDirty:!1,shouldValidate:!1,shouldTouch:!1})},[v,F,R,m,a]);const q=u.useCallback(async()=>{if(!await f(n))return;const W=c(n),Q=(typeof W=="string"?W:String(W??"")).trim(),re=we(Q);if(re){if(T!==void 0){const K=we(T);if(re===K)return}try{const K=await A({feltType:t,tekst:Q});x(!0),h&&a(h,!0,{shouldDirty:!1,shouldValidate:!1,shouldTouch:!1});const $=K?.loggId??v?.loggId??null;if(N($),(!(K?.bryterRetningslinjer??v?.bryterRetningslinjer)||R)&&!k&&(await g(!1),$&&d))try{await d({id:$,lagret:!0})}catch(le){new J({message:`Feil ved oppdatering av /lagret for logg ${$}.`,error:le})}}catch(K){new J({message:"Validation failed:",error:K}),x(!0),h&&a(h,!0,{shouldDirty:!1,shouldValidate:!1,shouldTouch:!1})}}},[f,n,c,A,t,R,k,g,d,v,h,a,T]),D=u.useCallback(async()=>{if(k){O(!0);return}if(O(!0),await g(!0),E&&d)try{await d({id:E,lagret:!0})}catch(G){new J({message:`Feil ved oppdatering av /lagret for logg ${E}.`,error:G})}},[k,g,E,d]),P=!!v&&!F&&!!v?.bryterRetningslinjer;return{analyse:v,analyseError:F,validating:I,kiErrorBorder:j,forceSave:R,setForceSave:O,loggId:E,hasChecked:L,showAnalysis:l?L&&P:P,erRedigeringAvPublisertTreff:k,runValidationAndMaybeSave:q,onForceSave:D}}const Ce="rediger-innlegg-htmlcontent-form",Te=({onUpdated:e})=>{const{rekrutteringstreffId:t}=te(),{data:n,isLoading:r}=Re(t),f=n?.[0],c=f?f.htmlContent??null:void 0,{control:a,setValue:m,getValues:g,trigger:d,formState:{isDirty:l}}=H(),{save:h}=Nt(),{setLagret:T}=Pe(t,"innlegg"),[y,i]=u.useState(Date.now()),k=_({control:a,name:"htmlContent"});u.useEffect(()=>{const x=f?.htmlContent??"";m("htmlContent",x,{shouldDirty:!1,shouldTouch:!1,shouldValidate:!1}),i(Date.now())},[m,f?.htmlContent]);const A=async x=>{try{await h(["htmlContent"],x)}catch(j){new J({message:"Lagring av innlegg feilet.",error:j})}finally{e?.()}},{analyse:v,analyseError:S,validating:F,kiErrorBorder:I,forceSave:E,showAnalysis:N,erRedigeringAvPublisertTreff:R,runValidationAndMaybeSave:O,onForceSave:L}=He({feltType:"innlegg",fieldName:"htmlContent",watchedValue:k,triggerRHF:d,getValues:g,setValue:m,setKiFeilFieldName:"innleggKiFeil",saveCallback:A,setKiLagret:T,requireHasCheckedToShow:!0,setKiSjekketFieldName:"innleggKiSjekket",savedValue:c});return s.jsxs("section",{className:"space-y-3",children:[r&&s.jsx(Me,{variant:"text"}),!r&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(at,{htmlFor:Ce,children:f?"Endre innlegg":"Skriv nytt innlegg"}),s.jsx(ie,{size:"small",textColor:"subtle",children:"Fortell jobbsøkeren om treffet: de unike fordelene, mulighetene, og oppgavene som de vil møte. For eksempel arbeidsgivere, forventninger, læring- og karrieremuligheter."})]}),s.jsx("div",{className:`border rounded-lg ${I?"border-red-500":"border-gray-300"}`,onBlur:x=>{const j=x.currentTarget;setTimeout(async()=>{j.contains(document.activeElement)||l&&await O()},0)},children:s.jsx(U,{name:"htmlContent",control:a,render:({field:x})=>s.jsx(pt,{id:Ce,tekst:x.value??"",onChange:x.onChange},y)})}),s.jsx(Fe,{}),s.jsx(Ae,{validating:F,analyse:v,analyseError:S,forceSave:E,showAnalysis:N,erRedigeringAvPublisertTreff:R,onForceSave:L,ariaLabel:"Analyse av innlegg"})]})]})};Te.displayName="InnleggForm";Te.__docgenInfo={description:"",methods:[],displayName:"InnleggForm",props:{onUpdated:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};const C={GATEADRESSE:"gateadresse",POSTNUMMER:"postnummer",POSTSTED:"poststed"},$e=({control:e})=>{const{setValue:t,clearErrors:n,setError:r,trigger:f}=H(),{save:c}=oe(),a=_({control:e,name:C.POSTNUMMER}),{data:m,isLoading:g}=ht(a||"");return u.useEffect(()=>{!a||a.length!==4||g||(m?.korrigertNavnBy?(t(C.POSTSTED,m.korrigertNavnBy,{shouldDirty:!0,shouldValidate:!0}),n(C.POSTSTED)):(t(C.POSTSTED,"",{shouldDirty:!0,shouldValidate:!0}),r(C.POSTSTED,{type:"manual",message:"Ukjent poststed"})))},[a,g,m,t,r,n]),s.jsxs("div",{className:"space-y-4",children:[s.jsx(z,{level:"3",size:"small",children:"Sted"}),s.jsx(U,{name:C.GATEADRESSE,control:e,render:({field:d,fieldState:l})=>s.jsx(de,{...d,value:d.value??"",label:"Gateadresse",error:l.error?.message,onBlur:()=>{d.onBlur(),c([C.GATEADRESSE])}})}),s.jsxs("div",{className:"flex gap-4 items-start",children:[s.jsx(U,{name:C.POSTNUMMER,control:e,render:({field:d,fieldState:l})=>s.jsx(de,{...d,value:d.value??"",label:"Postnummer",htmlSize:12,error:l.error?.message,onChange:h=>{const T=h.target.value.replace(/\D/g,"");n([C.POSTNUMMER,C.POSTSTED]),t(C.POSTSTED,"",{shouldDirty:!1,shouldValidate:!0}),T.length<=4&&d.onChange(T),T.length===4&&f([C.POSTNUMMER])},onBlur:()=>{d.onBlur(),c([C.POSTNUMMER,C.POSTSTED])}})}),s.jsx(ie,{className:`pt-8 ${_({control:e,name:C.POSTSTED})?"":"aksel-error-message"}`,children:_({control:e,name:C.POSTSTED})||(a&&a.length===4&&!g?"Ukjent poststed":"")})]})]})};$e.__docgenInfo={description:"",methods:[],displayName:"StedForm"};const ce=[0,30],X=Array.from({length:24},(e,t)=>ce.map(n=>`${String(t).padStart(2,"0")}:${String(n).padStart(2,"0")}`)).flat(),Ot=/^([01]\d|2[0-3]):([0-5]\d)$/,Lt=e=>{const t=e.match(/^(\d{1,2})(?::?(\d{0,2}))?$/);if(!t)return null;const n=Math.min(parseInt(t[1]||"0",10)||0,23),r=parseInt(t[2]||"0",10)||0,f=ce.reduce((c,a)=>Math.abs(a-r)<Math.abs(c-r)?a:c,ce[0]);return`${String(n).padStart(2,"0")}:${String(f).padStart(2,"0")}`};function Ue({value:e,onChange:t,onBlur:n,label:r="Klokkeslett",hideLabel:f,disabled:c,error:a,className:m,options:g,maxTime:d}){const l=u.useRef(null),h=u.useRef(!1),T=u.useRef(!1),y=u.useMemo(()=>{const o=g??X;return d?o.filter(p=>p<=d):o},[g,d]),[i,k]=u.useState(e??""),[A,v]=u.useState(!1),S=u.useRef(!1),F=u.useRef(e),I=u.useRef(!1),E=u.useRef(!1),N=u.useCallback(o=>Ot.test(o)&&(!d||o<=d),[d]),R=u.useCallback(o=>!o||/^[\d:]*$/.test(o),[]),O=u.useCallback((o,p)=>d&&p>d||o.includes(p)?o:[...o,p].sort(),[d]),L=e&&N(e)?O(y,e):y,x=u.useMemo(()=>L,[L]),j=()=>{const o=l.current;if(!o||typeof document>"u")return null;const p=o.getAttribute("aria-controls");return p?document.getElementById(p):null},q=u.useCallback(()=>{if(h.current)return;const o=l.current;if(!o||o.getAttribute("aria-expanded")!=="true")return;const p=j();if(!p)return;let b=p.querySelector("[role='option'][aria-selected='true']");if(!b&&e&&(b=Array.from(p.querySelectorAll("[role='option']")).find(w=>w.textContent?.trim()===e)||null),!b)return;const V=b.closest("[role='listbox']")||b.parentElement;if(V){const w=b.offsetTop,Y=w+b.offsetHeight,De=V.scrollTop,Ye=De+V.clientHeight;if(w<De+4){V.scrollTop=Math.max(w-4,0);return}if(Y>Ye-4){const et=Math.max(w-4,0);V.scrollTop=et}}},[e]),D=u.useCallback(()=>{},[q]),P=u.useCallback(o=>{const p=o.trim();return p===""?(S.current?e&&t(""):k(e??""),!0):N(p)?(p!==e&&t(p),!0):(k(e??""),!1)},[N,t,e]),ke=u.useCallback(o=>{if(I.current&&o===""){I.current=!1;return}!S.current&&o!==""&&(S.current=!0),!(o===""&&!S.current)&&(k(o===""?"":o),o!==""&&v(!0))},[]),G=u.useCallback(o=>{const p=o.relatedTarget,b=j(),V=T.current;if(T.current=!1,!V&&(E.current||(p&&b?b.contains(p):!1))){E.current=!1,n?.(o);return}if(E.current=!1,!S.current&&(i===""||i===F.current)){k(e??""),n?.(o);return}P(i),v(!0),n?.(o)},[P,i,n,e]),W=u.useCallback((o,p)=>{const b=L;let M=(w=>w&&N(w)?b.indexOf(w):-1)(o);if(M===-1){const w=Lt(i);M=w?b.indexOf(w):-1}if(M===-1){const w=i||e||"",Y=b.indexOf(w);M=Y>=0?Y:0}return b[(M+p+b.length)%b.length]},[L,N,i,e]),Q=u.useCallback((o,p)=>{const b=W(o,p);S.current=!0,I.current=!0,k(b)},[W]),re=u.useCallback(o=>{const p=o.key;if(p==="ArrowDown"||p==="ArrowUp"){o.preventDefault(),o.stopPropagation(),Q(i||e,p==="ArrowDown"?1:-1);return}if(p==="Enter"){I.current=!0,!P(i??"")&&e&&k(e),v(!0);return}if(p==="Tab"){T.current=!0,I.current=!0,!P(i??"")&&e&&k(e),v(!0);return}},[P,i,Q,e]),K=u.useCallback(o=>{const p=o.nativeEvent,b="data"in p?p.data:null;R(b)||o.preventDefault()},[R]),$=u.useCallback(o=>{const p=o.clipboardData.getData("text");R(p)||o.preventDefault()},[R]),ve=u.useCallback(o=>{const p=o.target,b=p.tagName==="INPUT",V=p.getAttribute("role")==="option"||!!p.closest("[role='option']"),M=!!p.closest("[role='listbox']");(V||M)&&(E.current=!0),M&&(h.current=!0),b||V||M||(l.current?.focus(),o.preventDefault(),I.current=!0)},[]),be=u.useCallback(()=>{h.current=!1,S.current=!1,F.current=e,v(!1),I.current=!0,E.current=!1,T.current=!1,D()},[D,e]);u.useEffect(()=>k(e??""),[e]),u.useEffect(()=>{const o=l.current;if(!o)return;const p=new MutationObserver(()=>{o.getAttribute("aria-expanded")==="true"&&D()});return p.observe(o,{attributes:!0,attributeFilter:["aria-expanded"]}),()=>p.disconnect()},[D]);const le=u.useMemo(()=>{const o=i&&N(i)&&x.includes(i)?i:e&&N(e)&&x.includes(e)?e:void 0;return o?[o]:[]},[i,e,N,x]),Qe=`${m??"w-[7rem]"} focus-within:outline-none focus-visible:outline-none focus-within:ring-0 focus-visible:ring-0`;return s.jsx(Tt,{ref:l,label:r,hideLabel:f,disabled:c,error:a,className:Qe,options:x,filteredOptions:x,allowNewValues:!0,toggleListButton:!0,isListOpen:A?!1:void 0,value:i,inputClassName:"min-w-0",shouldShowSelectedOptions:!1,selectedOptions:le,onMouseDownCapture:ve,onFocus:be,onToggleSelected:(o,p)=>{p&&(I.current=!0,E.current=!1,k(o),F.current=o,S.current=!1,t(o),v(!0))},onChange:ke,onBlur:G,onKeyDownCapture:re,onBeforeInput:K,onPaste:$})}Ue.__docgenInfo={description:"",methods:[],displayName:"TimeInput",props:{value:{required:!1,tsType:{name:"string"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},onBlur:{required:!1,tsType:{name:"ReactFocusEventHandler",raw:"React.FocusEventHandler<HTMLInputElement>",elements:[{name:"HTMLInputElement"}]},description:""},label:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"'Klokkeslett'",computed:!1}},hideLabel:{required:!1,tsType:{name:"boolean"},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:""},error:{required:!1,tsType:{name:"union",raw:"ReactNode | boolean",elements:[{name:"ReactNode"},{name:"boolean"}]},description:""},className:{required:!1,tsType:{name:"string"},description:""},options:{required:!1,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""},maxTime:{required:!1,tsType:{name:"string"},description:""}}};function ze(e,t,n,r=15){return u.useMemo(()=>{if(!e||!t||!pe(n)||!ee(e,t))return X;const f=Z(t,n);if(!f)return X;const c=Dt(f,r);if(!ee(f,c))return r>0?[]:X;const a=c.getTime(),m=r>0;return X.filter(d=>{const l=Z(e,d);return l?m?l.getTime()>=a:l.getTime()<=a:!1})},[e,t,n,r])}function Ge(e,t){const n=u.useRef(null);return u.useEffect(()=>()=>{n.current&&clearTimeout(n.current)},[]),{scheduleSave:u.useCallback(()=>{n.current&&clearTimeout(n.current),n.current=window.setTimeout(()=>{n.current=null,e(t)},0)},[e,t])}}function We({label:e,value:t,onChange:n,onBlur:r,error:f,from:c=new Date,to:a=new Date("2040-12-31"),disabled:m}){const{inputProps:g,datepickerProps:d,selectedDay:l,setSelected:h}=yt({defaultSelected:t??void 0,fromDate:c,toDate:a,onDateChange:i=>n(i??null)}),T=u.useCallback(i=>!i||/^[\d./-]*$/.test(i),[]);u.useEffect(()=>{const i=t??void 0,k=l??void 0;(i&&(!k||k.getTime()!==i.getTime())||!i&&k)&&h(i)},[t,l,h]);const y=i=>{g.onBlur?.(i),r?.()};return s.jsx(Ee,{mode:"single",...d,children:s.jsx(Ee.Input,{...g,hideLabel:!0,label:e,error:f?f.message||!0:void 0,disabled:m,onBlur:y,onBeforeInput:i=>{const k=i.nativeEvent,A="data"in k?k.data:null;if(!T(A)){i.preventDefault();return}g.onBeforeInput?.(i)},onPaste:i=>{const k=i.clipboardData.getData("text");if(!T(k)){i.preventDefault();return}g.onPaste?.(i)},placeholder:"dd.mm.åååå"})})}We.__docgenInfo={description:"",methods:[],displayName:"ControlledDatePicker",props:{label:{required:!0,tsType:{name:"string"},description:""},value:{required:!0,tsType:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}]},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(d: Date | null) => void",signature:{arguments:[{type:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}]},name:"d"}],return:{name:"void"}}},description:""},onBlur:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},error:{required:!1,tsType:{name:"FieldError"},description:""},from:{required:!1,tsType:{name:"Date"},description:"",defaultValue:{value:"new Date()",computed:!1}},to:{required:!1,tsType:{name:"Date"},description:"",defaultValue:{value:"new Date('2040-12-31')",computed:!1}},disabled:{required:!1,tsType:{name:"boolean"},description:""}}};function ae({label:e,nameDato:t,nameTid:n,control:r,disabledDato:f,disabledTid:c,hideDato:a,dateFrom:m,dateTo:g,timeOptions:d,onDatoBlur:l,onTidBlur:h,timeMax:T}){return s.jsxs("div",{className:"flex gap-4 items-start",children:[e&&s.jsx("div",{className:"flex items-center min-w-fit mt-3",children:s.jsx(ie,{size:"small",children:e})}),!a&&s.jsx(U,{name:t,control:r,rules:{required:"Dato er obligatorisk"},render:({field:y,fieldState:i})=>s.jsx(We,{label:e??"",value:y.value,onChange:k=>y.onChange(k),onBlur:()=>{y.onBlur(),l?.()},error:i.error,disabled:f,from:m,to:g})}),a&&s.jsx(U,{name:t,control:r,render:({field:y})=>s.jsx("input",{type:"hidden",value:y.value?.toISOString()||"",onChange:()=>{}})}),s.jsx(U,{name:n,control:r,rules:{required:"Tid er obligatorisk"},render:({field:y,fieldState:i})=>s.jsx(Ue,{value:y.value??"",onChange:y.onChange,label:"Klokkeslett",hideLabel:!0,error:i.error?.message,disabled:c,onBlur:()=>{y.onBlur(),h?.()},className:"w-24",options:d??X,maxTime:T})})]})}ae.__docgenInfo={description:"",methods:[],displayName:"DatoTidRad",props:{label:{required:!1,tsType:{name:"string"},description:""},nameDato:{required:!0,tsType:{name:"Path",elements:[{name:"T"}],raw:"Path<T>"},description:""},nameTid:{required:!0,tsType:{name:"Path",elements:[{name:"T"}],raw:"Path<T>"},description:""},control:{required:!0,tsType:{name:"any"},description:""},disabledDato:{required:!1,tsType:{name:"boolean"},description:""},disabledTid:{required:!1,tsType:{name:"boolean"},description:""},hideDato:{required:!1,tsType:{name:"boolean"},description:""},dateFrom:{required:!1,tsType:{name:"Date"},description:""},dateTo:{required:!1,tsType:{name:"Date"},description:""},timeOptions:{required:!1,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""},onDatoBlur:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onTidBlur:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},timeMax:{required:!1,tsType:{name:"string"},description:""}}};const Vt=e=>e?Oe(e):null,Bt=e=>e?Le(Oe(e),"HH:mm"):"",Xe=({control:e})=>{const{save:t}=oe(),{setValue:n}=H(),[r,f]=_({control:e,name:["svarfristDato","svarfristTid"]}),[c,a]=_({control:e,name:["fraDato","fraTid"]}),{treff:m}=ge(),{scheduleSave:g}=Ge(t,["svarfristDato","svarfristTid"]),d=ze(r,c,a,0);return u.useEffect(()=>{m&&(!r&&m.svarfrist&&n("svarfristDato",Vt(m.svarfrist),{shouldValidate:!1,shouldDirty:!1}),!f&&m.svarfrist&&n("svarfristTid",Bt(m.svarfrist),{shouldValidate:!1,shouldDirty:!1}))},[m,r,f,n]),u.useEffect(()=>{if(!c||!pe(a))return;const l=Z(c,a),h=Z(r??null,f??null);!l||!h||h.getTime()>l.getTime()&&(n("svarfristDato",new Date(c),{shouldDirty:!0,shouldValidate:!1}),n("svarfristTid",a,{shouldDirty:!0,shouldValidate:!1}),g())},[c,a,r,f,n,g]),s.jsxs("div",{className:"space-y-4",children:[s.jsx(z,{level:"3",size:"small",children:"Svarfrist"}),s.jsx("div",{children:s.jsx(ae,{nameDato:"svarfristDato",nameTid:"svarfristTid",control:e,dateTo:c??void 0,timeOptions:d,onDatoBlur:g,onTidBlur:g})})]})};Xe.__docgenInfo={description:"",methods:[],displayName:"SvarfristForm",props:{control:{required:!0,tsType:{name:"any"},description:""}}};function qt(e,t,n=1){return{adjustEndTime:u.useCallback((f,c,a,m,g,d)=>{if(!f||!pe(c))return!1;const l=Z(f,c);if(!l)return!1;const T=Z(a??f,m),y=n>0;if(T?y?T.getTime()>l.getTime():T.getTime()<l.getTime():!1)return!1;const k=bt(l,n),A=Se(k),v=Le(k,"HH:mm");let S=!1;return(!a||Se(a).getTime()!==A.getTime())&&(e(g,A,{shouldDirty:!0,shouldValidate:!1}),S=!0),m!==v&&(e(d,v,{shouldDirty:!0,shouldValidate:!1}),S=!0),S&&t(),S},[e,t,n])}}const Kt=(e,t,n,r)=>{if(!e||!n)return"";const f=(m,g)=>{const[d,l]=g.split(":").map(Number),h=new Date(m);return h.setHours(d,l,0,0),h},c=f(e,t),a=f(n,r);if(ee(c,a)){const m=jt(a,c);if(m===0)return"0 minutt";const g=Math.abs(m),d=Math.floor(g/60),l=g%60,h=m<0?"-":"",T=[];return d>0&&T.push(`${d} time${d>1?"r":""}`),l>0&&T.push(`${l} minutt`),`${h}${T.join(" ")}`}else{const m=kt(a,c),g=m>=0?m+1:m;return`${g} dag${Math.abs(g)!==1?"er":""}`}},Je=({control:e})=>{const{setValue:t}=H(),{save:n}=oe(),[r,f,c,a]=_({control:e,name:["fraDato","fraTid","tilDato","tilTid"]}),[m,g]=u.useState(r&&c?!ee(r,c):!1),{scheduleSave:d}=Ge(n,["fraDato","fraTid","tilDato","tilTid","svarfristDato","svarfristTid"]),{adjustEndTime:l}=qt(t,d,1),h=ze(c??r,r,f,1);u.useEffect(()=>{const y=r&&c?!ee(r,c):!1;g(i=>i===y?i:y)},[r,c]),u.useEffect(()=>{l(r,f,c,a,"tilDato","tilTid")},[r,f,c,a,l]);const T=u.useMemo(()=>!r||!f||!a?"":Kt(r,f,c??r,a),[r,f,c,a]);return s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"flex justify-between items-center",children:s.jsx(z,{level:"3",size:"small",children:"Tid"})}),s.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[s.jsx(ae,{nameDato:"fraDato",nameTid:"fraTid",control:e,onDatoBlur:d,onTidBlur:d,timeMax:"22:59"}),s.jsx(ae,{label:"Til",nameDato:"tilDato",nameTid:"tilTid",control:e,hideDato:!m,dateFrom:r??void 0,timeOptions:h,onDatoBlur:d,onTidBlur:d}),s.jsx(ie,{size:"small",className:"mt-3",children:T||"Velg tid"})]})]})};Je.__docgenInfo={description:"",methods:[],displayName:"TidspunktForm",props:{control:{required:!0,tsType:{name:"any"},description:""}}};const Ze=()=>{const{control:e}=H();return s.jsxs("div",{className:"space-y-8",children:[s.jsx(z,{level:"2",size:"medium",children:"Praktiske forhold"}),s.jsx(Je,{control:e}),s.jsx(Xe,{control:e}),s.jsx($e,{control:e})]})};Ze.__docgenInfo={description:"",methods:[],displayName:"PraktiskeForhold"};const _t="Treff uten navn",ye=({onUpdated:e})=>{const{rekrutteringstreffId:t}=te(),{treff:n}=ge(),r=n?n.tittel??null:void 0,{setLagret:f,isLoading:c}=Pe(t,"tittel"),{control:a,setValue:m,getValues:g,trigger:d,clearErrors:l,formState:{isSubmitting:h}}=H(),T=u.useRef(null),y=_({control:a,name:"tittel"}),i=xe-(typeof y=="string"?y.length:0),{save:k}=oe(),A=async j=>{try{await k(["tittel"],j)}catch(q){new J({message:"Lagring av tittel feilet.",error:q})}finally{e?.()}},{analyse:v,analyseError:S,validating:F,kiErrorBorder:I,forceSave:E,showAnalysis:N,erRedigeringAvPublisertTreff:R,runValidationAndMaybeSave:O,onForceSave:L}=He({feltType:"tittel",fieldName:"tittel",watchedValue:y,triggerRHF:d,getValues:g,setValue:m,setKiFeilFieldName:"tittelKiFeil",saveCallback:A,setKiLagret:f,setKiSjekketFieldName:"tittelKiSjekket",savedValue:r}),x=()=>{m("tittel","",{shouldValidate:!0,shouldDirty:!0,shouldTouch:!0}),T.current?.focus()};return s.jsxs("section",{className:"space-y-3",children:[c&&s.jsx(Me,{variant:"text"}),!c&&s.jsxs(s.Fragment,{children:[s.jsx(z,{level:"2",size:"medium",children:"Navn på treffet"}),s.jsxs("div",{className:"relative w-full",children:[y&&s.jsx(it,{type:"button",onClick:x,"aria-label":"Tøm tittel feltet",variant:"tertiary",size:"small",className:"absolute right-2 top-[2rem] -translate-y-1/2 h-8 p-1",title:"Tøm feltet",children:s.jsx(ot,{"aria-hidden":!0,fontSize:"1.25rem"})}),s.jsx("div",{className:"flex items-start",children:s.jsx(U,{control:a,name:"tittel",render:({field:j,fieldState:q})=>s.jsx(de,{...j,value:j.value??"",ref:D=>{j.ref(D),T.current=D},label:"Navn på treffet",hideLabel:!0,maxLength:xe,className:"w-full pt-2",error:q.error?.message||(I?"Brudd på retningslinjer":void 0),"aria-invalid":!!(q.error||I),autoComplete:"off",autoCorrect:"off",spellCheck:!1,onChange:D=>{j.onChange(D),D.target.value.trim().length>0&&l("tittel")},onBlur:async()=>{j.onBlur(),setTimeout(async()=>{!F&&!h&&await O()},0)},onFocus:()=>{const D=j.value;if(!D||typeof D!="string")return;D.trim()===_t&&m("tittel","",{shouldValidate:!1,shouldDirty:!1,shouldTouch:!1})},onKeyDown:D=>{D.key==="Enter"&&!D.shiftKey&&(D.preventDefault(),(async()=>{const P=D.currentTarget;await O(),P?.blur()})())}})})})]}),s.jsxs(lt,{className:"text-gray-400",children:[i," tegn igjen"]}),s.jsx(Fe,{}),s.jsx(Ae,{validating:F,analyse:v,analyseError:S,forceSave:E,showAnalysis:N,erRedigeringAvPublisertTreff:R,onForceSave:L,ariaLabel:"Analyse av tittel"})]})]})};ye.displayName="TittelForm";ye.__docgenInfo={description:"",methods:[],displayName:"TittelForm",props:{onUpdated:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};const Ht=({onUpdated:e})=>{const{harPublisert:t,oppdaterData:n}=ge(),r=async()=>{n(),e?.()};return s.jsxs("div",{className:"space-y-8 max-w-[64rem] mx-auto",children:[s.jsx(ne.New,{background:"neutral-soft",borderColor:"neutral-subtle",borderRadius:"xlarge",borderWidth:"1",padding:"6",children:s.jsx(ye,{onUpdated:r})}),s.jsx(ne.New,{background:"neutral-soft",borderColor:"neutral-subtle",borderRadius:"xlarge",borderWidth:"1",padding:"6",children:s.jsx(Ze,{})}),s.jsxs(ne.New,{background:"neutral-soft",borderColor:"neutral-subtle",borderRadius:"xlarge",borderWidth:"1",padding:"6",className:"space-y-4",children:[s.jsx(z,{level:"2",size:"medium",children:"Introduksjon"}),s.jsx(Te,{onUpdated:r})]}),!t&&s.jsxs(ne.New,{background:"neutral-soft",borderColor:"neutral-subtle",borderRadius:"xlarge",borderWidth:"1",padding:"6",className:"space-y-4",children:[s.jsx(z,{level:"2",size:"medium",children:"Arbeidsgivere"}),s.jsx(ut,{variant:"inline"})]}),s.jsx("div",{"aria-hidden":!0,className:"h-80"})]})};Ht.__docgenInfo={description:"",methods:[],displayName:"RekrutteringstreffRedigering",props:{onUpdated:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onGåTilForhåndsvisning:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{Te as I,Ze as P,Ht as R,$e as S,ye as T,Je as a,Xe as b};
