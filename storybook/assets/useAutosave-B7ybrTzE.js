import{b5 as h,bD as L,b7 as p,r as d,bE as w,bF as B,h as D,bG as F,bH as R,bI as j,bq as C}from"./iframe-G1hfx8xa.js";import{a as E,t as y}from"./utils-D764uFkv.js";function P(){const{rekrutteringstreffId:t,startLagring:e,stoppLagring:o}=h(),{data:n,mutate:a}=L(t),s=n?.[0],{getValues:i,setValue:u}=p();return{lagre:d.useCallback(async()=>{if(!t)return;const l=(i().htmlContent??"").toString();if(l.trim().length!==0)try{const g=s?.opprettetAvPersonNavn||s?.opprettetAvPersonNavident||"Markedskontakt",f={htmlContent:l,tittel:"Om treffet",opprettetAvPersonNavn:g,opprettetAvPersonBeskrivelse:"Markedskontakt",sendesTilJobbsokerTidspunkt:E(new Date,"Europe/Oslo","yyyy-MM-dd'T'HH:mm:ssXXX")};e("innlegg"),s?.id?await w(t,s.id,f):await B(t,f),a(),u("htmlContent",l,{shouldDirty:!1})}catch(g){new D({message:"Lagring av innlegg feilet.",error:g})}finally{o("innlegg")}},[i,s,a,t,e,o,u]),innlegg:s}}function M(){const{rekrutteringstreffId:t,startLagring:e,stoppLagring:o}=h(),{data:n,mutate:a}=F(t),{getValues:s}=p(),i=d.useCallback(()=>{const r=s(),c=y(r.fraDato??null,r.fraTid)??n?.fraTid??null,l=y(r.tilDato??r.fraDato??null,r.tilTid)??n?.tilTid??null,g=y(r.svarfristDato??null,r.svarfristTid)??n?.svarfrist??null,f=typeof r.tittel=="string"?r.tittel.trim():"";return{tittel:f.length>0?f:n?.tittel??"Treff uten navn",beskrivelse:r.beskrivelse??n?.beskrivelse??null,fraTid:c,tilTid:l,svarfrist:g,gateadresse:r.gateadresse??n?.gateadresse??null,postnummer:r.postnummer??n?.postnummer??null,poststed:r.poststed??n?.poststed??null}},[s,n]);return{lagre:d.useCallback(async()=>{if(!t)return;const r=i();try{e("rekrutteringstreff"),await R(t,r),a()}finally{o("rekrutteringstreff")}},[i,t,a,e,o]),buildDto:i}}const O=()=>{try{return!1}catch{return!1}},H=t=>{const e=j(t?.hendelser);return e===C.INVITERE||e===C.FULLFÃ˜RE};function K(){const{watch:t,formState:e}=p(),o=t("tittelKiFeil")??!1,n=t("htmlContentKiFeil")??!1,a=!!o||!!n,s=!!(e.errors&&Object.keys(e.errors).some(g=>g!=="root")),i=a||s,u=!!e?.errors?.tittel,r=!!e?.errors?.htmlContent,c=!!t("tittelKiSjekket"),l=!!t("htmlContentKiSjekket");return{harFeil:i,harKiFeil:a,harAndreSkjemafeil:s,tittelKiFeil:o,innleggKiFeil:n,harTittelFeil:u,harInnleggFeil:r,tittelKiSjekket:c,innleggKiSjekket:l}}const V=(t,e,o,n)=>t||!e?!1:n&&o;function X(){const{rekrutteringstreffId:t}=h(),{data:e}=F(t),{getValues:o,trigger:n,formState:a}=p(),{lagre:s,buildDto:i}=M(),{tittelKiFeil:u,tittelKiSjekket:r}=K(),c=d.useCallback(async(f,k)=>{if(!t||!await n(f&&f.length>0?f:void 0,{shouldFocus:!1}))return;if(a?.errors?.root?.type==="manualPeriod"){const v=i();if((v?.fraTid??null)!==(e?.fraTid??null)||(v?.tilTid??null)!==(e?.tilTid??null))return}const I=o(),m=typeof I.tittel=="string"?I.tittel.trim():"",T=m.length>0&&m!==(e?.tittel??"");V(k??!1,T,u,r)||await s()},[t,e,i,n,a,o,s,r,u]),l=d.useCallback(async(f,k)=>{},[]);return{autosave:d.useMemo(()=>A(e)?l:c,[e,l,c])}}function q(){const{rekrutteringstreffId:t}=h(),{data:e}=F(t),{getValues:o,trigger:n,formState:a}=p(),{lagre:s,innlegg:i}=P(),{harInnleggFeil:u,innleggKiFeil:r,innleggKiSjekket:c}=K(),l=d.useCallback(async(k,b)=>{if(!t||k&&k.length&&!await n(k,{shouldFocus:!1}))return;const m=(o().htmlContent??"").toString();if(!(m.trim().length>0)||u)return;const v=i?.htmlContent??"",S=m.trim().length>0&&m!==v;V(b??!1,S,r,c)||await s()},[t,e,n,a,o,s,i,u,r,c]),g=d.useCallback(async(k,b)=>{},[]);return{autosave:d.useMemo(()=>A(e)?g:l,[e,g,l])}}const A=t=>H(t)&&O();export{O as a,X as b,H as e,q as u};
