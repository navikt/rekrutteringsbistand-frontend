import{o as fe,W as et,gH as me,ab as we,I as B,r as u,R as X,J as tt,j as s,t as rt,B as ie,H as U,b as nt,P as st,U as at}from"./iframe-DUxtTNxK.js";import{L as it}from"./LeggTilArbeidsgiverForm-Ddq7-Bk0.js";import{I as ot,a as Ce,u as ge}from"./useRekrutteringstreffData-DOzZKfj0.js";import{K as Ie,a as Ne}from"./KiAnalysePanel-ChkPfBfx.js";import{t as ue,a as lt,i as pe,k as J}from"./utils-DLV1zIhU.js";import{o as ut,M as De}from"./mutations-UydfVUV7.js";import{u as he}from"./useRekrutteringstreff-s9TdfY-S.js";import{u as re}from"./RekrutteringstreffContext-CgxDvbBy.js";import{g as dt}from"./rekrutteringstreff-gXHlv8Wn.js";import{a as _,b as K,C as $}from"./index.esm-BPxV0iuR.js";import{u as ct,a as Re}from"./useKiLogg-BXw0Ctw6.js";import{R as ft}from"./RikTekstEditor-wWU82c1l.js";import{S as Fe}from"./Skeleton-20GMgPNw.js";import{u as mt}from"./usePamPostdata-CYXS0xpb.js";import{T as de}from"./TextField-CWkQ5L8C.js";import{C as gt}from"./ComboboxProvider-DJxTMP43.js";import{c as pt,t as se,b as ht,d as Ae,s as Se}from"./startOfDay-lTP3GKUn.js";import{i as te}from"./isSameDay-nusp1S8M.js";import{u as Tt,D as xe}from"./useDatepicker-D6sx6HY5.js";import"./Date.Input-Vql_antk.js";import{p as Pe}from"./parseISO-DJIM71K9.js";import{f as Me,m as yt}from"./format-Co7MPrtN.js";import{B as ne}from"./Box-Cboms74W.js";function kt(e,t,n){return pt(e,+se(e)+t)}function vt(e,t,n){return kt(e,t*ht)}function bt(e,t,n){const r=se(e,n?.in);return r.setTime(r.getTime()+t*Ae),r}function Dt(e){return t=>{const r=(e?Math[e]:Math.trunc)(t);return r===0?0:r}}function St(e,t){return+se(e)-+se(t)}function xt(e,t,n){const r=St(e,t)/Ae;return Dt(n?.roundingMethod)(r)}const Oe=fe({tittel:B().min(1,"Tittel kan ikke være tom"),htmlContent:B().min(1,"Innhold kan ikke være tomt"),opprettetAvPersonNavn:B().nullable().optional(),opprettetAvPersonBeskrivelse:B().min(1,"OpprettetAvPersonBeskrivelse kan ikke være tomt"),sendesTilJobbsokerTidspunkt:B().min(1,"SendesTilJobbsokerTidspunkt kan ikke være tomt")}),Ve=ot,jt=e=>`${me.internUrl}/${e}/innlegg`,Et=(e,t)=>`${me.internUrl}/${e}/innlegg/${t}`,wt=async(e,t)=>{Oe.parse(t);const n=await we(jt(e),t);return Ve.parse(n)},Ct=async(e,t,n)=>{Oe.parse(n);const r=await et(Et(e,t),n);return Ve.parse(r)},Le=()=>{try{return!1}catch{return!1}},Be=e=>{const t=dt(e?.hendelser);return t==="INVITERE"||t==="FULLFØRE"},qe=(e,t)=>t?!1:Be(e)&&Le();function oe(){const{rekrutteringstreffId:e,startLagring:t,stoppLagring:n}=re(),{data:r,mutate:f}=he(e),{getValues:c,trigger:a,formState:m}=_(),g=u.useCallback(()=>{const l=c(),h=ue(l.fraDato??null,l.fraTid)??r?.fraTid??null,T=ue(l.tilDato??l.fraDato??null,l.tilTid)??r?.tilTid??null,y=ue(l.svarfristDato??null,l.svarfristTid)??r?.svarfrist??null,i=typeof l.tittel=="string"?l.tittel.trim():"";return{...(i.length>0||r?.tittel&&r.tittel.trim().length>0)&&{tittel:i.length>0?i:r?.tittel},beskrivelse:l.beskrivelse??r?.beskrivelse??null,fraTid:h,tilTid:T,svarfrist:y,gateadresse:l.gateadresse??r?.gateadresse??null,postnummer:l.postnummer??r?.postnummer??null,poststed:l.poststed??r?.poststed??null}},[c,r]);return{save:u.useCallback(async(l,h)=>{if(!e||qe(r,h))return;const T=!l||l.length===0;if(!await a(T?void 0:l,{shouldFocus:!1})||m?.errors?.root?.type==="manualPeriod")return;const i=g();try{t("rekrutteringstreff"),await ut(e,i),f()}finally{n("rekrutteringstreff")}},[g,e,a,r,f,m?.errors,t,n])}}function It(){const{rekrutteringstreffId:e,startLagring:t,stoppLagring:n}=re(),{data:r}=he(e),{data:f,mutate:c}=Ce(e),a=f?.[0],{getValues:m,trigger:g,setValue:d}=_();return{save:u.useCallback(async(h,T)=>{if(!e||qe(r,T)||h&&h.length&&!await g(h,{shouldFocus:!1}))return;const y=(m("htmlContent")??"").toString();if(y.trim())try{const i=a?.opprettetAvPersonNavn||a?.opprettetAvPersonNavident||"Markedskontakt",k={htmlContent:y,tittel:"Om treffet",opprettetAvPersonNavn:i,opprettetAvPersonBeskrivelse:"Markedskontakt",sendesTilJobbsokerTidspunkt:lt(new Date,"Europe/Oslo","yyyy-MM-dd'T'HH:mm:ssXXX")};t("innlegg"),a?.id?await Ct(e,a.id,k):await wt(e,k),c(),d("htmlContent",y,{shouldDirty:!1})}catch(i){new X({message:"Lagring av innlegg feilet.",error:i})}finally{n("innlegg")}},[m,a,c,e,t,n,d,r,g])}}const Nt=(e=":id")=>`${me.internUrl}/${e}/ki/valider`,Rt=fe({feltType:B(),tekst:B()}),Ft=fe({loggId:B(),bryterRetningslinjer:tt(),begrunnelse:B()}),At=async(e,{arg:t})=>{const n=t.tekst.replace(/<[^>]+>/g," ").replace(/\s+/g," ").trim(),r={...t,tekst:n};Rt.parse(t);const f=await we(e,r);return Ft.parse(f)},Pt=e=>ct(Nt(e??":id"),At),je=e=>e==null?"":String(e).replace(/<[^>]+>/g," ").replace(/\s+/g," ").trim();function Ke(e){const{feltType:t,fieldName:n,watchedValue:r,triggerRHF:f,getValues:c,setValue:a,setKiFeilFieldName:m,saveCallback:g,setKiLagret:d,requireHasCheckedToShow:l,setKiSjekketFieldName:h,savedValue:T}=e,{rekrutteringstreffId:y}=re(),{data:i}=he(y),k=Be(i)&&Le(),{trigger:R,data:D,reset:S,error:F,isMutating:I}=Pt(y),[j,N]=u.useState(null),[E,V]=u.useState(!1),[M,v]=u.useState(!1);u.useEffect(()=>{v(!1),V(!1),N(null),S(),h&&a(h,!1,{shouldDirty:!1,shouldValidate:!1,shouldTouch:!1})},[r,S,h,a]);const A=!!D&&!F&&D?.bryterRetningslinjer&&!E;u.useEffect(()=>{const G=!!D&&!F&&!!D?.bryterRetningslinjer&&!E;a(m,G,{shouldDirty:!1,shouldValidate:!1,shouldTouch:!1})},[D,F,E,m,a]);const x=u.useCallback(async()=>{if(!await f(n))return;const Z=c(n),Q=(typeof Z=="string"?Z:String(Z??"")).trim(),Y=je(Q);if(Y){if(T!==void 0){const q=je(T);if(Y===q)return}try{const q=await R({feltType:t,tekst:Q});v(!0),h&&a(h,!0,{shouldDirty:!1,shouldValidate:!1,shouldTouch:!1});const H=q?.loggId??D?.loggId??null;if(N(H),(!(q?.bryterRetningslinjer??D?.bryterRetningslinjer)||E)&&!k&&(await g(!1),H&&d))try{await d({id:H,lagret:!0})}catch(le){new X({message:`Feil ved oppdatering av /lagret for logg ${H}.`,error:le})}}catch(q){new X({message:"Validation failed:",error:q}),v(!0),h&&a(h,!0,{shouldDirty:!1,shouldValidate:!1,shouldTouch:!1})}}},[f,n,c,R,t,E,k,g,d,D,h,a,T]),L=u.useCallback(async()=>{if(k){V(!0);return}if(V(!0),await g(!0),j&&d)try{await d({id:j,lagret:!0})}catch(G){new X({message:`Feil ved oppdatering av /lagret for logg ${j}.`,error:G})}},[k,g,j,d]);return{analyse:D,analyseError:F,validating:I,kiErrorBorder:A,forceSave:E,setForceSave:V,loggId:j,hasChecked:M,showAnalysis:l?M:!0,erRedigeringAvPublisertTreff:k,runValidationAndMaybeSave:x,onForceSave:L}}const Ee="rediger-innlegg-htmlcontent-form",Te=({onUpdated:e})=>{const{rekrutteringstreffId:t}=re(),{data:n,isLoading:r}=Ce(t),f=n?.[0],c=f?f.htmlContent??null:void 0,{control:a,setValue:m,getValues:g,trigger:d,formState:{isDirty:l}}=_(),{save:h}=It(),{setLagret:T}=Re(t,"innlegg"),[y,i]=u.useState(Date.now()),k=K({control:a,name:"htmlContent"});u.useEffect(()=>{const v=f?.htmlContent??"";m("htmlContent",v,{shouldDirty:!1,shouldTouch:!1,shouldValidate:!1}),i(Date.now())},[m,f?.htmlContent]);const R=async v=>{try{await h(["htmlContent"],v)}catch(A){new X({message:"Lagring av innlegg feilet.",error:A})}finally{e?.()}},{analyse:D,analyseError:S,validating:F,kiErrorBorder:I,forceSave:j,showAnalysis:N,erRedigeringAvPublisertTreff:E,runValidationAndMaybeSave:V,onForceSave:M}=Ke({feltType:"innlegg",fieldName:"htmlContent",watchedValue:k,triggerRHF:d,getValues:g,setValue:m,setKiFeilFieldName:"innleggKiFeil",saveCallback:R,setKiLagret:T,requireHasCheckedToShow:!0,setKiSjekketFieldName:"innleggKiSjekket",savedValue:c});return s.jsxs("section",{className:"space-y-3",children:[r&&s.jsx(Fe,{variant:"text"}),!r&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(rt,{htmlFor:Ee,children:f?"Endre innlegg":"Skriv nytt innlegg"}),s.jsx(ie,{size:"small",textColor:"subtle",children:"Fortell jobbsøkeren om treffet: de unike fordelene, mulighetene, og oppgavene som de vil møte. For eksempel arbeidsgivere, forventninger, læring- og karrieremuligheter."})]}),s.jsx("div",{className:`border rounded-lg ${I?"border-red-500":"border-gray-300"}`,onBlur:v=>{const A=v.currentTarget;setTimeout(async()=>{A.contains(document.activeElement)||l&&await V()},0)},children:s.jsx($,{name:"htmlContent",control:a,render:({field:v})=>s.jsx(ft,{id:Ee,tekst:v.value??"",onChange:v.onChange},y)})}),s.jsx(Ie,{}),s.jsx(Ne,{validating:F,analyse:D,analyseError:S,forceSave:j,showAnalysis:N,erRedigeringAvPublisertTreff:E,onForceSave:M,variant:"innlegg",ariaLabel:"Analyse av innlegg"})]})]})};Te.displayName="InnleggForm";Te.__docgenInfo={description:"",methods:[],displayName:"InnleggForm",props:{onUpdated:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};const C={GATEADRESSE:"gateadresse",POSTNUMMER:"postnummer",POSTSTED:"poststed"},_e=({control:e})=>{const{setValue:t,clearErrors:n,setError:r,trigger:f}=_(),{save:c}=oe(),a=K({control:e,name:C.POSTNUMMER}),{data:m,isLoading:g}=mt(a||"");return u.useEffect(()=>{!a||a.length!==4||g||(m?.korrigertNavnBy?(t(C.POSTSTED,m.korrigertNavnBy,{shouldDirty:!0,shouldValidate:!0}),n(C.POSTSTED)):(t(C.POSTSTED,"",{shouldDirty:!0,shouldValidate:!0}),r(C.POSTSTED,{type:"manual",message:"Ukjent poststed"})))},[a,g,m,t,r,n]),s.jsxs("div",{className:"space-y-4",children:[s.jsx(U,{level:"3",size:"small",children:"Sted"}),s.jsx($,{name:C.GATEADRESSE,control:e,render:({field:d,fieldState:l})=>s.jsx(de,{...d,value:d.value??"",label:"Gateadresse",error:l.error?.message,onBlur:()=>{d.onBlur(),c([C.GATEADRESSE])}})}),s.jsxs("div",{className:"flex gap-4 items-start",children:[s.jsx($,{name:C.POSTNUMMER,control:e,render:({field:d,fieldState:l})=>s.jsx(de,{...d,value:d.value??"",label:"Postnummer",htmlSize:12,error:l.error?.message,onChange:h=>{const T=h.target.value.replace(/\D/g,"");n([C.POSTNUMMER,C.POSTSTED]),t(C.POSTSTED,"",{shouldDirty:!1,shouldValidate:!0}),T.length<=4&&d.onChange(T),T.length===4&&f([C.POSTNUMMER])},onBlur:()=>{d.onBlur(),c([C.POSTNUMMER,C.POSTSTED])}})}),s.jsx(ie,{className:`pt-8 ${K({control:e,name:C.POSTSTED})?"":"aksel-error-message"}`,children:K({control:e,name:C.POSTSTED})||(a&&a.length===4&&!g?"Ukjent poststed":"")})]})]})};_e.__docgenInfo={description:"",methods:[],displayName:"StedForm"};const ce=[0,30],W=Array.from({length:24},(e,t)=>ce.map(n=>`${String(t).padStart(2,"0")}:${String(n).padStart(2,"0")}`)).flat(),Mt=/^([01]\d|2[0-3]):([0-5]\d)$/,Ot=e=>{const t=e.match(/^(\d{1,2})(?::?(\d{0,2}))?$/);if(!t)return null;const n=Math.min(parseInt(t[1]||"0",10)||0,23),r=parseInt(t[2]||"0",10)||0,f=ce.reduce((c,a)=>Math.abs(a-r)<Math.abs(c-r)?a:c,ce[0]);return`${String(n).padStart(2,"0")}:${String(f).padStart(2,"0")}`};function He({value:e,onChange:t,onBlur:n,label:r="Klokkeslett",hideLabel:f,disabled:c,error:a,className:m,options:g,maxTime:d}){const l=u.useRef(null),h=u.useRef(!1),T=u.useRef(!1),y=u.useMemo(()=>{const o=g??W;return d?o.filter(p=>p<=d):o},[g,d]),[i,k]=u.useState(e??""),[R,D]=u.useState(!1),S=u.useRef(!1),F=u.useRef(e),I=u.useRef(!1),j=u.useRef(!1),N=u.useCallback(o=>Mt.test(o)&&(!d||o<=d),[d]),E=u.useCallback(o=>!o||/^[\d:]*$/.test(o),[]),V=u.useCallback((o,p)=>d&&p>d||o.includes(p)?o:[...o,p].sort(),[d]),M=e&&N(e)?V(y,e):y,v=u.useMemo(()=>M,[M]),A=()=>{const o=l.current;if(!o||typeof document>"u")return null;const p=o.getAttribute("aria-controls");return p?document.getElementById(p):null},x=u.useCallback(()=>{if(h.current)return;const o=l.current;if(!o||o.getAttribute("aria-expanded")!=="true")return;const p=A();if(!p)return;let b=p.querySelector("[role='option'][aria-selected='true']");if(!b&&e&&(b=Array.from(p.querySelectorAll("[role='option']")).find(w=>w.textContent?.trim()===e)||null),!b)return;const O=b.closest("[role='listbox']")||b.parentElement;if(O){const w=b.offsetTop,ee=w+b.offsetHeight,be=O.scrollTop,Qe=be+O.clientHeight;if(w<be+4){O.scrollTop=Math.max(w-4,0);return}if(ee>Qe-4){const Ye=Math.max(w-4,0);O.scrollTop=Ye}}},[e]),L=u.useCallback(()=>{},[x]),z=u.useCallback(o=>{const p=o.trim();return p===""?(S.current?e&&t(""):k(e??""),!0):N(p)?(p!==e&&t(p),!0):(k(e??""),!1)},[N,t,e]),G=u.useCallback(o=>{if(I.current&&o===""){I.current=!1;return}!S.current&&o!==""&&(S.current=!0),!(o===""&&!S.current)&&(k(o===""?"":o),o!==""&&D(!0))},[]),Z=u.useCallback(o=>{const p=o.relatedTarget,b=A(),O=T.current;if(T.current=!1,!O&&(j.current||(p&&b?b.contains(p):!1))){j.current=!1,n?.(o);return}if(j.current=!1,!S.current&&(i===""||i===F.current)){k(e??""),n?.(o);return}z(i),D(!0),n?.(o)},[z,i,n,e]),Q=u.useCallback((o,p)=>{const b=M;let P=(w=>w&&N(w)?b.indexOf(w):-1)(o);if(P===-1){const w=Ot(i);P=w?b.indexOf(w):-1}if(P===-1){const w=i||e||"",ee=b.indexOf(w);P=ee>=0?ee:0}return b[(P+p+b.length)%b.length]},[M,N,i,e]),Y=u.useCallback((o,p)=>{const b=Q(o,p);S.current=!0,I.current=!0,k(b)},[Q]),q=u.useCallback(o=>{const p=o.key;if(p==="ArrowDown"||p==="ArrowUp"){o.preventDefault(),o.stopPropagation(),Y(i||e,p==="ArrowDown"?1:-1);return}if(p==="Enter"){I.current=!0,!z(i??"")&&e&&k(e),D(!0);return}if(p==="Tab"){T.current=!0,I.current=!0,!z(i??"")&&e&&k(e),D(!0);return}},[z,i,Y,e]),H=u.useCallback(o=>{const p=o.nativeEvent,b="data"in p?p.data:null;E(b)||o.preventDefault()},[E]),ke=u.useCallback(o=>{const p=o.clipboardData.getData("text");E(p)||o.preventDefault()},[E]),ve=u.useCallback(o=>{const p=o.target,b=p.tagName==="INPUT",O=p.getAttribute("role")==="option"||!!p.closest("[role='option']"),P=!!p.closest("[role='listbox']");(O||P)&&(j.current=!0),P&&(h.current=!0),b||O||P||(l.current?.focus(),o.preventDefault(),I.current=!0)},[]),le=u.useCallback(()=>{h.current=!1,S.current=!1,F.current=e,D(!1),I.current=!0,j.current=!1,T.current=!1,L()},[L,e]);u.useEffect(()=>k(e??""),[e]),u.useEffect(()=>{const o=l.current;if(!o)return;const p=new MutationObserver(()=>{o.getAttribute("aria-expanded")==="true"&&L()});return p.observe(o,{attributes:!0,attributeFilter:["aria-expanded"]}),()=>p.disconnect()},[L]);const Je=u.useMemo(()=>{const o=i&&N(i)&&v.includes(i)?i:e&&N(e)&&v.includes(e)?e:void 0;return o?[o]:[]},[i,e,N,v]),Ze=`${m??"w-[7rem]"} focus-within:outline-none focus-visible:outline-none focus-within:ring-0 focus-visible:ring-0`;return s.jsx(gt,{ref:l,label:r,hideLabel:f,disabled:c,error:a,className:Ze,options:v,filteredOptions:v,allowNewValues:!0,toggleListButton:!0,isListOpen:R?!1:void 0,value:i,inputClassName:"min-w-0",shouldShowSelectedOptions:!1,selectedOptions:Je,onMouseDownCapture:ve,onFocus:le,onToggleSelected:(o,p)=>{p&&(I.current=!0,j.current=!1,k(o),F.current=o,S.current=!1,t(o),D(!0))},onChange:G,onBlur:Z,onKeyDownCapture:q,onBeforeInput:H,onPaste:ke})}He.__docgenInfo={description:"",methods:[],displayName:"TimeInput",props:{value:{required:!1,tsType:{name:"string"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},onBlur:{required:!1,tsType:{name:"ReactFocusEventHandler",raw:"React.FocusEventHandler<HTMLInputElement>",elements:[{name:"HTMLInputElement"}]},description:""},label:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"'Klokkeslett'",computed:!1}},hideLabel:{required:!1,tsType:{name:"boolean"},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:""},error:{required:!1,tsType:{name:"union",raw:"ReactNode | boolean",elements:[{name:"ReactNode"},{name:"boolean"}]},description:""},className:{required:!1,tsType:{name:"string"},description:""},options:{required:!1,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""},maxTime:{required:!1,tsType:{name:"string"},description:""}}};function $e(e,t,n,r=15){return u.useMemo(()=>{if(!e||!t||!pe(n)||!te(e,t))return W;const f=J(t,n);if(!f)return W;const c=bt(f,r);if(!te(f,c))return r>0?[]:W;const a=c.getTime(),m=r>0;return W.filter(d=>{const l=J(e,d);return l?m?l.getTime()>=a:l.getTime()<=a:!1})},[e,t,n,r])}function Ue(e,t){const n=u.useRef(null);return u.useEffect(()=>()=>{n.current&&clearTimeout(n.current)},[]),{scheduleSave:u.useCallback(()=>{n.current&&clearTimeout(n.current),n.current=window.setTimeout(()=>{n.current=null,e(t)},0)},[e,t])}}function ze({label:e,value:t,onChange:n,onBlur:r,error:f,from:c=new Date,to:a=new Date("2040-12-31"),disabled:m}){const{inputProps:g,datepickerProps:d,selectedDay:l,setSelected:h}=Tt({defaultSelected:t??void 0,fromDate:c,toDate:a,onDateChange:i=>n(i??null)}),T=u.useCallback(i=>!i||/^[\d./-]*$/.test(i),[]);u.useEffect(()=>{const i=t??void 0,k=l??void 0;(i&&(!k||k.getTime()!==i.getTime())||!i&&k)&&h(i)},[t,l,h]);const y=i=>{g.onBlur?.(i),r?.()};return s.jsx(xe,{mode:"single",...d,children:s.jsx(xe.Input,{...g,hideLabel:!0,label:e,error:f?f.message||!0:void 0,disabled:m,onBlur:y,onBeforeInput:i=>{const k=i.nativeEvent,R="data"in k?k.data:null;if(!T(R)){i.preventDefault();return}g.onBeforeInput?.(i)},onPaste:i=>{const k=i.clipboardData.getData("text");if(!T(k)){i.preventDefault();return}g.onPaste?.(i)},placeholder:"dd.mm.åååå"})})}ze.__docgenInfo={description:"",methods:[],displayName:"ControlledDatePicker",props:{label:{required:!0,tsType:{name:"string"},description:""},value:{required:!0,tsType:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}]},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(d: Date | null) => void",signature:{arguments:[{type:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}]},name:"d"}],return:{name:"void"}}},description:""},onBlur:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},error:{required:!1,tsType:{name:"FieldError"},description:""},from:{required:!1,tsType:{name:"Date"},description:"",defaultValue:{value:"new Date()",computed:!1}},to:{required:!1,tsType:{name:"Date"},description:"",defaultValue:{value:"new Date('2040-12-31')",computed:!1}},disabled:{required:!1,tsType:{name:"boolean"},description:""}}};function ae({label:e,nameDato:t,nameTid:n,control:r,disabledDato:f,disabledTid:c,hideDato:a,dateFrom:m,dateTo:g,timeOptions:d,onDatoBlur:l,onTidBlur:h,timeMax:T}){return s.jsxs("div",{className:"flex gap-4 items-start",children:[e&&s.jsx("div",{className:"flex items-center min-w-fit mt-3",children:s.jsx(ie,{size:"small",children:e})}),!a&&s.jsx($,{name:t,control:r,rules:{required:"Dato er obligatorisk"},render:({field:y,fieldState:i})=>s.jsx(ze,{label:e??"",value:y.value,onChange:k=>y.onChange(k),onBlur:()=>{y.onBlur(),l?.()},error:i.error,disabled:f,from:m,to:g})}),a&&s.jsx($,{name:t,control:r,render:({field:y})=>s.jsx("input",{type:"hidden",value:y.value?.toISOString()||"",onChange:()=>{}})}),s.jsx($,{name:n,control:r,rules:{required:"Tid er obligatorisk"},render:({field:y,fieldState:i})=>s.jsx(He,{value:y.value??"",onChange:y.onChange,label:"Klokkeslett",hideLabel:!0,error:i.error?.message,disabled:c,onBlur:()=>{y.onBlur(),h?.()},className:"w-24",options:d??W,maxTime:T})})]})}ae.__docgenInfo={description:"",methods:[],displayName:"DatoTidRad",props:{label:{required:!1,tsType:{name:"string"},description:""},nameDato:{required:!0,tsType:{name:"Path",elements:[{name:"T"}],raw:"Path<T>"},description:""},nameTid:{required:!0,tsType:{name:"Path",elements:[{name:"T"}],raw:"Path<T>"},description:""},control:{required:!0,tsType:{name:"any"},description:""},disabledDato:{required:!1,tsType:{name:"boolean"},description:""},disabledTid:{required:!1,tsType:{name:"boolean"},description:""},hideDato:{required:!1,tsType:{name:"boolean"},description:""},dateFrom:{required:!1,tsType:{name:"Date"},description:""},dateTo:{required:!1,tsType:{name:"Date"},description:""},timeOptions:{required:!1,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""},onDatoBlur:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onTidBlur:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},timeMax:{required:!1,tsType:{name:"string"},description:""}}};const Vt=e=>e?Pe(e):null,Lt=e=>e?Me(Pe(e),"HH:mm"):"",Ge=({control:e})=>{const{save:t}=oe(),{setValue:n}=_(),[r,f]=K({control:e,name:["svarfristDato","svarfristTid"]}),[c,a]=K({control:e,name:["fraDato","fraTid"]}),{treff:m}=ge(),{scheduleSave:g}=Ue(t,["svarfristDato","svarfristTid"]),d=$e(r,c,a,0);return u.useEffect(()=>{m&&(!r&&m.svarfrist&&n("svarfristDato",Vt(m.svarfrist),{shouldValidate:!1,shouldDirty:!1}),!f&&m.svarfrist&&n("svarfristTid",Lt(m.svarfrist),{shouldValidate:!1,shouldDirty:!1}))},[m,r,f,n]),u.useEffect(()=>{if(!c||!pe(a))return;const l=J(c,a),h=J(r??null,f??null);!l||!h||h.getTime()>l.getTime()&&(n("svarfristDato",new Date(c),{shouldDirty:!0,shouldValidate:!1}),n("svarfristTid",a,{shouldDirty:!0,shouldValidate:!1}),g())},[c,a,r,f,n,g]),s.jsxs("div",{className:"space-y-4",children:[s.jsx(U,{level:"3",size:"small",children:"Svarfrist"}),s.jsx("div",{children:s.jsx(ae,{nameDato:"svarfristDato",nameTid:"svarfristTid",control:e,dateTo:c??void 0,timeOptions:d,onDatoBlur:g,onTidBlur:g})})]})};Ge.__docgenInfo={description:"",methods:[],displayName:"SvarfristForm",props:{control:{required:!0,tsType:{name:"any"},description:""}}};function Bt(e,t,n=1){return{adjustEndTime:u.useCallback((f,c,a,m,g,d)=>{if(!f||!pe(c))return!1;const l=J(f,c);if(!l)return!1;const T=J(a??f,m),y=n>0;if(T?y?T.getTime()>l.getTime():T.getTime()<l.getTime():!1)return!1;const k=vt(l,n),R=Se(k),D=Me(k,"HH:mm");let S=!1;return(!a||Se(a).getTime()!==R.getTime())&&(e(g,R,{shouldDirty:!0,shouldValidate:!1}),S=!0),m!==D&&(e(d,D,{shouldDirty:!0,shouldValidate:!1}),S=!0),S&&t(),S},[e,t,n])}}const qt=(e,t,n,r)=>{if(!e||!n)return"";const f=(m,g)=>{const[d,l]=g.split(":").map(Number),h=new Date(m);return h.setHours(d,l,0,0),h},c=f(e,t),a=f(n,r);if(te(c,a)){const m=xt(a,c);if(m===0)return"0 minutt";const g=Math.abs(m),d=Math.floor(g/60),l=g%60,h=m<0?"-":"",T=[];return d>0&&T.push(`${d} time${d>1?"r":""}`),l>0&&T.push(`${l} minutt`),`${h}${T.join(" ")}`}else{const m=yt(a,c),g=m>=0?m+1:m;return`${g} dag${Math.abs(g)!==1?"er":""}`}},We=({control:e})=>{const{setValue:t}=_(),{save:n}=oe(),[r,f,c,a]=K({control:e,name:["fraDato","fraTid","tilDato","tilTid"]}),[m,g]=u.useState(r&&c?!te(r,c):!1),{scheduleSave:d}=Ue(n,["fraDato","fraTid","tilDato","tilTid","svarfristDato","svarfristTid"]),{adjustEndTime:l}=Bt(t,d,1),h=$e(c??r,r,f,1);u.useEffect(()=>{const y=r&&c?!te(r,c):!1;g(i=>i===y?i:y)},[r,c]),u.useEffect(()=>{l(r,f,c,a,"tilDato","tilTid")},[r,f,c,a,l]);const T=u.useMemo(()=>!r||!f||!a?"":qt(r,f,c??r,a),[r,f,c,a]);return s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"flex justify-between items-center",children:s.jsx(U,{level:"3",size:"small",children:"Tid"})}),s.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[s.jsx(ae,{nameDato:"fraDato",nameTid:"fraTid",control:e,onDatoBlur:d,onTidBlur:d,timeMax:"22:59"}),s.jsx(ae,{label:"Til",nameDato:"tilDato",nameTid:"tilTid",control:e,hideDato:!m,dateFrom:r??void 0,timeOptions:h,onDatoBlur:d,onTidBlur:d}),s.jsx(ie,{size:"small",className:"mt-3",children:T||"Velg tid"})]})]})};We.__docgenInfo={description:"",methods:[],displayName:"TidspunktForm",props:{control:{required:!0,tsType:{name:"any"},description:""}}};const Xe=()=>{const{control:e}=_();return s.jsxs("div",{className:"space-y-8",children:[s.jsx(U,{level:"2",size:"medium",children:"Praktiske forhold"}),s.jsx(We,{control:e}),s.jsx(Ge,{control:e}),s.jsx(_e,{control:e})]})};Xe.__docgenInfo={description:"",methods:[],displayName:"PraktiskeForhold"};const Kt="Treff uten navn",ye=({onUpdated:e})=>{const{rekrutteringstreffId:t}=re(),{treff:n}=ge(),r=n?n.tittel??null:void 0,{setLagret:f,isLoading:c}=Re(t,"tittel"),{control:a,setValue:m,getValues:g,trigger:d,clearErrors:l,formState:{isSubmitting:h}}=_(),T=u.useRef(null),y=K({control:a,name:"tittel"}),i=De-(typeof y=="string"?y.length:0),{save:k}=oe(),R=async v=>{try{await k(["tittel"],v)}catch(A){new X({message:"Lagring av tittel feilet.",error:A})}finally{e?.()}},{analyse:D,analyseError:S,validating:F,kiErrorBorder:I,forceSave:j,erRedigeringAvPublisertTreff:N,runValidationAndMaybeSave:E,onForceSave:V}=Ke({feltType:"tittel",fieldName:"tittel",watchedValue:y,triggerRHF:d,getValues:g,setValue:m,setKiFeilFieldName:"tittelKiFeil",saveCallback:R,setKiLagret:f,setKiSjekketFieldName:"tittelKiSjekket",savedValue:r}),M=()=>{m("tittel","",{shouldValidate:!0,shouldDirty:!0,shouldTouch:!0}),T.current?.focus()};return s.jsxs("section",{className:"space-y-3",children:[c&&s.jsx(Fe,{variant:"text"}),!c&&s.jsxs(s.Fragment,{children:[s.jsx(U,{level:"2",size:"medium",children:"Navn på treffet"}),s.jsxs("div",{className:"relative w-full",children:[y&&s.jsx(nt,{type:"button",onClick:M,"aria-label":"Tøm tittel feltet",variant:"tertiary",size:"small",className:"absolute right-2 top-[2rem] -translate-y-1/2 h-8 p-1",title:"Tøm feltet",children:s.jsx(st,{"aria-hidden":!0,fontSize:"1.25rem"})}),s.jsx("div",{className:"flex items-start",children:s.jsx($,{control:a,name:"tittel",render:({field:v,fieldState:A})=>s.jsx(de,{...v,value:v.value??"",ref:x=>{v.ref(x),T.current=x},label:"Navn på treffet",hideLabel:!0,maxLength:De,className:"w-full pt-2",error:A.error?.message||(I?"Brudd på retningslinjer":void 0),"aria-invalid":!!(A.error||I),autoComplete:"off",autoCorrect:"off",spellCheck:!1,onChange:x=>{v.onChange(x),x.target.value.trim().length>0&&l("tittel")},onBlur:async()=>{v.onBlur(),setTimeout(async()=>{!F&&!h&&await E()},0)},onFocus:()=>{const x=v.value;if(!x||typeof x!="string")return;x.trim()===Kt&&m("tittel","",{shouldValidate:!1,shouldDirty:!1,shouldTouch:!1})},onKeyDown:x=>{x.key==="Enter"&&!x.shiftKey&&(x.preventDefault(),(async()=>{const L=x.currentTarget;await E(),L?.blur()})())}})})})]}),s.jsxs(at,{className:"text-gray-400",children:[i," tegn igjen"]}),s.jsx(Ie,{}),s.jsx(Ne,{validating:F,analyse:D,analyseError:S,forceSave:j,showAnalysis:!0,erRedigeringAvPublisertTreff:N,onForceSave:V,variant:"tittel",ariaLabel:"Analyse av tittel"})]})]})};ye.displayName="TittelForm";ye.__docgenInfo={description:"",methods:[],displayName:"TittelForm",props:{onUpdated:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};const _t=({onUpdated:e})=>{const{harPublisert:t,oppdaterData:n}=ge(),r=async()=>{n(),e?.()};return s.jsxs("div",{className:"space-y-8 max-w-[64rem] mx-auto",children:[s.jsx(ne.New,{background:"neutral-soft",borderColor:"neutral-subtle",borderRadius:"xlarge",borderWidth:"1",padding:"6",children:s.jsx(ye,{onUpdated:r})}),s.jsx(ne.New,{background:"neutral-soft",borderColor:"neutral-subtle",borderRadius:"xlarge",borderWidth:"1",padding:"6",children:s.jsx(Xe,{})}),s.jsxs(ne.New,{background:"neutral-soft",borderColor:"neutral-subtle",borderRadius:"xlarge",borderWidth:"1",padding:"6",className:"space-y-4",children:[s.jsx(U,{level:"2",size:"medium",children:"Introduksjon"}),s.jsx(Te,{onUpdated:r})]}),!t&&s.jsxs(ne.New,{background:"neutral-soft",borderColor:"neutral-subtle",borderRadius:"xlarge",borderWidth:"1",padding:"6",className:"space-y-4",children:[s.jsx(U,{level:"2",size:"medium",children:"Arbeidsgivere"}),s.jsx(it,{variant:"inline"})]}),s.jsx("div",{"aria-hidden":!0,className:"h-80"})]})};_t.__docgenInfo={description:"",methods:[],displayName:"RekrutteringstreffRedigering",props:{onUpdated:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onGåTilForhåndsvisning:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{Te as I,Xe as P,_t as R,_e as S,ye as T,We as a,Ge as b};
