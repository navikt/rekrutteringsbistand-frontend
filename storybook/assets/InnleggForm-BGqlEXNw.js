import{b5 as A,bD as L,b7 as N,bB as D,r as l,bE as V,j as e,L as B,B as P,C as _,h as H}from"./iframe-cKv9Xcbc.js";import{K as q}from"./KiAnalyse-DP6zbnca.js";import{K as W}from"./KiAnalysePanel-5hPUALNJ.js";import{u as z}from"./useAutosave-BuoCzTP1.js";import{u as M}from"./useKiAnalyse-_ETAtdHR.js";import{R as O}from"./RikTekstEditor-De4BdzPK.js";import{S as U}from"./Skeleton-BJ4X5ljx.js";const g="rediger-innlegg-htmlcontent-form",m=({onUpdated:d})=>{const{rekrutteringstreffId:a}=A(),{data:c,isLoading:o}=L(a),n=c?.[0],u=n?n.htmlContent??null:void 0,{control:i,setValue:r,getValues:h,trigger:f,formState:{isDirty:v}}=N(),{save:y}=z(),{setLagret:p}=D(a,"innlegg"),[k,x]=l.useState(Date.now()),C=V({control:i,name:"htmlContent"});l.useEffect(()=>{const t=n?.htmlContent??"";r("htmlContent",t,{shouldDirty:!1,shouldTouch:!1,shouldValidate:!1}),x(Date.now())},[r,n?.htmlContent]);const b=async t=>{try{await y(["htmlContent"],t)}catch(s){new H({message:"Lagring av innlegg feilet.",error:s})}finally{d?.()}},{analyse:j,analyseError:F,validating:E,kiErrorBorder:K,forceSave:S,showAnalysis:I,erRedigeringAvPublisertTreff:R,runValidationAndMaybeSave:T,onForceSave:w}=M({feltType:"innlegg",fieldName:"htmlContent",watchedValue:C,triggerRHF:f,getValues:h,setValue:r,setKiFeilFieldName:"innleggKiFeil",saveCallback:b,setKiLagret:p,requireHasCheckedToShow:!0,setKiSjekketFieldName:"innleggKiSjekket",savedValue:u});return e.jsxs("section",{className:"space-y-3",children:[o&&e.jsx(U,{variant:"text"}),!o&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:g,children:n?"Endre innlegg":"Skriv nytt innlegg"}),e.jsx(P,{size:"small",textColor:"subtle",children:"Fortell jobbsøkeren om treffet: de unike fordelene, mulighetene, og oppgavene som de vil møte. For eksempel arbeidsgivere, forventninger, læring- og karrieremuligheter."})]}),e.jsx("div",{className:`border rounded-lg ${K?"border-red-500":"border-gray-300"}`,onBlur:t=>{const s=t.currentTarget;setTimeout(async()=>{s.contains(document.activeElement)||v&&await T()},0)},children:e.jsx(_,{name:"htmlContent",control:i,render:({field:t})=>e.jsx(O,{id:g,tekst:t.value??"",onChange:t.onChange},k)})}),e.jsx(q,{}),e.jsx(W,{validating:E,analyse:j,analyseError:F,forceSave:S,showAnalysis:I,erRedigeringAvPublisertTreff:R,onForceSave:w,ariaLabel:"Analyse av innlegg"})]})]})};m.displayName="InnleggForm";m.__docgenInfo={description:"",methods:[],displayName:"InnleggForm",props:{onUpdated:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{m as I};
