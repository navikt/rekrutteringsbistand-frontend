import{r as c,f as z,j as e,ai as F,ab as K,K as R,c as _,u as H,b as k,A as L,w as C}from"./iframe-DUxtTNxK.js";import{u as B,A as h}from"./useForespurteOmDelingAvCv-DjhNK1Vc.js";import{a as P}from"./StillingsContext-DwxaThtx.js";import{u as V}from"./KandidatlisteContext-tMH_2NXv.js";import{S as J}from"./SWRLaster-ahx2Fy0D.js";import{U}from"./umamiEvents-BDpRy9-M.js";import{M as w}from"./Modal-DyHa_SWt.js";import{T as d}from"./Table-DJOK_ZZE.js";import{C as $}from"./ComboboxProvider-DJxTMP43.js";var q=function(t,o){var l={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&o.indexOf(s)<0&&(l[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)o.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(l[s[r]]=t[s[r]]);return l};const Z=c.forwardRef((t,o)=>{var{title:l,titleId:s}=t,r=q(t,["title","titleId"]);let n=z();return n=l?s||"title-"+n:void 0,c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 24 24",focusable:!1,role:"img",ref:o,"aria-labelledby":n},r),l?c.createElement("title",{id:n},l):null,c.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M5.75 20.25V3.75h12.5v9.75a.75.75 0 0 0 1.5 0v-10c0-.69-.56-1.25-1.25-1.25h-13c-.69 0-1.25.56-1.25 1.25v17c0 .69.56 1.25 1.25 1.25h1.742a.75.75 0 0 0 0-1.5zm5.2-14.1a.75.75 0 0 1 .15 1.05l-1.5 2a.75.75 0 0 1-1.13.08l-1-1a.75.75 0 0 1 1.06-1.06l.389.388L9.9 6.3a.75.75 0 0 1 1.05-.15M13 7.25a.75.75 0 0 0 0 1.5h2.5a.75.75 0 0 0 0-1.5zm-3.514 5.204a.75.75 0 0 1 .819-.14l9 4a.75.75 0 0 1 0 1.371l-9 4a.75.75 0 0 1-1.007-.948L10.699 17l-1.401-3.737a.75.75 0 0 1 .188-.809m1.845 1.958.689 1.838H14a.75.75 0 0 1 0 1.5h-1.98l-.69 1.838L17.154 17z",clipRule:"evenodd"}))}),E=({opprettetAvNavn:t,stillingstittel:o})=>{const l=c.useRef(null),s=c.useCallback(n=>{if(n){const m=n.contentWindow?.document,x=m?.getElementById("tittel"),u=m?.getElementById("stillingstittel"),j=m?.getElementById("avsender");x&&(x.innerText=o||"stilling"),u&&(u.innerText=o||"stilling"),j&&(j.innerHTML=t)}},[t,o]);c.useEffect(()=>{s(l.current)},[s]);const r=n=>{l.current=n,s(n)};return e.jsx("iframe",{title:"forhåndsvisning",className:"border-border-divider h-[30rem] max-h-full w-full rounded-lg border",onLoad:n=>r(n.currentTarget),src:`${F.internUrl}/template`})};E.__docgenInfo={description:"",methods:[],displayName:"ForhåndsvisningAvEpost",props:{opprettetAvNavn:{required:!0,tsType:{name:"string"},description:""},stillingstittel:{required:!1,tsType:{name:"string"},description:""}}};const W=t=>`${R.internUrl}/veileder/kandidatlister/${t}/deltekandidater`,G=async t=>await K(W(t.kandidatlisteId),{epostMottakere:t.mailadresser,epostTekst:"",kandidater:t.kandidatnummerListe,navKontor:t.navKontor}),Q=({markerteKandidater:t,sidebar:o})=>{const{track:l}=_(),[s,r]=c.useState(!1),[n,m]=c.useState(!1),{valgtNavKontor:x}=H(),{stillingsData:u}=P(),{kandidatlisteId:j,reFetchKandidatliste:S,kandidatlisteRawData:D}=V(),I=B(u.stilling.uuid),A=u.stilling.contactList?.map(i=>i.email).filter(i=>i!==null&&i.trim()!=="")||[],[f,b]=c.useState(A),N=async i=>{l(U.Stilling.del_kandidat_med_arbeidsgiver,{antall:i.length}),r(!0),await G({kandidatlisteId:j,kandidatnummerListe:i,mailadresser:f,navKontor:x?.navKontor??""}).then(()=>{r(!1),b([]),m(!1),S()})},M=i=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(i);return e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"text-nowrap",onClick:()=>m(!0),disabled:t.length===0,variant:o?"primary":"tertiary",icon:e.jsx(Z,{title:"Del med arbeidsgiver"}),children:"Del CV med arbeidsgiver"}),e.jsx(w,{className:"overflow-visible",width:"medium",open:n,onClose:()=>m(!1),"aria-label":"Del kandidater med arbeidsgiver",header:{heading:"Del med arbeidsgiver"},children:e.jsx(J,{hooks:[I],children:i=>{const p=t.filter(a=>{const v=(a.aktørid&&i[a.aktørid])??null;return(v?v?.some(y=>y.svar?.harSvartJa===!0):null)?a:null}),T=p.length===t.length;return e.jsxs(e.Fragment,{children:[e.jsxs(w.Body,{className:"overflow-visible",children:[!T&&e.jsx(L,{variant:"warning",size:"small",className:"mb-4",children:e.jsxs(C,{children:[p.length===0?"Kandidaten(e) ":`${t.length-p.length} av kandidatene har `,"har ikke svart eller svart nei på om CV-en kan deles."]})}),e.jsx(h,{size:"small",headingSize:"xsmall",className:"my-4",children:e.jsxs(h.Item,{children:[e.jsx(h.Header,{children:"Vis kandidater"}),e.jsx(h.Content,{children:e.jsxs(d,{size:"small",children:[e.jsx(d.Header,{children:e.jsxs(d.Row,{children:[e.jsx(d.HeaderCell,{scope:"col",children:"Navn"}),e.jsx(d.HeaderCell,{scope:"col",children:"Fødselsnr."}),e.jsx(d.HeaderCell,{scope:"col",children:"Kan deles"})]})}),e.jsx(d.Body,{children:t?.map(({fornavn:a,etternavn:v,fodselsnr:g},y)=>e.jsxs(d.Row,{children:[e.jsxs(d.HeaderCell,{scope:"row",children:[a," ",v]}),e.jsx(d.DataCell,{children:g}),e.jsx(d.DataCell,{children:g&&p.some(O=>O.fodselsnr===g)?"Ja":"Nei"})]},y))})]})})]})}),e.jsx(C,{children:"Send en e-post med kandidater med arbeidsgiveren."}),e.jsx($,{className:"my-4 ",allowNewValues:!0,label:"E-post til arbeidsgiver",options:A,selectedOptions:f,shouldAutocomplete:!1,isMultiSelect:!0,onToggleSelected:(a,v)=>{v?M(a)&&b([...f,a]):b(f.filter(g=>g!==a))}}),e.jsx(h,{children:e.jsxs(h.Item,{children:[e.jsx(h.Header,{children:"Forhåndsvis e-posten"}),e.jsx(h.Content,{children:e.jsx(E,{stillingstittel:u.stilling.title,opprettetAvNavn:D.opprettetAv.navn})})]})})]}),e.jsxs(w.Footer,{children:[e.jsx(k,{variant:"secondary",onClick:()=>m(!1),children:"Avbryt"}),e.jsx(k,{loading:s,disabled:p.length===0||f.length===0,variant:"primary",onClick:()=>N(p.map(a=>a.kandidatnr).filter(a=>a!==null)),children:"Del kandidatene"})]})]})}})})]})};Q.__docgenInfo={description:"",methods:[],displayName:"DelMedArbeidsgiver",props:{markerteKandidater:{required:!0,tsType:{name:"Array",elements:[{name:"z.infer",elements:[{name:"kandidaterSchema"}],raw:"z.infer<typeof kandidaterSchema>"}],raw:"KandidatListeKandidatDTO[]"},description:""},sidebar:{required:!1,tsType:{name:"boolean"},description:""}}};export{Q as D,E as F};
