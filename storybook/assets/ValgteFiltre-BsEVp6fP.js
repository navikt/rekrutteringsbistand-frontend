import{f as X,r as n,j as e,e as w}from"./iframe-Cv24_U16.js";import{f as L}from"./FilterChip-jz6BT_MV.js";import{T as A}from"./TømFiltre-DPkOWCuF.js";import{a as Y}from"./util-Cq_qb_RM.js";import{U as x}from"./umamiEvents-D8PysN3T.js";import{C as E}from"./Chips-CJFrQ7WQ.js";import{S as N}from"./ChevronDown-Dwt-O8DS.js";const Z=({tømFiltreProps:d,filtre:U=[]})=>{const o=X(),[l,b]=n.useState(!1),[f,C]=n.useState(0),[c,D]=n.useState(null),[g,V]=n.useState(0),[W,I]=n.useState(0),R=n.useRef(null),u=n.useRef(null),$=n.useRef(null),M=n.useRef(null),r=U.flatMap((t,s)=>(t.type||[]).map((i,_)=>{const v=t.mapVerdiNavn?L(t.mapVerdiNavn(i)):L(Y(i));return{key:`${s}-${i}-${_}`,label:v,remove:()=>t.setVerdi((t.type||[]).filter(k=>k!==i))}})),B=Math.max(0,r.length-f),F=B>0;if(n.useEffect(()=>{l?o.track(x.Generell.åpne_filter_chip_panel):o.track(x.Generell.lukk_filter_chip_panel)},[l,o]),n.useLayoutEffect(()=>{if(!R.current||!u.current)return;const t=R.current.offsetWidth;if(!t)return;const s=u.current,i=Array.from(s.querySelectorAll("button[data-chip-measure]")),_=s.querySelector("button[data-clear-all]"),v=s.querySelector("div[data-control-wrapper]"),k=v?.querySelector("span[data-count-text]"),z=getComputedStyle(s),T=parseFloat(z.columnGap||z.gap||"0")||0,p=_?.offsetWidth||0,Q=i.map(a=>a.offsetWidth),h=[];if(Q.reduce((a,m,q)=>{const S=a+m+(q>0||p>0?T:0);return h.push(S),S},p),(h[h.length-1]||p)<=t){f!==r.length&&C(r.length),g!==0&&V(0);return}let j=0,y=0;for(let a=r.length;a>=0;a--){const m=r.length-a;if(m===0){if((a===0?p:h[a-1])<=t){j=a,y=0;break}continue}k&&(k.textContent=`+ ${m} filter${m!==1?"e":""}`);const G=(v?.offsetWidth||0)+16+8,H=a===0?p:h[a-1];if(H+(H>0?T:0)+G<=t){j=a,y=G;break}}j!==f&&C(j),y!==g&&V(y)},[r,d,f,g]),n.useLayoutEffect(()=>{const t=$.current;if(t&&!c&&D(t.getBoundingClientRect().height),W===0&&u.current){const s=u.current.querySelector("button[data-collapse-measure]");if(s){const i=s.offsetWidth+8;I(i)}}},[c,W]),n.useEffect(()=>{let t;const s=()=>{clearTimeout(t),t=setTimeout(()=>C(0),150)};return window.addEventListener("resize",s),()=>{clearTimeout(t),window.removeEventListener("resize",s)}},[]),r.length===0)return null;const J=l?r:r.slice(0,f),K=l?c?`${c*8}px`:"600px":c?`${c}px`:"40px",O=l?(W||40)+16:0;return e.jsx("div",{ref:R,className:"w-full",children:e.jsxs("div",{className:"flex justify-between relative",children:[e.jsxs(E,{ref:$,size:"small",className:"flex items-center gap-2 flex-wrap flex-1 min-w-0 transition-all duration-300 ease-in-out overflow-hidden",style:{maxHeight:K,paddingRight:O},"aria-expanded":l,children:[d&&e.jsx("div",{className:"flex-shrink-0",children:e.jsx(A,{...d,"data-clear-all":"true",className:"flex-shrink-0"})}),J.map(t=>e.jsx(E.Removable,{onClick:t.remove,style:{whiteSpace:"nowrap",flexShrink:0},className:"flex-shrink-0",children:t.label},t.key))]}),e.jsxs("div",{ref:u,className:"invisible fixed left-[-9999px] flex items-center gap-2 flex-nowrap","aria-hidden":"true",children:[d&&e.jsx("div",{className:"flex-shrink-0",children:e.jsx(A,{...d,"data-clear-all":!0,className:"flex-shrink-0"})}),r.map(t=>e.jsx(E.Removable,{"data-chip-measure":!0,onClick:s=>s.preventDefault(),className:"flex-shrink-0 whitespace-nowrap",children:t.label},`m-${t.key}`)),e.jsxs("div",{"data-control-wrapper":!0,className:"flex items-center gap-2",children:[e.jsx("span",{"data-count-text":!0,className:"text-s whitespace-nowrap",children:"+ 0 filtre"}),e.jsx(w,{"data-expand-measure":!0,size:"small",variant:"tertiary",className:"flex-shrink-0",icon:e.jsx(N,{})}),e.jsx(w,{"data-collapse-measure":!0,size:"small",variant:"tertiary",className:"flex-shrink-0",icon:e.jsx(N,{className:"rotate-180"})})]})]}),F&&!l&&e.jsxs("div",{className:"absolute inset-y-0 right-0 flex items-center justify-end",style:{width:g},children:[e.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{background:"linear-gradient(to right, rgba(0,0,0,0) 0%, var(--ax-surface-default) 55%)"}}),e.jsxs("div",{className:"relative flex items-center gap-2 pr-2 ",children:[e.jsx("span",{onClick:()=>{b(!0),o.track(x.Generell.åpne_filter_chip_panel_tekst)},className:"cursor-pointer text-s whitespace-nowrap",children:`+ ${B} filtre`}),e.jsx(w,{onClick:()=>{b(!0),o.track(x.Generell.åpne_filter_chip_panel)},size:"small",variant:"tertiary","aria-label":"Vis flere filtre",icon:e.jsx(N,{className:"transition-transform"})})]})]}),l&&e.jsx("div",{className:"absolute top-0 right-0 pr-2 pt-0",children:e.jsx(w,{ref:M,size:"small",variant:"tertiary","aria-label":"Skjul filtre",onClick:()=>{b(!1),o.track(x.Generell.lukk_filter_chip_panel)},icon:e.jsx(N,{className:"rotate-180 transition-transform"})})})]})})};Z.__docgenInfo={description:"",methods:[],displayName:"ValgteFiltre",props:{filtre:{defaultValue:{value:"[]",computed:!1},required:!1}}};export{Z as V};
