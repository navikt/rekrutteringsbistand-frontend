import{bg as V,K as B,dp as F,r as f,j as e,F as v,d as b,aA as T,p as q,de as C,bX as M,C as w,B as z}from"./iframe-CVBkVRHF.js";import{B as N}from"./Box-nDoT1RKb.js";import{T as k}from"./TextField-D1bsAp3q.js";import{S as D}from"./Plus-DDDAk5pP.js";import{a as x}from"./util-BXWN6ppT.js";import{C as K}from"./ComboboxProvider-x6x8GO29.js";function O(){const{control:y,register:l,trigger:m,clearErrors:r,formState:{errors:c}}=V(),u=B(),{fields:p,append:g,remove:i}=F({control:y,name:"stilling.contactList"}),s=f.useRef(!1);return f.useEffect(()=>{if(!s.current){if(p.length===0){const d=u?.stillingsData?.stilling?.contactList??[];d.length>0?d.forEach(t=>g({name:t.name??"",title:t.title??"",email:t.email??"",phone:t.phone??""})):g({name:"",title:"",email:"",phone:""})}s.current=!0}},[]),e.jsxs("div",{className:"flex flex-col gap-4",children:[p.map((d,t)=>{const a=`stilling.contactList.${t}`,n=c?.stilling?.contactList?.[t]??{};return e.jsxs(N.New,{background:"neutral-moderate",padding:"3",borderRadius:"large",className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"py-1 flex justify-between items-start",children:[e.jsxs(v,{className:"font-semibold",children:["Kontakt ",t+1]}),e.jsx(b,{size:"small",type:"button",variant:"tertiary",icon:e.jsx(T,{}),disabled:p.length===1,onClick:()=>i(t),title:"fjern",children:"Fjern"})]}),e.jsx(k,{label:"Navn",...l(`${a}.name`),error:n?.name?.message}),e.jsx(k,{label:"Tittel",...l(`${a}.title`),error:n?.title?.message}),e.jsx(v,{children:"Velg hvordan de kan nÃ¥s (minst en)"}),e.jsx(k,{label:"E-post",type:"email",...l(`${a}.email`,{onBlur:()=>{m(`${a}.email`)},onChange:()=>{r(`${a}.email`)}}),error:n?.email?.message}),e.jsx(k,{label:"Telefonnummer",type:"tel",inputMode:"tel",...l(`${a}.phone`,{onBlur:()=>{m(`${a}.phone`)},onChange:()=>{r(`${a}.phone`)}}),error:n?.phone?.message})]},d.id)}),e.jsx("div",{children:e.jsx(b,{type:"button",variant:"tertiary",icon:e.jsx(D,{}),size:"small",onClick:()=>g({name:"",title:"",email:"",phone:""}),children:"Legg til kontaktperson"})})]})}O.__docgenInfo={description:"",methods:[],displayName:"LeggTilKontaktperson"};const I=({lokasjoner:y,leggTilLokasjon:l,fjernLokasjonId:m})=>{const r=q(),[c,u]=f.useState(""),[p,g]=f.useState(!1),i=y,s=f.useMemo(()=>{if(c.length<=1||!r.data)return[];const t=c.toLowerCase(),a=(n,j)=>`${x(n)} (${j})`;return[...r.data.filter(n=>n.type===C.KOMMUNE&&n.navn.toLowerCase().includes(t)).map(n=>a(n.navn,"kommune")),...r.data.filter(n=>n.type===C.FYLKE&&n.navn.toLowerCase().includes(t)).map(n=>a(n.navn,"fylke")),...r.data.filter(n=>n.type===C.LAND&&n.navn.toLowerCase().includes(t)).map(n=>a(n.navn,"land"))]},[c,r.data]),d=(t,a)=>{const n=t.match(/\(([^)]+)\)$/),j=n?n[1]:"",$=t.replace(/\s*\([^)]*\)$/,"").trim(),o=r.data?.filter(h=>h.type.toLowerCase()===j.toLowerCase()).find(h=>h.navn.toLowerCase()===$.toLowerCase());if(a&&o)l({address:o.lokasjon.adresse,postalCode:null,city:o.lokasjon.poststed,county:o.lokasjon.fylke,municipal:o.lokasjon.kommune,municipalCode:o.lokasjon.kommunenummer,country:o.lokasjon.land});else{const h=i.find(L=>{const P=o?.lokasjon.kommune&&L.municipal===o.lokasjon.kommune,S=o?.lokasjon.fylke&&L.county===o.lokasjon.fylke,E=o?.lokasjon.land&&L.country===o.lokasjon.land;return j.toLowerCase()==="kommune"?P:j.toLowerCase()==="fylke"?S:j.toLowerCase()==="land"?E:!1});h?.id&&m(h.id)}};return e.jsx(K,{isListOpen:p,disabled:r.isLoading,toggleListButton:!1,selectedOptions:i.map(t=>t.municipal?`${x(t.municipal)} (kommune)`:t.county?`${x(t.county)} (fylke)`:t.country?`${x(t.country)} (land)`:""),onChange:t=>{g(t.length>0),u(t)},onToggleSelected:(t,a)=>d(t,a),label:"",description:"Du kan velge flere kommuner, fylker eller land",options:s,isMultiSelect:!0})};I.__docgenInfo={description:"",methods:[],displayName:"VelgKommuneFylkeEllerLand",props:{lokasjoner:{required:!0,tsType:{name:"Array",elements:[{name:"GeografiDTOmedId"}],raw:"GeografiDTOmedId[]"},description:""},leggTilLokasjon:{required:!0,tsType:{name:"signature",type:"function",raw:"(lokasjon: GeografiDTO) => void",signature:{arguments:[{type:{name:"z.infer",elements:[{name:"LocationSchema"}],raw:"z.infer<typeof LocationSchema>"},name:"lokasjon"}],return:{name:"void"}}},description:""},fjernLokasjonId:{required:!0,tsType:{name:"signature",type:"function",raw:"(id: string) => void",signature:{arguments:[{type:{name:"string"},name:"id"}],return:{name:"void"}}},description:""}}};const G=({control:y,lokasjonsFelt:l,index:m,fjern:r,oppdaterPoststed:c,postSted:u})=>{const[p,g]=f.useState(""),i=M(p);return f.useEffect(()=>{if(!i.isLoading){const s=i.data?.korrigertNavnBy;i.data&&s&&s!==u&&c(i.data)}},[i,u,c,m]),e.jsx(N.New,{background:"neutral-moderate",padding:"3",borderRadius:"large",children:e.jsxs("div",{children:[e.jsxs("div",{className:"py-3 flex justify-between",children:[e.jsxs(v,{children:["Adresse ",m+1]}),e.jsx("div",{children:e.jsx(b,{size:"small",type:"button",variant:"tertiary",icon:e.jsx(T,{}),onClick:()=>r(),title:"fjern",children:"Fjern"})})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx(w,{name:`${l}.${m}.address`,control:y,render:({field:s})=>e.jsx(k,{label:"Gateadresse",...s,value:s.value||""})}),e.jsxs("div",{className:"flex flex-row gap-4 justify-baseline",children:[e.jsx("div",{className:"w-32",children:e.jsx(w,{name:`${l}.${m}.postalCode`,control:y,render:({field:s})=>e.jsx(k,{label:"Postnummer",type:"text",inputMode:"numeric",maxLength:4,...s,value:s.value||"",onChange:d=>{g(d.target.value);const t=d.target.value.replace(/\D/g,"");t.length<=4&&s.onChange(t)}})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx(z,{weight:"semibold",children:"Poststed"}),e.jsx("div",{className:"mt-4",children:e.jsx(v,{children:u})})]})]})]})]})})};G.__docgenInfo={description:"",methods:[],displayName:"VelgPoststed",props:{control:{required:!0,tsType:{name:"Control",elements:[{name:"any"}],raw:"Control<any>"},description:""},lokasjonsFelt:{required:!0,tsType:{name:"string"},description:""},index:{required:!0,tsType:{name:"number"},description:""},fjern:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},oppdaterPoststed:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: PamPostdataDTO) => void",signature:{arguments:[{type:{name:"z.infer",elements:[{name:"PostdataSchema"}],raw:"z.infer<typeof PostdataSchema>"},name:"value"}],return:{name:"void"}}},description:""},postSted:{required:!0,tsType:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}]},description:""}}};export{O as L,G as V,I as a};
