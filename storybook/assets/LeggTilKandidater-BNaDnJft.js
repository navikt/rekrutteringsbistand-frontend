import{cn as B,j as e,S as O,B as M,co as I,cp as F,cq as b,r as v,d as j,cr as R,cs as U,H as V,U as z,A as W,au as G}from"./iframe-BKDoWgHq.js";import{B as p}from"./Box-CxHpQBhL.js";import{M as T}from"./Modal-DT3kgKxc.js";import{T as J}from"./TextField-m6z_Mm22.js";import{T as w}from"./Tag-BUt2pJu8.js";import{S as X}from"./CheckmarkCircle-B-9Qa1DJ.js";import{S as E}from"./PlusCircle-DWbUGSgO.js";const q=({fødselsnummer:n})=>{const l=B(n);return e.jsx(O,{hooks:[l],children:a=>e.jsx($,{...a})})},$=n=>{const l=Object.values(n).every(i=>i===!1),a=Object.values(n).every(i=>i===!0);let f=null;if(l||a)return e.jsx("div",{children:"Fant ingen forklaring på hvorfor jobbsøkeren er ikke synlig"});const u=Q(n);return u.utenforNoensKontroll.length?f=e.jsx(e.Fragment,{children:u.utenforNoensKontroll.map(i=>e.jsx("li",{children:C(i)},i))}):f=e.jsxs(e.Fragment,{children:[u.kandidat.length>0&&e.jsx(e.Fragment,{children:e.jsx("ul",{className:"mt-4 list-disc space-y-2 pl-6",children:u.kandidat.map(i=>e.jsx("li",{children:C(i)},i))})}),u.veileder.length>0&&e.jsx(e.Fragment,{children:e.jsx("ul",{className:"mt-4 list-disc space-y-2 pl-6",children:u.veileder.map(i=>e.jsx("li",{children:C(i)},i))})})]}),e.jsxs("div",{children:[e.jsx(M,{children:"Årsak"}),f]})},S={utenforNoensKontroll:Object.values(I),kandidat:Object.values(b),veileder:Object.values(F)},Q=n=>{const l=Object.entries(n).filter(([,a])=>a===!1).map(([a])=>a);return{utenforNoensKontroll:l.filter(a=>S.utenforNoensKontroll.includes(a)),kandidat:l.filter(a=>S.kandidat.includes(a)),veileder:l.filter(a=>S.veileder.includes(a))}},C=n=>{switch(n){case b.HarAktivCv:case b.HarJobbprofil:return"Personbruker mangler CV. Minimum innhold er ett yrkesønske og ett geografisk sted person ønsker å jobbe.";case b.HarSettHjemmel:return"Personbruker har ikke blitt informert om Navs behandlingsgrunnlag for deling av CV.";case b.MåIkkeBehandleTidligereCv:return"Personbruker har ikke valgt «Del CV». Dette kravet opptrer kun i overgangs-tilfeller hvor personbruker kommer under oppfølging av Nav med en CV som hen har fra en tidligere oppfølgingsperiode, eller med en CV som ble opprettet før hen kom under oppfølging av Nav.";case F.ErIkkeFritattKandidatsøk:return"Personbruker har personforholdet «Fritatt for kandidatsøk» i Arena.";case b.ErUnderOppfølging:case F.ErArbeidssøker:return"Personbruker må være i Navs Arbeidssøkerregister.";case I.ErIkkeDød:return"Er død."}};q.__docgenInfo={description:"",methods:[],displayName:"SynlighetsEvaluering",props:{fødselsnummer:{required:!0,tsType:{name:"string"},description:""}}};const A=({fødselsnummer:n})=>{const[l,a]=v.useState(!1);return e.jsx(p.New,{paddingInline:"space-16",paddingBlock:"space-12",children:l?e.jsx(q,{fødselsnummer:n}):e.jsxs("div",{children:[e.jsx(M,{className:"mb-2 font-bold",children:"Årsaken kan være en eller flere av disse:"}),e.jsxs("ol",{className:"list-decimal space-y-2 pl-6",children:[e.jsx("li",{children:"Personbruker mangler CV. Minimum innhold er ett yrkesønske og ett geografisk sted person ønsker å jobbe."}),e.jsx("li",{children:"Personbruker har ikke blitt informert om Navs behandlingsgrunnlag for deling av CV."}),e.jsx("li",{children:"Personbruker har ikke valgt «Del CV». Dette kravet opptrer kun i overgangs-tilfeller hvor personbruker kommer under oppfølging av Nav med en CV som hen har fra en tidligere oppfølgingsperiode, eller med en CV som ble opprettet før hen kom under oppfølging av Nav."}),e.jsx("li",{children:"Personbruker må være i Navs Arbeidssøkerregister."}),e.jsx("li",{children:"Personbruker har status «Egen ansatt»."}),e.jsx("li",{children:"Personbruker har adresseskjerming (kode 6 og 7 eller strengt fortrolig utland §19)."}),e.jsx("li",{children:"Personbruker er deltager i kommunalt kvalifiseringsprogram (KVP)"})]}),e.jsx(j,{className:"mt-4",onClick:()=>a(!0),variant:"secondary",children:"Se hvorfor kandidaten ikke er synlig (punkt 1-4)"})]})})};A.__docgenInfo={description:"",methods:[],displayName:"Synlighetsinfo",props:{fødselsnummer:{required:!0,tsType:{name:"string"},description:""}}};const L=({fødselsnummer:n})=>{const l=v.useRef(null);return e.jsxs("div",{children:[e.jsx(j,{variant:"tertiary",onClick:()=>l.current?.showModal(),type:"button",children:"Hvorfor er ikke kandidaten synlig?"}),e.jsxs(T,{ref:l,header:{heading:"Hvorfor er ikke kandidaten synlig?"},children:[e.jsx(T.Body,{children:e.jsx(A,{fødselsnummer:n})}),e.jsx(T.Footer,{children:e.jsx(j,{type:"button",onClick:()=>l.current?.close(),children:"Lukk"})})]})]})};L.__docgenInfo={description:"",methods:[],displayName:"SynlighetsModal",props:{fødselsnummer:{required:!0,tsType:{name:"string"},description:""}}};var P={},H;function Y(){return H||(H=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.idnr=n.getType=n.dnrAndTnr=n.dnrAndHnr=n.tnr=n.hnr=n.dnr=n.fnr=void 0;const l=new RegExp("^\\d{11}$"),a=r=>(0,n.idnr)(r);n.fnr=a;const f=r=>(0,n.idnr)(r);n.dnr=f;const u=r=>(0,n.idnr)(r);n.hnr=u;const i=r=>(0,n.idnr)(r);n.tnr=i;const m=r=>(0,n.idnr)(r);n.dnrAndHnr=m;const x=r=>(0,n.idnr)(r);n.dnrAndTnr=x;const h=r=>{let s=r.split("").map(Number);return s[0]>=4&&s[2]>=8?"dnr-and-tnr":s[0]>=4&&s[2]>=4?"dnr-and-hnr":s[0]>=4?"dnr":s[2]>=8?"tnr":s[2]>=4?"hnr":"fnr"};n.getType=h;const k=r=>{const s=(0,n.getType)(r);return K(r,s)};n.idnr=k;const K=(r,s)=>{if(!l.test(r))return{status:"invalid",reasons:["fnr, dnr or hnr must consist of 11 digits"]};const o=[...y(r),...d(r,s)];return o.length==0?{status:"valid",type:s}:{status:"invalid",reasons:o}},y=r=>{let s=r.split("").map(Number),o=11-(3*s[0]+7*s[1]+6*s[2]+1*s[3]+8*s[4]+9*s[5]+4*s[6]+5*s[7]+2*s[8])%11,g=11-(5*s[0]+4*s[1]+3*s[2]+2*s[3]+7*s[4]+6*s[5]+5*s[6]+4*s[7]+3*s[8]+2*o)%11;return o===11&&(o=0),g===11&&(g=0),o<10&&g<10&&o==s[9]&&g==s[10]?[]:["checksums don't match"]},d=(r,s)=>{s==="dnr"?r=Number(r.substring(0,1))-4+r.substring(1):s==="hnr"?r=r.substring(0,2)+(Number(r.substring(2,3))-4)+r.substring(3):s==="tnr"?r=r.substring(0,2)+(Number(r.substring(2,3))-8)+r.substring(3):s==="dnr-and-hnr"?r=Number(r.substring(0,1))-4+r.substring(1,2)+(Number(r.substring(2,3))-4)+r.substring(3):s==="dnr-and-tnr"&&(r=Number(r.substring(0,1))-4+r.substring(1,2)+(Number(r.substring(2,3))-8)+r.substring(3));const o=Number(r.substring(0,2)),g=Number(r.substring(2,4)),N=r.substring(4,6),t=N=="00"?2e3:Number(N),c=new Date(Date.UTC(t,g-1,o));return c&&c.getUTCMonth()+1==g&&c.getUTCDate()==o?[]:["invalid date"]}})(P)),P}var Z=Y();const ee=n=>Z.idnr(n).status==="valid",re=({callBack:n,synlighetSomModal:l,initielleKandidater:a,tilFormidling:f})=>{const[u,i]=v.useState(""),[m,x]=v.useState(a??[]),[h,k]=v.useState(null),[K,y]=v.useState(""),d=R(h),r=U(h);v.useEffect(()=>{n(m)},[m,n]);const s=t=>{y(t),t.length<11?(i(""),k(null)):t.length>11?(k(null),i("Fødselsnummeret er for langt")):ee(t)?(i(""),k(t)):(k(null),i("Fødselsnummeret er ikke gyldig"))},o=(t,c,D)=>{!m.some(_=>_.fødselsnummer===t)&&d.data&&(k(null),y(""),x([...m,{fødselsnummer:t,fornavn:c.fornavn,etternavn:c.etternavn,kilde:c.kilde,aktørId:D??null}]))},g=t=>e.jsx(p.New,{"data-testid":"velg-kandidat-resultat",className:"cursor-pointer",onClick:()=>{d.data&&o(t,d.data,r.data?.arenaKandidatnr??null)},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"p-4",children:[d.data?.fornavn," ",d.data?.etternavn," -"," ",t]}),e.jsx("div",{className:"mr-4",children:m.some(c=>c.fødselsnummer===t)?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{})," ",e.jsx("strong",{children:"Lagt til"})]}):e.jsx(j,{icon:e.jsx(E,{}),variant:"tertiary",children:"Legg til"})})]})}),N=t=>e.jsxs(p.New,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"p-4",children:[d.data?.fornavn," ",d.data?.etternavn," -"," ",t]}),e.jsxs("div",{className:"mr-4 flex gap-2",children:[e.jsx(w,{variant:"warning",size:"xsmall",className:"my-2",children:"Jobbsøkeren er ikke synlig"}),l&&e.jsx(L,{fødselsnummer:t})]})]}),!l&&e.jsx(A,{fødselsnummer:t})," ",e.jsx("hr",{}),e.jsx("div",{className:"flex justify-end ",children:e.jsx(j,{icon:e.jsx(E,{}),variant:"tertiary",onClick:()=>{d?.data&&o(t,d?.data,null)},children:"Legg til som usynlig jobbsøker (Registrer som fått jobben)"})})]});return e.jsxs("div",{children:[e.jsx(V,{size:"xsmall",className:"mb-2",children:"Søk etter fødselsnummer"}),e.jsxs(p.New,{borderRadius:"xlarge",borderWidth:"1",borderColor:"info-subtleA",background:"info-soft",children:[e.jsx(J,{type:"text",inputMode:"numeric",value:K,label:"Fødselsnummer på jobbsøker",hideLabel:!0,onChange:t=>{const c=t.target.value.replace(/[^0-9]/g,"");s(c)},error:u}),d.isLoading?e.jsx(p.New,{className:"flex h-full items-center justify-center p-4",children:e.jsx(z,{})}):d.data&&h?r.data?.arenaKandidatnr?g(h):N(h):null,d.error&&e.jsx(W,{variant:"error",className:"mt-4",children:e.jsx("p",{children:d.error?.statuskode===403?"Tilgangen ble avvist fordi brukeren har adressebeskyttelse":d.error?.statuskode===404?"Finner ikke person knyttet til fødselsnummer":"Det oppstod en feil ved søk på fødselsnummer"})})]}),m.length>0&&e.jsxs("div",{className:"mt-8",children:[e.jsx(V,{size:"medium",children:"Utvalgte jobbsøkere"}),m.map(t=>e.jsxs(p.New,{className:"flex flex-row items-center justify-between font-bold",background:"raised",borderColor:"neutral-subtleA",borderRadius:"xlarge",borderWidth:"1",paddingInline:"space-16",paddingBlock:"space-12",children:[e.jsxs("div",{children:[t.fornavn," ",t.etternavn," (",t.fødselsnummer,")"]}),e.jsxs("div",{children:[(!t.aktørId||f)&&e.jsx(w,{variant:"success",children:"Fått jobben"}),e.jsx(j,{icon:e.jsx(G,{}),variant:"tertiary",onClick:()=>x(m.filter(c=>c.fødselsnummer!==t.fødselsnummer)),children:"Fjern"})]})]},t.fødselsnummer))]})]})};re.__docgenInfo={description:"",methods:[],displayName:"LeggTilKandidater",props:{callBack:{required:!0,tsType:{name:"signature",type:"function",raw:"(valgteKandidater: ValgtKandidatProp[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"ValgtKandidatProp"}],raw:"ValgtKandidatProp[]"},name:"valgteKandidater"}],return:{name:"void"}}},description:""},initielleKandidater:{required:!1,tsType:{name:"Array",elements:[{name:"ValgtKandidatProp"}],raw:"ValgtKandidatProp[]"},description:""},synlighetSomModal:{required:!1,tsType:{name:"boolean"},description:""},lukkModal:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},tilFormidling:{required:!1,tsType:{name:"boolean"},description:""}}};export{re as L};
