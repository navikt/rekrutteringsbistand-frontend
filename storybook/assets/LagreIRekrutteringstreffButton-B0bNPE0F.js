import{ak as B,h5 as F,r as p,h6 as z,u as A,h7 as H,j as e,e as k,S as E,an as P,w as T}from"./iframe-BAewwkeG.js";import{u as _}from"./useRekrutteringstreffOversikt-jeT1u-9O.js";import{u as J}from"./KandidatSøkMarkerteContext-BlzCGMdR.js";import{S as V}from"./PersonPlus-CGZ4Qu7Q.js";import{M as j}from"./Modal-CIrWHa0R.js";import{T as s}from"./Table-B523qC8_.js";import{C as y}from"./Checkbox-BJbo7YQp.js";import{L as q}from"./Link-CPqVa9BH.js";const D=n=>`${F.internUrl}/${n}/jobbsoker`,C=(n,h)=>B(D(n),h),N=({rekrutteringstreffId:n,kandidatsokKandidater:h})=>{const u=p.useRef(null),[a,m]=p.useState(!1),[l,f]=p.useState([]),L=z(),{visVarsel:g}=A(),{markerteKandidater:o,fjernMarkerteKandidater:w}=J(),R=H(n),x=_(),S=()=>u.current?.showModal(),K=()=>{a||u.current?.close()},v=r=>f(t=>t.includes(r)?t.filter(d=>d!==r):[...t,r]),b=async r=>{if(!o||o.length===0||a)return;m(!0);let t=!1;const d=o.map(i=>{const c=h.find($=>$.arenaKandidatnr===i);return c?(c.fodselsnummer,{fødselsnummer:c.fodselsnummer,fornavn:c.fornavn??null,etternavn:c.etternavn??null,kandidatnummer:c.arenaKandidatnr??null}):null}).filter(i=>i&&i.fødselsnummer);try{if(n)await C(n,d),R.mutate?.();else if(r&&r.length>0)await Promise.all(r.map(i=>C(i,d))),x.mutate();else{g({type:"info",tekst:"Velg minst ett rekrutteringstreff"}),m(!1);return}g({type:"success",tekst:`${o.length} kandidat${o.length>1?"er":""} lagret i rekrutteringstreff`}),w(),t=!0,n&&L.push(`/rekrutteringstreff/${n}?visFane=jobbsøkere`)}catch(i){new T({message:"Feil ved lagring av kandidater i rekrutteringstreff",error:i}),g({type:"error",tekst:"Feil ved lagring av kandidater i rekrutteringstreff"})}finally{m(!1),t&&u.current?.close()}},M=()=>{n?b():S()};return e.jsxs(e.Fragment,{children:[e.jsx(k,{variant:"tertiary",onClick:M,icon:e.jsx(V,{"aria-hidden":!0}),disabled:o?.length===0||a,loading:a,children:n?"Legg til jobbsøkere og fullfør":"Lagre i rekrutteringstreff"}),e.jsxs(j,{width:600,ref:u,onClose:()=>{a&&u.current?.showModal()},header:{heading:`Lagre ${o?.length||0} kandidat i rekrutteringstreff`},children:[e.jsx(j.Body,{children:e.jsx(E,{hooks:[x],children:r=>a?e.jsx(P,{}):e.jsx(e.Fragment,{children:e.jsxs(s,{zebraStripes:!0,children:[e.jsx(s.Header,{children:e.jsxs(s.Row,{children:[e.jsx(s.DataCell,{children:e.jsx(y,{checked:l.length===r.length,indeterminate:l.length>0&&l.length!==r.length,onChange:()=>{l.length?f([]):f(r.map(t=>t.id))},hideLabel:!0,children:"Velg alle rader"})}),e.jsx(s.HeaderCell,{scope:"col",children:"Rekrutteringstreff"})]})}),e.jsx(s.Body,{children:r.map((t,d)=>e.jsxs(s.Row,{selected:l.includes(t.id),children:[e.jsx(s.DataCell,{className:"w-3",children:e.jsx(y,{hideLabel:!0,checked:l.includes(t.id),onChange:()=>v(t.id),"aria-labelledby":`id-${t.id}`,children:" "})}),e.jsx(s.HeaderCell,{scope:"row",children:e.jsx(q,{href:`rekrutteringstreff/${t.id}`,children:t.tittel??"Ukjent tittel"})})]},t.id+d))})]})})})}),e.jsxs(j.Footer,{children:[e.jsx(k,{disabled:a||l.length===0,type:"button",size:"small",loading:a,onClick:()=>void b(l),children:"Lagre"}),e.jsx(k,{disabled:a,type:"button",size:"small",variant:"secondary",onClick:K,children:"Avbryt"})]})]})]})};N.__docgenInfo={description:"",methods:[],displayName:"LagreIRekrutteringstreffButton",props:{rekrutteringstreffId:{required:!1,tsType:{name:"string"},description:""},kandidatsokKandidater:{required:!0,tsType:{name:"Array",elements:[{name:"z.infer",elements:[{name:"KandidatSøkKandidatSchema"}],raw:"z.infer<typeof KandidatSøkKandidatSchema>"}],raw:"KandidatsokKandidat[]"},description:""}}};export{N as L};
