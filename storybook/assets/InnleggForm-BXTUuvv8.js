import{h2 as T,hA as L,h4 as N,r as l,hB as D,j as e,L as V,B,aP as P,w as _}from"./iframe-Cj10hJN9.js";import{K as H}from"./KiAnalyse-CX0zkvSm.js";import{K as q}from"./KiAnalysePanel-CrJqmzd4.js";import{u as W}from"./useAutosave-Cg3QcycK.js";import{u as z}from"./useKiAnalyse-BcjV862a.js";import{u as M}from"./useKiLogg-SassXevV.js";import{R as O}from"./RikTekstEditor-BKer5DJH.js";import{S as U}from"./Skeleton-BCCFx8Jk.js";const g="rediger-innlegg-htmlcontent-form",m=({onUpdated:d})=>{const{rekrutteringstreffId:a}=T(),{data:c,isLoading:o}=L(a),n=c?.[0],u=n?n.htmlContent??null:void 0,{control:i,setValue:r,getValues:h,trigger:f,formState:{isDirty:p}}=N(),{save:v}=W(),{setLagret:y}=M(a,"innlegg"),[k,x]=l.useState(Date.now()),C=D({control:i,name:"htmlContent"});l.useEffect(()=>{const t=n?.htmlContent??"";r("htmlContent",t,{shouldDirty:!1,shouldTouch:!1,shouldValidate:!1}),x(Date.now())},[r,n?.htmlContent]);const j=async t=>{try{await v(["htmlContent"],t)}catch(s){new _({message:"Lagring av innlegg feilet.",error:s})}finally{d?.()}},{analyse:F,analyseError:b,validating:K,kiErrorBorder:E,forceSave:S,showAnalysis:I,erRedigeringAvPublisertTreff:w,runValidationAndMaybeSave:A,onForceSave:R}=z({feltType:"innlegg",fieldName:"htmlContent",watchedValue:C,triggerRHF:f,getValues:h,setValue:r,setKiFeilFieldName:"innleggKiFeil",saveCallback:j,setKiLagret:y,requireHasCheckedToShow:!0,setKiSjekketFieldName:"innleggKiSjekket",savedValue:u});return e.jsxs("section",{className:"space-y-3",children:[o&&e.jsx(U,{variant:"text"}),!o&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{htmlFor:g,children:n?"Endre innlegg":"Skriv nytt innlegg"}),e.jsx(B,{size:"small",textColor:"subtle",children:"Fortell jobbsøkeren om treffet: de unike fordelene, mulighetene, og oppgavene som de vil møte. For eksempel arbeidsgivere, forventninger, læring- og karrieremuligheter."})]}),e.jsx("div",{className:`border rounded-lg ${E?"border-red-500":"border-gray-300"}`,onBlur:t=>{const s=t.currentTarget;setTimeout(async()=>{s.contains(document.activeElement)||p&&await A()},0)},children:e.jsx(P,{name:"htmlContent",control:i,render:({field:t})=>e.jsx(O,{id:g,tekst:t.value??"",onChange:t.onChange},k)})}),e.jsx(H,{}),e.jsx(q,{validating:K,analyse:F,analyseError:b,forceSave:S,showAnalysis:I,erRedigeringAvPublisertTreff:w,onForceSave:R,ariaLabel:"Analyse av innlegg"})]})]})};m.displayName="InnleggForm";m.__docgenInfo={description:"",methods:[],displayName:"InnleggForm",props:{onUpdated:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{m as I};
