import{j as e,H as z,B as A,r as m,e as h,a9 as R,bh as O,A as L,b5 as P,b6 as B,bj as H,bl as w,h as N,S as I,bk as M}from"./iframe-CnEkfJjQ.js";import{c as _}from"./stilling-util-BjBixF7p.js";import{B as E}from"./Box-V6v2cQsd.js";import{T as V}from"./Tag-DmHnnT3j.js";import{M as q}from"./Modal-aZ-miv_B.js";import{S as D}from"./Trash-DLfbYG6b.js";import{C as W}from"./ComboboxProvider-DFzDbA45.js";import{H as $}from"./VStack-D3_cDo5O.js";const S=({navn:o,adresse:s,status:t,organisasjonsnummer:l,actionSlot:u})=>{const d=[s?.adresse,[s?.postnummer,s?.poststed].filter(Boolean).join(" "),s?.kommune].filter(g=>g&&String(g).trim().length>0).join(", ");return e.jsxs(E.New,{background:"neutral-softA",borderRadius:"xlarge",padding:"4",marginBlock:"2",className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(z,{level:"3",size:"xsmall",children:_(o||"")}),e.jsxs(A,{size:"small",className:"mt-1",children:[l&&e.jsxs(e.Fragment,{children:["Org.nr. ",l,d?"  ":""]}),d]})]}),e.jsxs("div",{className:"ml-2 self-start flex items-center gap-2",children:[t&&e.jsx(V,{size:"medium",variant:"info",children:t}),u]})]})};S.__docgenInfo={description:"",methods:[],displayName:"ArbeidsgiverKort",props:{organisasjonsnummer:{required:!1,tsType:{name:"string"},description:""},navn:{required:!1,tsType:{name:"string"},description:""},organisasjonsform:{required:!1,tsType:{name:"string"},description:""},antallAnsatte:{required:!1,tsType:{name:"number"},description:""},adresse:{required:!1,tsType:{name:"union",raw:"ArbeidsgiverAdresse | null",elements:[{name:"signature",type:"object",raw:`{
  adresse?: string;
  postnummer?: string;
  poststed?: string;
  kommune?: string;
  kommunenummer?: string;
  land?: string;
  landkode?: string;
}`,signature:{properties:[{key:"adresse",value:{name:"string",required:!1}},{key:"postnummer",value:{name:"string",required:!1}},{key:"poststed",value:{name:"string",required:!1}},{key:"kommune",value:{name:"string",required:!1}},{key:"kommunenummer",value:{name:"string",required:!1}},{key:"land",value:{name:"string",required:!1}},{key:"landkode",value:{name:"string",required:!1}}]}},{name:"null"}]},description:""},status:{required:!1,tsType:{name:"string"},description:""},naringskoder:{required:!1,tsType:{name:"union",raw:"naringskode[] | null",elements:[{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  kode?: string;
  beskrivelse?: string;
}`,signature:{properties:[{key:"kode",value:{name:"string",required:!1}},{key:"beskrivelse",value:{name:"string",required:!1}}]}}],raw:"naringskode[]"},{name:"null"}]},description:""},actionSlot:{required:!1,tsType:{name:"ReactNode"},description:""}}};const C=({navn:o,loading:s,disabled:t,onConfirm:l,onCancel:u,onAfterClose:d,onOpen:g,arbeidsgivereHook:b,variant:y="trash",triggerLabel:a,triggerAriaLabel:p,renderTrigger:i})=>{const c=m.useRef(null),v=()=>{c.current?.close(),d?.()},f=()=>{t||s||(g?.(),c.current?.showModal())},k=async()=>{await Promise.resolve(l()),b.mutate(),v()},T=()=>{s||(u?.(),v())},x=y==="cross"?e.jsx(R,{"aria-hidden":!0}):e.jsx(D,{"aria-hidden":!0}),r=!!s||!!t,n=y==="cross"?e.jsx(h,{size:"xsmall",variant:"tertiary",icon:x,onClick:f,"aria-label":p||a||"Fjern arbeidsgiver fra treffet",disabled:r}):e.jsx(h,{size:"small",variant:"tertiary",icon:x,onClick:f,disabled:r,children:a||"Slett"});return e.jsxs(e.Fragment,{children:[i?i({button:n,open:f,disabled:r}):n,e.jsxs(q,{ref:c,header:{heading:"Slett arbeidsgiver"},children:[e.jsx(q.Body,{children:o&&e.jsxs(A,{children:["Er du sikker på at du vil slette ",o," fra dette rekrutteringstreffet?"]})}),e.jsxs(q.Footer,{children:[e.jsx(h,{variant:"danger",onClick:k,loading:!!s,disabled:!!s,children:"Slett"}),e.jsx(h,{variant:"secondary",onClick:T,disabled:!!s,children:"Avbryt"})]})]})]})};C.__docgenInfo={description:"",methods:[],displayName:"SlettArbeidsgiverModal",props:{navn:{required:!1,tsType:{name:"string"},description:""},loading:{required:!1,tsType:{name:"boolean"},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:""},onConfirm:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void | Promise<void>",signature:{arguments:[],return:{name:"union",raw:"void | Promise<void>",elements:[{name:"void"},{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}]}}},description:""},onCancel:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onAfterClose:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onOpen:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},arbeidsgivereHook:{required:!0,tsType:{name:"Pick",elements:[{name:"SWRResponse",elements:[{name:"z.infer",elements:[{name:"ArbeidsgivereSchema"}],raw:"z.infer<typeof ArbeidsgivereSchema>"}],raw:"SWRResponse<ArbeidsgivereDTO>"},{name:"literal",value:"'mutate'"}],raw:"Pick<SWRResponse<ArbeidsgivereDTO>, 'mutate'>"},description:""},variant:{required:!1,tsType:{name:"union",raw:"'trash' | 'cross'",elements:[{name:"literal",value:"'trash'"},{name:"literal",value:"'cross'"}]},description:"",defaultValue:{value:"'trash'",computed:!1}},triggerLabel:{required:!1,tsType:{name:"string"},description:""},triggerAriaLabel:{required:!1,tsType:{name:"string"},description:""},renderTrigger:{required:!1,tsType:{name:"signature",type:"function",raw:`(args: {
  button: ReactNode;
  open: () => void;
  disabled: boolean;
}) => ReactNode`,signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  button: ReactNode;
  open: () => void;
  disabled: boolean;
}`,signature:{properties:[{key:"button",value:{name:"ReactNode",required:!0}},{key:"open",value:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}},required:!0}},{key:"disabled",value:{name:"boolean",required:!0}}]}},name:"args"}],return:{name:"ReactNode"}}},description:""}}};const F=({arbeidsgiverCallback:o,valgtArbeidsgiver:s,labelText:t,placeholder:l})=>{const[u,d]=m.useState(""),{isLoading:g,error:b,data:y}=O(u),[a,p]=m.useState(s??null);return m.useEffect(()=>{a&&o(a)},[a,o]),e.jsxs(m.Fragment,{children:[e.jsx("div",{role:"search",children:e.jsx(W,{isLoading:g,label:t??"Arbeidsgivers navn eller organisasjonsnummer",options:y?.map(i=>`${i.navn} - ${i.organisasjonsnummer}`)??[],shouldAutocomplete:!0,toggleListButton:!1,onChange:i=>d(i),onToggleSelected:i=>{const c=i.split(" - ").at(-1),v=y?.find(f=>f.organisasjonsnummer===c);v&&p(v)},placeholder:l})}),b&&e.jsx(L,{className:"mt-8",variant:"error",children:JSON.stringify(b)})]})};F.__docgenInfo={description:"",methods:[],displayName:"VelgArbeidsgiver",props:{children:{required:!1,tsType:{name:"union",raw:"ReactNode | undefined",elements:[{name:"ReactNode"},{name:"undefined"}]},description:""},arbeidsgiverCallback:{required:!0,tsType:{name:"signature",type:"function",raw:"(arbeidsgiver: ArbeidsgiverDTO) => void",signature:{arguments:[{type:{name:"z.infer",elements:[{name:"ArbeidsgiverSchema"}],raw:"z.infer<typeof ArbeidsgiverSchema>"},name:"arbeidsgiver"}],return:{name:"void"}}},description:""},valgtArbeidsgiver:{required:!1,tsType:{name:"union",raw:"ArbeidsgiverDTO | null",elements:[{name:"z.infer",elements:[{name:"ArbeidsgiverSchema"}],raw:"z.infer<typeof ArbeidsgiverSchema>"},{name:"null"}]},description:""},labelText:{required:!1,tsType:{name:"string"},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""}}};const K=({variant:o="inline",onCompleted:s})=>{const{rekrutteringstreffId:t}=P(),l=B(t),u=H(t),{data:d}=l,[g,b]=m.useState(!1),y=async r=>{if(r)try{b(!0),await M(t,r.arbeidsgiverTreffId??r.organisasjonsnummer),u.mutate()}finally{b(!1)}},[a,p]=m.useState(null),[i,c]=m.useState([]),[v,f]=m.useState(!1),k=m.useMemo(()=>new Set((d??[]).map(r=>r.organisasjonsnummer)),[d]),T=r=>{c(n=>n.filter(j=>j.organisasjonsnummer!==r))};m.useEffect(()=>{!d||!a||(async()=>{try{if(k.has(a.organisasjonsnummer)){p(null);return}if(o==="modal"){c(r=>r.some(j=>j.organisasjonsnummer===a.organisasjonsnummer)?r:[...r,a]),p(null);return}await w(t,{organisasjonsnummer:a.organisasjonsnummer,navn:a.navn}),l.mutate(),u.mutate()}catch(r){throw new N({message:"Feiler når prøver å legge til arbeidsgiver.",error:r})}finally{p(null)}})()},[a,o,k,t,l,u,d]);const x=async()=>{if(i.length!==0){f(!0);try{for(const r of i)await w(t,{organisasjonsnummer:r.organisasjonsnummer,navn:r.navn});l.mutate(),u.mutate(),c([]),s?.()}catch(r){throw new N({message:"Feiler når prøver å legge til arbeidsgiver(e).",error:r})}finally{f(!1)}}};return e.jsx(I,{hooks:[l],children:r=>e.jsxs("div",{className:o==="modal"?"space-y-3":"space-y-4",children:[e.jsx("div",{children:e.jsx(F,{arbeidsgiverCallback:p,valgtArbeidsgiver:a,labelText:"Finn arbeidsgiver",placeholder:"Søk på navn, organisasjonsnummer"})}),o==="modal"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[i.map(n=>e.jsxs("div",{className:"relative",children:[e.jsx(S,{navn:n.navn,organisasjonsnummer:n.organisasjonsnummer,adresse:n.adresse??void 0}),e.jsx("div",{className:"absolute right-2 top-2",children:e.jsx(h,{size:"xsmall",variant:"tertiary",onClick:()=>T(n.organisasjonsnummer),"aria-label":`Fjern ${n.navn}`,children:e.jsx(R,{"aria-hidden":!0})})})]},n.organisasjonsnummer)),i.length===0&&e.jsx(A,{size:"small",children:"Ingen arbeidsgivere valgt ennå"})]}),e.jsx($,{gap:"2",justify:"end",children:e.jsx(h,{type:"button",onClick:x,disabled:i.length===0||v,loading:v,children:"Legg til"})})]}),o==="inline"&&e.jsx(e.Fragment,{children:Array.isArray(r)&&r.length>0?e.jsx("ul",{children:r.map((n,j)=>e.jsx("li",{children:e.jsxs("div",{className:"relative",children:[e.jsx(S,{navn:n.navn,organisasjonsnummer:n.organisasjonsnummer,adresse:{adresse:"TODO: adresse må lagres i backend for å kunne hentes her"}}),e.jsx("div",{className:"absolute right-2 top-2",children:e.jsx(C,{navn:n.navn,loading:g,disabled:g,onConfirm:()=>y(n),arbeidsgivereHook:l,variant:"cross",triggerAriaLabel:`Fjern ${n.navn}`})})]})},j))}):e.jsx(A,{children:"Ingen arbeidsgivere lagt til"})})]})})};K.__docgenInfo={description:"",methods:[],displayName:"LeggTilArbeidsgiverForm",props:{variant:{required:!1,tsType:{name:"union",raw:"'inline' | 'modal'",elements:[{name:"literal",value:"'inline'"},{name:"literal",value:"'modal'"}]},description:"",defaultValue:{value:"'inline'",computed:!1}},onCompleted:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{S as A,K as L,C as S,F as V};
