import{j as e,K as A,g as U,o as b,I as s,a as k,J as C,d as B,c as L,u as M,r as j,L as D,b as f,R as _}from"./iframe-BZGI7Ig_.js";import{u as q}from"./useStilling-DdqFY49I.js";import{S as w}from"./SWRLaster-BBaxFb3n.js";import{L as z}from"./Link-D091lGCu.js";import{l as E}from"./leggTilKandidat-Bu4CtkJT.js";import{u as O}from"./index-DAgULPJc.js";import{u as v}from"./KandidatSøkMarkerteContext-VsixJdFG.js";import{U as T}from"./umamiEvents-BDpRy9-M.js";import{M as S}from"./Modal-0KuFj30Z.js";import{T as n}from"./Table-DCRO-Ii7.js";import{C as I}from"./Checkbox-CVyHKrRn.js";import{P as V}from"./Pagination-CmfYO-96.js";import{u as W}from"./useKandidatlisteForEier-BfEUlWu_.js";import{a as J}from"./StillingsContext-0iH-_-OF.js";import{S as $}from"./PersonPlus-CWpR0jVQ.js";const F=({stillingsId:t})=>{const g=q(t);return e.jsx(w,{hooks:[g],children:o=>e.jsx(z,{href:`stilling/${t}`,children:o.stilling.title??"Ukjent tittel"})})};F.__docgenInfo={description:"",methods:[],displayName:"KandidatlisteTittel",props:{stillingsId:{required:!0,tsType:{name:"string"},description:""}}};const G=t=>`${A.internUrl}/veileder/kandidatlister?pagesize=8${t&&t>1?`&pagenumber=${t}`:""}`,Q=b({kandidatlisteId:s(),tittel:s().nullable(),organisasjonReferanse:s().nullable(),organisasjonNavn:s().nullable(),stillingId:s(),opprettetAv:b({ident:s(),navn:s()}),opprettetTidspunkt:s(),antallKandidater:k(),kanEditere:C(),erEier:C(),kanSlette:s(),antallUsynligeKandidater:k(),status:s(),antallStillinger:k(),stillingskategori:s()}),X=b({liste:B(Q),antall:k()}),Y=t=>O(G(t),U(X)),P=({onClose:t})=>{const{track:g}=L(),{visVarsel:o}=M(),{markerteKandidater:r,fjernMarkerteKandidater:x}=v(),[h,p]=j.useState(1),d=Y(h>1?h-1:0),[l,u]=j.useState([]),[m,R]=j.useState(!1),H=i=>u(c=>c.includes(i)?c.filter(a=>a!==i):[...c,i]);return e.jsxs(S,{onClose:t,open:!0,width:800,header:{heading:`Lagre ${r?.length||0} kandidat i kandidatlister`},children:[e.jsx(S.Body,{children:e.jsx(w,{hooks:[d],children:i=>{const c=Math.floor(i.antall/8);return m?e.jsx(D,{}):e.jsxs(e.Fragment,{children:[e.jsxs(n,{zebraStripes:!0,children:[e.jsx(n.Header,{children:e.jsxs(n.Row,{children:[e.jsx(n.DataCell,{children:e.jsx(I,{checked:l.length===i.liste.length,indeterminate:l.length>0&&l.length!==i.liste.length,onChange:()=>{l.length?u([]):u(i.liste.map(a=>a.stillingId))},hideLabel:!0,children:"Velg alle rader"})}),e.jsx(n.HeaderCell,{scope:"col",children:"Stilling"}),e.jsx(n.HeaderCell,{scope:"col",children:"Organisasjon"}),e.jsx(n.HeaderCell,{scope:"col",children:"Antall stillinger"})]})}),e.jsx(n.Body,{children:i.liste?.map((a,y)=>e.jsxs(n.Row,{selected:l.includes(a.stillingId),children:[e.jsx(n.DataCell,{children:e.jsx(I,{hideLabel:!0,checked:l.includes(a.stillingId),onChange:()=>H(a.stillingId),"aria-labelledby":`id-${a.stillingId}`,children:" "})}),e.jsx(n.HeaderCell,{scope:"row",children:e.jsx(F,{stillingsId:a.stillingId})}),e.jsx(n.DataCell,{children:a.organisasjonNavn}),e.jsx(n.DataCell,{children:a.antallStillinger})]},a.stillingId+y))})]}),e.jsx(V,{className:"my-8 flex justify-center",size:"small",page:h,onPageChange:p,count:c>0?c:1})]})}})}),e.jsxs(S.Footer,{children:[e.jsx(f,{disabled:m||l.length===0,type:"button",onClick:()=>{N(l,t,R)},children:"Lagre"}),e.jsx(f,{disabled:m,type:"button",variant:"secondary",onClick:t,children:"Avbryt"})]})]});async function N(i,c,a){if(!(!r||r.length===0)){if(a(!0),i.length!==0){g(T.Stilling.legg_til_markerte_kandidater,{antallKandidater:r?.length,kilde:"Kandidatsøk",antallStillinger:i.length});const y=i.map(K=>E(r,K));try{await Promise.all(y),o({type:"success",tekst:`${r.length}  kandidat${r.length>1?"er":""} lagret i rekrutteringstreff`}),x(),c()}catch(K){new _({message:"Feil ved lagring av kandidater i kandidatliste",error:K}),o({type:"error",tekst:"Feil ved lagring av kandidater i kandidatliste"})}}a(!1)}}};P.__docgenInfo={description:"",methods:[],displayName:"LagreIKandidatlisteModal",props:{onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};const Z=({stillingsId:t})=>{const{track:g}=L(),{erEier:o,stillingsData:r,refetchKandidatliste:x}=J(),h=W(r,o),{visVarsel:p}=M(),{markerteKandidater:d,fjernMarkerteKandidater:l}=v();async function u(){if(!(!d||d.length===0)&&t){g(T.Stilling.legg_til_markerte_kandidater,{antallKandidater:d?.length,kilde:"Finn kandidater"});try{await E(d,t),p({type:"success",tekst:`${d.length}  kandidat${d.length>1?"er":""} lagret i kandiatliste`}),l()}catch(m){new _({message:"Feil ved lagring av kandidater i kandidatliste",error:m}),p({type:"error",tekst:"Feil ved lagring av kandidater i kandidatliste"})}}}return e.jsx(f,{variant:"tertiary",onClick:()=>{u(),setTimeout(()=>{h.mutate(),x?.()},1e3)},icon:e.jsx($,{"aria-hidden":!0}),disabled:d?.length===0,children:"Legg til markerte kandidater"})},ee=({stillingsId:t})=>{const{markerteKandidater:g}=v(),[o,r]=j.useState(!1);return t?e.jsx(Z,{stillingsId:t}):e.jsxs("div",{className:"flex",children:[e.jsx(f,{variant:"tertiary",onClick:()=>r(!0),icon:e.jsx($,{"aria-hidden":!0}),disabled:g?.length===0,children:"Lagre i kandidatliste"}),o&&e.jsx(P,{onClose:()=>r(!1)})]})};ee.__docgenInfo={description:"",methods:[],displayName:"LagreIKandidatlisteButton",props:{stillingsId:{required:!1,tsType:{name:"string"},description:""}}};export{F as K,ee as L};
