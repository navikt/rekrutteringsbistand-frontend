import{h4 as y,hE as S,r as F,j as e,H as O,aP as E,B as K,hb as U,e as _,Y as G,a0 as I}from"./iframe-BAewwkeG.js";import{b as R}from"./useAutosave-JnKwMHHX.js";import{u as z}from"./usePamPostdata-BKp9bsKc.js";import{T as j}from"./TextField-CL11TOnU.js";import{T as H,S as X}from"./TidspunktForm-BNturKoL.js";import{B as x}from"./Box-DX0hZx-U.js";import{K as q}from"./KiAnalyseIntro-BttMKgsS.js";import{K as W}from"./KiAnalysePanel-CBUQpIK2.js";import{u as Y}from"./useFormFeltMedKiValidering-BB_EQyXw.js";import{M as b}from"./mutations-BrPiw95f.js";import{S as $}from"./Skeleton-Bz0-tB7y.js";const t={GATEADRESSE:"gateadresse",POSTNUMMER:"postnummer",POSTSTED:"poststed"},M=({control:a})=>{const{setValue:o,clearErrors:d,setError:f,trigger:h}=y(),{validerOgLagreRekrutteringstreff:u}=R(),n=S({control:a,name:t.POSTNUMMER}),{data:m,isLoading:c}=z(n||"");return F.useEffect(()=>{!n||n.length!==4||c||(m?.korrigertNavnBy?(o(t.POSTSTED,m.korrigertNavnBy,{shouldDirty:!0,shouldValidate:!0}),d(t.POSTSTED)):(o(t.POSTSTED,"",{shouldDirty:!0,shouldValidate:!0}),f(t.POSTSTED,{type:"manual",message:"Ukjent poststed"})))},[n,c,m,o,f,d]),e.jsxs("div",{className:"space-y-4",children:[e.jsx(O,{level:"3",size:"small",children:"Sted"}),e.jsx(E,{name:t.GATEADRESSE,control:a,render:({field:s,fieldState:l})=>e.jsx(j,{...s,value:s.value??"",label:"Gateadresse",error:l.error?.message,onBlur:()=>{s.onBlur(),u([t.GATEADRESSE])}})}),e.jsxs("div",{className:"flex gap-4 items-start",children:[e.jsx(E,{name:t.POSTNUMMER,control:a,render:({field:s,fieldState:l})=>e.jsx(j,{...s,value:s.value??"",label:"Postnummer",htmlSize:12,error:l.error?.message,onChange:p=>{const g=p.target.value.replace(/\D/g,"");d([t.POSTNUMMER,t.POSTSTED]),o(t.POSTSTED,"",{shouldDirty:!1,shouldValidate:!0}),g.length<=4&&s.onChange(g),g.length===4&&h([t.POSTNUMMER])},onBlur:()=>{s.onBlur(),u([t.POSTNUMMER,t.POSTSTED])}})}),e.jsx(K,{className:`pt-8 ${S({control:a,name:t.POSTSTED})?"":"aksel-error-message"}`,children:S({control:a,name:t.POSTSTED})||(n&&n.length===4&&!c?"Ukjent poststed":"")})]})]})};M.__docgenInfo={description:"",methods:[],displayName:"StedForm"};const J=()=>{const{control:a}=y();return e.jsxs("div",{className:"space-y-8",children:[e.jsx(O,{level:"2",size:"medium",children:"Praktiske forhold"}),e.jsx(x.New,{background:"neutral-moderate",borderRadius:"xlarge",padding:"3",children:e.jsx(H,{control:a})}),e.jsx(x.New,{background:"neutral-moderate",borderRadius:"xlarge",padding:"3",children:e.jsx(X,{control:a})}),e.jsx(x.New,{background:"neutral-moderate",borderRadius:"xlarge",padding:"3",children:e.jsx(M,{control:a})})]})};J.__docgenInfo={description:"",methods:[],displayName:"PraktiskeForhold"};const Q="Treff uten navn",B=({onUpdated:a})=>{const{treff:o}=U(),d=o?o.tittel??null:void 0,{clearErrors:f,formState:{isSubmitting:h}}=y(),u=F.useRef(null),{validerOgLagreRekrutteringstreff:n}=R(),{analyse:m,analyseError:c,validating:s,kiErrorBorder:l,harGodkjentKiFeil:p,showAnalysis:g,erRedigeringAvPublisertTreff:A,validerMedKiOgLagreVedGodkjenning:k,onGodkjennKiFeil:L,watchedValue:T,control:w,setValue:N,kiLoggLoading:P}=Y({feltType:"tittel",fieldName:"tittel",savedValue:d,saveCallback:n,onUpdated:a}),C=b-(typeof T=="string"?T.length:0),V=()=>{N("tittel","",{shouldValidate:!0,shouldDirty:!0,shouldTouch:!0}),u.current?.focus()};return e.jsxs("section",{className:"space-y-3",children:[P&&e.jsx($,{variant:"text"}),!P&&e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Navn på treffet"}),e.jsxs("div",{className:"relative w-full",children:[T&&e.jsx(_,{type:"button",onClick:V,"aria-label":"Tøm tittel feltet",variant:"tertiary",size:"small",className:"absolute right-2 top-[2rem] -translate-y-1/2 h-8 p-1",title:"Tøm feltet",children:e.jsx(G,{"aria-hidden":!0,fontSize:"1.25rem"})}),e.jsx("div",{className:"flex items-start",children:e.jsx(E,{control:w,name:"tittel",render:({field:i,fieldState:D})=>e.jsx(j,{...i,value:i.value??"",ref:r=>{i.ref(r),u.current=r},label:"Navn på treffet",hideLabel:!0,maxLength:b,className:"w-full pt-2",error:D.error?.message||(l?"Brudd på retningslinjer":void 0),"aria-invalid":!!(D.error||l),autoComplete:"off",autoCorrect:"off",spellCheck:!1,onChange:r=>{i.onChange(r),r.target.value.trim().length>0&&f("tittel")},onBlur:async()=>{i.onBlur(),setTimeout(async()=>{!s&&!h&&await k()},0)},onFocus:()=>{const r=i.value;if(!r||typeof r!="string")return;r.trim()===Q&&N("tittel","",{shouldValidate:!1,shouldDirty:!1,shouldTouch:!1})},onKeyDown:r=>{r.key==="Enter"&&!r.shiftKey&&(r.preventDefault(),(async()=>{const v=r.currentTarget;await k(),v?.blur()})())}})})})]}),e.jsxs(I,{className:"text-gray-400",children:[C," tegn igjen"]}),e.jsx(W,{validating:s,analyse:m,analyseError:c,harGodkjentKiFeil:p,showAnalysis:g,erRedigeringAvPublisertTreff:A,onGodkjennKiFeil:L,ariaLabel:"Analyse av tittel"})]})]})};B.displayName="TittelForm";B.__docgenInfo={description:"",methods:[],displayName:"TittelForm",props:{onUpdated:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{J as P,M as S,B as T};
