import{f as X,r,j as e,B as Y,e as w}from"./iframe-Dbv-ZY6m.js";import{f as L}from"./FilterChip-umNNk90F.js";import{T as A}from"./TømFiltre-xXB9Ml04.js";import{a as Z}from"./util-zb_msfsb.js";import"./SideScroll-bkWuyuVO.js";import{U as x}from"./umamiEvents-D8PysN3T.js";import{C as E}from"./Chips-DU8zoVua.js";import{S as N}from"./ChevronDown-BT8bNVDr.js";const P=({tømFiltreProps:d,filtre:U=[]})=>{const o=X(),[l,b]=r.useState(!1),[u,C]=r.useState(0),[c,D]=r.useState(null),[g,B]=r.useState(0),[W,I]=r.useState(0),R=r.useRef(null),f=r.useRef(null),V=r.useRef(null),M=r.useRef(null),n=U.flatMap((t,a)=>(t.type||[]).map((i,S)=>{const v=t.mapVerdiNavn?L(t.mapVerdiNavn(i)):L(Z(i));return{key:`${a}-${i}-${S}`,label:v,remove:()=>t.setVerdi((t.type||[]).filter(k=>k!==i))}})),$=Math.max(0,n.length-u),F=$>0;if(r.useEffect(()=>{l?o.track(x.Generell.åpne_filter_chip_panel):o.track(x.Generell.lukk_filter_chip_panel)},[l,o]),r.useLayoutEffect(()=>{if(!R.current||!f.current)return;const t=R.current.offsetWidth;if(!t)return;const a=f.current,i=Array.from(a.querySelectorAll("button[data-chip-measure]")),S=a.querySelector("button[data-clear-all]"),v=a.querySelector("div[data-control-wrapper]"),k=v?.querySelector("span[data-count-text]"),z=getComputedStyle(a),T=parseFloat(z.columnGap||z.gap||"0")||0,p=S?.offsetWidth||0,Q=i.map(s=>s.offsetWidth),h=[];if(Q.reduce((s,m,q)=>{const _=s+m+(q>0||p>0?T:0);return h.push(_),_},p),(h[h.length-1]||p)<=t){u!==n.length&&C(n.length),g!==0&&B(0);return}let j=0,y=0;for(let s=n.length;s>=0;s--){const m=n.length-s;if(m===0){if((s===0?p:h[s-1])<=t){j=s,y=0;break}continue}k&&(k.textContent=`+ ${m} filter${m!==1?"e":""}`);const G=(v?.offsetWidth||0)+16+8,H=s===0?p:h[s-1];if(H+(H>0?T:0)+G<=t){j=s,y=G;break}}j!==u&&C(j),y!==g&&B(y)},[n,d,u,g]),r.useLayoutEffect(()=>{const t=V.current;if(t&&!c&&D(t.getBoundingClientRect().height),W===0&&f.current){const a=f.current.querySelector("button[data-collapse-measure]");if(a){const i=a.offsetWidth+8;I(i)}}},[c,W]),r.useEffect(()=>{let t;const a=()=>{clearTimeout(t),t=setTimeout(()=>C(0),150)};return window.addEventListener("resize",a),()=>{clearTimeout(t),window.removeEventListener("resize",a)}},[]),n.length===0)return null;const J=l?n:n.slice(0,u),K=l?c?`${c*8}px`:"600px":c?`${c}px`:"40px",O=l?(W||40)+16:0;return e.jsx("div",{ref:R,className:"w-full",children:e.jsxs("div",{className:"flex justify-between relative",children:[e.jsxs(E,{ref:V,size:"small",className:"flex items-center gap-2 flex-wrap flex-1 min-w-0 transition-all duration-300 ease-in-out ",style:{maxHeight:K,paddingRight:O},"aria-expanded":l,children:[d&&e.jsx("div",{className:"flex-shrink-0",children:e.jsx(A,{...d,"data-clear-all":"true",className:"flex-shrink-0"})}),J.map(t=>e.jsx(E.Removable,{onClick:t.remove,style:{whiteSpace:"nowrap",flexShrink:0},className:"flex-shrink-0",children:t.label},t.key)),!l&&e.jsx(Y,{onClick:()=>{b(!0),o.track(x.Generell.åpne_filter_chip_panel_tekst)},className:"cursor-pointer text-s whitespace-nowrap text-[var(--ax-text-accent-subtle)]",children:`+ ${$} filtre`})]}),e.jsxs("div",{ref:f,className:"invisible fixed left-[-9999px] flex items-center gap-2 flex-nowrap","aria-hidden":"true",children:[d&&e.jsx("div",{className:"flex-shrink-0",children:e.jsx(A,{...d,"data-clear-all":!0,className:"flex-shrink-0"})}),n.map(t=>e.jsx(E.Removable,{"data-chip-measure":!0,onClick:a=>a.preventDefault(),className:"flex-shrink-0 whitespace-nowrap",children:t.label},`m-${t.key}`)),e.jsxs("div",{"data-control-wrapper":!0,className:"flex items-center gap-2",children:[e.jsx("span",{"data-count-text":!0,className:"text-s whitespace-nowrap",children:"+ 0 filtre"}),e.jsx(w,{"data-expand-measure":!0,size:"small",variant:"tertiary",className:"flex-shrink-0",icon:e.jsx(N,{})}),e.jsx(w,{"data-collapse-measure":!0,size:"small",variant:"tertiary",className:"flex-shrink-0",icon:e.jsx(N,{className:"rotate-180"})})]})]}),F&&!l&&e.jsxs("div",{className:"absolute inset-y-0 right-0 flex items-center justify-end",style:{width:g},children:[e.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{background:"linear-gradient(to right, rgba(0,0,0,0) 0%, var(--ax-surface-default) 55%)"}}),e.jsx("div",{className:"relative flex items-center gap-2 pr-2 ",children:e.jsx(w,{onClick:()=>{b(!0),o.track(x.Generell.åpne_filter_chip_panel)},size:"small",variant:"tertiary","aria-label":"Vis flere filtre",icon:e.jsx(N,{className:"transition-transform"})})})]}),l&&e.jsx("div",{className:"absolute top-0 right-0 pr-2 pt-0",children:e.jsx(w,{ref:M,size:"small",variant:"tertiary","aria-label":"Skjul filtre",onClick:()=>{b(!1),o.track(x.Generell.lukk_filter_chip_panel)},icon:e.jsx(N,{className:"rotate-180 transition-transform"})})})]})})};P.__docgenInfo={description:"",methods:[],displayName:"ValgteFiltre",props:{filtre:{defaultValue:{value:"[]",computed:!1},required:!1}}};export{P as V};
