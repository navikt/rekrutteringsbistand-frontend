import{j as e,H as P,B as T,r as m,b as h,P as z,A as E,ab as I,gK as _,gH as N,g as $,o as L,I as k,_ as B,d as M,R}from"./iframe-DUxtTNxK.js";import{c as V}from"./stilling-util-BjBixF7p.js";import{B as W}from"./Box-Cboms74W.js";import{T as D}from"./Tag-CGXWCvcz.js";import{M as q}from"./Modal-DyHa_SWt.js";import{S as K}from"./Trash-DrCBaZmc.js";import{u as U}from"./useArbeidsgiver-rYMwLi27.js";import{C as J}from"./ComboboxProvider-DJxTMP43.js";import{A as X,a as G}from"./constants-ZFgYQbaO.js";import{u as Q}from"./index-BB9gl3jm.js";import{u as Y}from"./useArbeidsgivere-DgohNhaX.js";import{u as Z}from"./RekrutteringstreffContext-CgxDvbBy.js";import{S as ee}from"./SWRLaster-ahx2Fy0D.js";import{H as re}from"./VStack-DoqecrzT.js";const w=({navn:r,adresse:s,status:o,organisasjonsnummer:l,actionSlot:u})=>{const d=[s?.adresse,[s?.postnummer,s?.poststed].filter(Boolean).join(" "),s?.kommune].filter(g=>g&&String(g).trim().length>0).join(", ");return e.jsxs(W.New,{background:"neutral-softA",borderRadius:"xlarge",padding:"4",marginBlock:"2",className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(P,{level:"3",size:"xsmall",children:V(r||"")}),e.jsxs(T,{size:"small",className:"mt-1",children:[l&&e.jsxs(e.Fragment,{children:["Org.nr. ",l,d?"  ":""]}),d]})]}),e.jsxs("div",{className:"ml-2 self-start flex items-center gap-2",children:[o&&e.jsx(D,{size:"medium",variant:"info",children:o}),u]})]})};w.__docgenInfo={description:"",methods:[],displayName:"ArbeidsgiverKort",props:{organisasjonsnummer:{required:!1,tsType:{name:"string"},description:""},navn:{required:!1,tsType:{name:"string"},description:""},organisasjonsform:{required:!1,tsType:{name:"string"},description:""},antallAnsatte:{required:!1,tsType:{name:"number"},description:""},adresse:{required:!1,tsType:{name:"union",raw:"ArbeidsgiverAdresse | null",elements:[{name:"signature",type:"object",raw:`{
  adresse?: string;
  postnummer?: string;
  poststed?: string;
  kommune?: string;
  kommunenummer?: string;
  land?: string;
  landkode?: string;
}`,signature:{properties:[{key:"adresse",value:{name:"string",required:!1}},{key:"postnummer",value:{name:"string",required:!1}},{key:"poststed",value:{name:"string",required:!1}},{key:"kommune",value:{name:"string",required:!1}},{key:"kommunenummer",value:{name:"string",required:!1}},{key:"land",value:{name:"string",required:!1}},{key:"landkode",value:{name:"string",required:!1}}]}},{name:"null"}]},description:""},status:{required:!1,tsType:{name:"string"},description:""},naringskoder:{required:!1,tsType:{name:"union",raw:"naringskode[] | null",elements:[{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  kode?: string;
  beskrivelse?: string;
}`,signature:{properties:[{key:"kode",value:{name:"string",required:!1}},{key:"beskrivelse",value:{name:"string",required:!1}}]}}],raw:"naringskode[]"},{name:"null"}]},description:""},actionSlot:{required:!1,tsType:{name:"ReactNode"},description:""}}};const O=({navn:r,loading:s,disabled:o,onConfirm:l,onCancel:u,onAfterClose:d,onOpen:g,arbeidsgivereHook:b,variant:y="trash",triggerLabel:a,triggerAriaLabel:p,renderTrigger:t})=>{const c=m.useRef(null),f=()=>{c.current?.close(),d?.()},v=()=>{o||s||(g?.(),c.current?.showModal())},x=async()=>{await Promise.resolve(l()),b.mutate(),f()},S=()=>{s||(u?.(),f())},A=y==="cross"?e.jsx(z,{"aria-hidden":!0}):e.jsx(K,{"aria-hidden":!0}),n=!!s||!!o,i=y==="cross"?e.jsx(h,{size:"xsmall",variant:"tertiary",icon:A,onClick:v,"aria-label":p||a||"Fjern arbeidsgiver fra treffet",disabled:n}):e.jsx(h,{size:"small",variant:"tertiary",icon:A,onClick:v,disabled:n,children:a||"Slett"});return e.jsxs(e.Fragment,{children:[t?t({button:i,open:v,disabled:n}):i,e.jsxs(q,{ref:c,header:{heading:"Slett arbeidsgiver"},children:[e.jsx(q.Body,{children:r&&e.jsxs(T,{children:["Er du sikker på at du vil slette ",r," fra dette rekrutteringstreffet?"]})}),e.jsxs(q.Footer,{children:[e.jsx(h,{variant:"danger",onClick:x,loading:!!s,disabled:!!s,children:"Slett"}),e.jsx(h,{variant:"secondary",onClick:S,disabled:!!s,children:"Avbryt"})]})]})]})};O.__docgenInfo={description:"",methods:[],displayName:"SlettArbeidsgiverModal",props:{navn:{required:!1,tsType:{name:"string"},description:""},loading:{required:!1,tsType:{name:"boolean"},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:""},onConfirm:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void | Promise<void>",signature:{arguments:[],return:{name:"union",raw:"void | Promise<void>",elements:[{name:"void"},{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}]}}},description:""},onCancel:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onAfterClose:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onOpen:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},arbeidsgivereHook:{required:!0,tsType:{name:"Pick",elements:[{name:"SWRResponse",elements:[{name:"z.infer",elements:[{name:"ArbeidsgivereSchema"}],raw:"z.infer<typeof ArbeidsgivereSchema>"}],raw:"SWRResponse<ArbeidsgivereDTO>"},{name:"literal",value:"'mutate'"}],raw:"Pick<SWRResponse<ArbeidsgivereDTO>, 'mutate'>"},description:""},variant:{required:!1,tsType:{name:"union",raw:"'trash' | 'cross'",elements:[{name:"literal",value:"'trash'"},{name:"literal",value:"'cross'"}]},description:"",defaultValue:{value:"'trash'",computed:!1}},triggerLabel:{required:!1,tsType:{name:"string"},description:""},triggerAriaLabel:{required:!1,tsType:{name:"string"},description:""},renderTrigger:{required:!1,tsType:{name:"signature",type:"function",raw:`(args: {
  button: ReactNode;
  open: () => void;
  disabled: boolean;
}) => ReactNode`,signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  button: ReactNode;
  open: () => void;
  disabled: boolean;
}`,signature:{properties:[{key:"button",value:{name:"ReactNode",required:!0}},{key:"open",value:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}},required:!0}},{key:"disabled",value:{name:"boolean",required:!0}}]}},name:"args"}],return:{name:"ReactNode"}}},description:""}}};const H=({arbeidsgiverCallback:r,valgtArbeidsgiver:s,labelText:o,placeholder:l})=>{const[u,d]=m.useState(""),{isLoading:g,error:b,data:y}=U(u),[a,p]=m.useState(s??null);return m.useEffect(()=>{a&&r(a)},[a,r]),e.jsxs(m.Fragment,{children:[e.jsx("div",{role:"search",children:e.jsx(J,{isLoading:g,label:o??"Arbeidsgivers navn eller organisasjonsnummer",options:y?.map(t=>`${t.navn} - ${t.organisasjonsnummer}`)??[],shouldAutocomplete:!0,toggleListButton:!1,onChange:t=>d(t),onToggleSelected:t=>{const c=t.split(" - ").at(-1),f=y?.find(v=>v.organisasjonsnummer===c);f&&p(f)},placeholder:l})}),b&&e.jsx(E,{className:"mt-8",variant:"error",children:JSON.stringify(b)})]})};H.__docgenInfo={description:"",methods:[],displayName:"VelgArbeidsgiver",props:{children:{required:!1,tsType:{name:"union",raw:"ReactNode | undefined",elements:[{name:"ReactNode"},{name:"undefined"}]},description:""},arbeidsgiverCallback:{required:!0,tsType:{name:"signature",type:"function",raw:"(arbeidsgiver: ArbeidsgiverDTO) => void",signature:{arguments:[{type:{name:"z.infer",elements:[{name:"ArbeidsgiverSchema"}],raw:"z.infer<typeof ArbeidsgiverSchema>"},name:"arbeidsgiver"}],return:{name:"void"}}},description:""},valgtArbeidsgiver:{required:!1,tsType:{name:"union",raw:"ArbeidsgiverDTO | null",elements:[{name:"z.infer",elements:[{name:"ArbeidsgiverSchema"}],raw:"z.infer<typeof ArbeidsgiverSchema>"},{name:"null"}]},description:""},labelText:{required:!1,tsType:{name:"string"},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""}}};const ne=r=>`${N.internUrl}/${r}/arbeidsgiver`,se=(r,s)=>`${N.internUrl}/${r}/arbeidsgiver/${s}`,C=(r,s)=>I(ne(r),s),ie=(r,s)=>_(se(r,s)),F=r=>B(Object.values(r)),ae=r=>`${N.internUrl}/${r}/arbeidsgiver/hendelser`,te=L({id:k(),tidspunkt:k(),hendelsestype:F(G),opprettetAvAktørType:F(X),aktøridentifikasjon:k(),orgnr:k(),orgnavn:k()}),oe=M(te),le=r=>Q(ae(r),$(oe)),de=({variant:r="inline",onCompleted:s})=>{const{rekrutteringstreffId:o}=Z(),l=Y(o),u=le(o),{data:d}=l,[g,b]=m.useState(!1),y=async n=>{if(n)try{b(!0),await ie(o,n.arbeidsgiverTreffId??n.organisasjonsnummer),u.mutate()}finally{b(!1)}},[a,p]=m.useState(null),[t,c]=m.useState([]),[f,v]=m.useState(!1),x=m.useMemo(()=>new Set((d??[]).map(n=>n.organisasjonsnummer)),[d]),S=n=>{c(i=>i.filter(j=>j.organisasjonsnummer!==n))};m.useEffect(()=>{!d||!a||(async()=>{try{if(x.has(a.organisasjonsnummer)){p(null);return}if(r==="modal"){c(n=>n.some(j=>j.organisasjonsnummer===a.organisasjonsnummer)?n:[...n,a]),p(null);return}await C(o,{organisasjonsnummer:a.organisasjonsnummer,navn:a.navn}),l.mutate(),u.mutate()}catch(n){throw new R({message:"Feiler når prøver å legge til arbeidsgiver.",error:n})}finally{p(null)}})()},[a,r,x,o,l,u,d]);const A=async()=>{if(t.length!==0){v(!0);try{for(const n of t)await C(o,{organisasjonsnummer:n.organisasjonsnummer,navn:n.navn});l.mutate(),u.mutate(),c([]),s?.()}catch(n){throw new R({message:"Feiler når prøver å legge til arbeidsgiver(e).",error:n})}finally{v(!1)}}};return e.jsx(ee,{hooks:[l],children:n=>e.jsxs("div",{className:r==="modal"?"space-y-3":"space-y-4",children:[e.jsx("div",{children:e.jsx(H,{arbeidsgiverCallback:p,valgtArbeidsgiver:a,labelText:"Finn arbeidsgiver",placeholder:"Søk på navn, organisasjonsnummer"})}),r==="modal"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[t.map(i=>e.jsxs("div",{className:"relative",children:[e.jsx(w,{navn:i.navn,organisasjonsnummer:i.organisasjonsnummer,adresse:i.adresse??void 0}),e.jsx("div",{className:"absolute right-2 top-2",children:e.jsx(h,{size:"xsmall",variant:"tertiary",onClick:()=>S(i.organisasjonsnummer),"aria-label":`Fjern ${i.navn}`,children:e.jsx(z,{"aria-hidden":!0})})})]},i.organisasjonsnummer)),t.length===0&&e.jsx(T,{size:"small",children:"Ingen arbeidsgivere valgt ennå"})]}),e.jsx(re,{gap:"2",justify:"end",children:e.jsx(h,{type:"button",onClick:A,disabled:t.length===0||f,loading:f,children:"Legg til"})})]}),r==="inline"&&e.jsx(e.Fragment,{children:Array.isArray(n)&&n.length>0?e.jsx("ul",{children:n.map((i,j)=>e.jsx("li",{children:e.jsxs("div",{className:"relative",children:[e.jsx(w,{navn:i.navn,organisasjonsnummer:i.organisasjonsnummer,adresse:{adresse:"TODO: adresse må lagres i backend for å kunne hentes her"}}),e.jsx("div",{className:"absolute right-2 top-2",children:e.jsx(O,{navn:i.navn,loading:g,disabled:g,onConfirm:()=>y(i),arbeidsgivereHook:l,variant:"cross",triggerAriaLabel:`Fjern ${i.navn}`})})]})},j))}):e.jsx(T,{children:"Ingen arbeidsgivere lagt til"})})]})})};de.__docgenInfo={description:"",methods:[],displayName:"LeggTilArbeidsgiverForm",props:{variant:{required:!1,tsType:{name:"union",raw:"'inline' | 'modal'",elements:[{name:"literal",value:"'inline'"},{name:"literal",value:"'modal'"}]},description:"",defaultValue:{value:"'inline'",computed:!1}},onCompleted:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{w as A,de as L,O as S,H as V,ie as s,le as u};
