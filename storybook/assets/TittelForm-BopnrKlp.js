import{b5 as S,bN as v,bU as B,r as F,j as e,H as P,C as x,B as w,b7 as A,bV as k,d as V,an as C,at as _}from"./iframe-5rwrKWZV.js";import{T as y}from"./TextField-DNKHiWzK.js";import{T as G,S as I}from"./TidspunktForm-B20E5QNY.js";import{B as N}from"./Box-2Y16bkAR.js";import{K as Y}from"./KiAnalyseIntro-C8uT-Vx2.js";import{K as z}from"./KiAnalysePanel-DqCQ1EeI.js";import{u as H}from"./useFormFeltMedKiValidering-Cw0IdIfL.js";const r={GATEADRESSE:"gateadresse",POSTNUMMER:"postnummer",POSTSTED:"poststed",FYLKE:"fylke",FYLKESNUMMER:"fylkesnummer",KOMMUNE:"kommune",KOMMUNENUMMER:"kommunenummer"},D=({control:n})=>{const{setValue:a,clearErrors:d,setError:g,trigger:h}=S(),o=v({control:n,name:r.POSTNUMMER}),{data:l,isLoading:m}=B(o||"");return F.useEffect(()=>{if(!o||o.length!==4||m)return;const t={shouldDirty:!0,shouldValidate:!0};l?.korrigertNavnBy?(a(r.POSTSTED,l.korrigertNavnBy,t),a(r.KOMMUNE,l.kommune.korrigertNavn,t),a(r.KOMMUNENUMMER,l.kommune.kommunenummer,t),a(r.FYLKE,l.fylke.korrigertNavn,t),a(r.FYLKESNUMMER,l.fylke.fylkesnummer,t),d(r.POSTSTED)):(a(r.POSTSTED,"",t),a(r.KOMMUNE,"",t),a(r.KOMMUNENUMMER,"",t),a(r.FYLKE,"",t),a(r.FYLKESNUMMER,"",t),g(r.POSTSTED,{type:"manual",message:"Ukjent poststed"}))},[o,m,l,a,g,d]),e.jsxs("div",{className:"space-y-4",children:[e.jsx(P,{level:"3",size:"small",children:"Sted"}),e.jsx(x,{name:r.GATEADRESSE,control:n,render:({field:t,fieldState:u})=>e.jsx(y,{...t,value:t.value??"",label:"Gateadresse",error:u.error?.message,maxLength:100,onBlur:t.onBlur})}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(x,{name:r.POSTNUMMER,control:n,render:({field:t,fieldState:u})=>e.jsx(y,{...t,value:t.value??"",label:"Postnummer",htmlSize:12,error:u.error?.message,onChange:T=>{const c=T.target.value.replace(/\D/g,"");d([r.POSTNUMMER,r.POSTSTED]),a(r.POSTSTED,"",{shouldDirty:!1,shouldValidate:!0}),c.length<=4&&t.onChange(c),c.length===4&&h([r.POSTNUMMER])},onBlur:t.onBlur})}),e.jsx(w,{className:`mt-3 pt-8 ${v({control:n,name:r.POSTSTED})?"":"aksel-error-message"}`,children:v({control:n,name:r.POSTSTED})||(o&&o.length===4&&!m?"Ukjent poststed":"")})]})]})};D.__docgenInfo={description:"",methods:[],displayName:"StedForm"};const X=()=>{const{control:n}=S();return e.jsxs("div",{className:"space-y-8",children:[e.jsx(P,{level:"2",size:"medium",children:"Praktiske forhold"}),e.jsx(N.New,{background:"neutral-moderate",borderRadius:"xlarge",padding:"3",children:e.jsx(G,{control:n})}),e.jsx(N.New,{background:"neutral-moderate",borderRadius:"xlarge",padding:"3",children:e.jsx(I,{control:n})}),e.jsx(N.New,{background:"neutral-moderate",borderRadius:"xlarge",padding:"3",children:e.jsx(D,{control:n})})]})};X.__docgenInfo={description:"",methods:[],displayName:"PraktiskeForhold"};const q="Treff uten navn",b=({onUpdated:n})=>{const{treff:a}=A(),d=a?a.tittel??null:void 0,{clearErrors:g,formState:{isSubmitting:h}}=S(),o=F.useRef(null),{analyse:l,analyseError:m,validating:t,kiErrorBorder:u,harGodkjentKiFeil:T,showAnalysis:c,erRedigeringAvPublisertTreff:K,validerMedKiOgLagreVedGodkjenning:M,onGodkjennKiFeil:U,watchedValue:p,control:O,setValue:j}=H({feltType:"tittel",fieldName:"tittel",savedValue:d,onUpdated:n}),R=k-(typeof p=="string"?p.length:0),L=()=>{j("tittel","",{shouldValidate:!0,shouldDirty:!0,shouldTouch:!0}),o.current?.focus()};return e.jsxs("section",{className:"space-y-3",children:[e.jsx(Y,{title:"Navn på treffet"}),e.jsxs("div",{className:"relative w-full",onBlur:i=>{const f=i.currentTarget;setTimeout(async()=>{!f.contains(document.activeElement)&&!h&&await M()},0)},children:[p&&e.jsx(V,{type:"button",onClick:L,"aria-label":"Tøm tittel feltet",variant:"tertiary",size:"small",className:"absolute top-[2rem] right-2 h-8 -translate-y-1/2 p-1",title:"Tøm feltet",children:e.jsx(C,{"aria-hidden":!0,fontSize:"1.25rem"})}),e.jsx("div",{className:"flex items-start",children:e.jsx(x,{control:O,name:"tittel",render:({field:i,fieldState:f})=>e.jsx(y,{...i,value:i.value??"",ref:s=>{i.ref(s),o.current=s},label:"Navn på treffet",hideLabel:!0,maxLength:k,className:"w-full pt-2",error:f.error?.message||(u?"Brudd på retningslinjer":void 0),"aria-invalid":!!(f.error||u),autoComplete:"off",autoCorrect:"off",spellCheck:!1,onChange:s=>{i.onChange(s),s.target.value.trim().length>0&&g("tittel")},onBlur:()=>{i.onBlur()},onFocus:()=>{const s=i.value;if(!s||typeof s!="string")return;s.trim()===q&&j("tittel","",{shouldValidate:!1,shouldDirty:!1,shouldTouch:!1})},onKeyDown:s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),(async()=>{const E=s.currentTarget;await M(),E?.blur()})())}})})})]}),e.jsxs(_,{className:"text-gray-400",children:[R," tegn igjen"]}),e.jsx(z,{validating:t,analyse:l,analyseError:m,harGodkjentKiFeil:T,showAnalysis:c,erRedigeringAvPublisertTreff:K,onGodkjennKiFeil:U,ariaLabel:"Analyse av tittel"})]})};b.displayName="TittelForm";b.__docgenInfo={description:"",methods:[],displayName:"TittelForm",props:{onUpdated:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{X as P,D as S,b as T};
