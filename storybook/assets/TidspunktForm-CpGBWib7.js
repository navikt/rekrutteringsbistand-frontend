import{bN as be,t as J,bV as ke,bW as Q,r as o,j as D,B as Z,C as $,b5 as ee,bL as H,b7 as ve,Y as te,f as ne,H as re,b6 as X,bX as we}from"./iframe-_QUoCLzD.js";import{i as z,k as N}from"./utils-DOwMAexz.js";import{C as qe}from"./ComboboxProvider-DEqMhz4T.js";import{i as F}from"./isSameDay-7142iDy3.js";import{u as xe,D as Y}from"./useDatepicker-DG-dq8M0.js";import"./Date.Input-C4Dh5hB2.js";import{d as Ce,g as Ie}from"./differenceInMilliseconds-BRh7XhHk.js";function Se(e,a,s){return be(e,+J(e)+a)}function Ee(e,a,s){return Se(e,a*ke)}function je(e,a,s){const i=J(e,s?.in);return i.setTime(i.getTime()+a*Q),i}function Ne(e,a,s){const i=Ce(e,a)/Q;return Ie(s?.roundingMethod)(i)}const _=[0,30],j=Array.from({length:24},(e,a)=>_.map(s=>`${String(a).padStart(2,"0")}:${String(s).padStart(2,"0")}`)).flat(),Re=/^([01]\d|2[0-3]):([0-5]\d)$/,Me=e=>{const a=e.match(/^(\d{1,2})(?::?(\d{0,2}))?$/);if(!a)return null;const s=Math.min(parseInt(a[1]||"0",10)||0,23),i=parseInt(a[2]||"0",10)||0,l=_.reduce((u,c)=>Math.abs(c-i)<Math.abs(u-i)?c:u,_[0]);return`${String(s).padStart(2,"0")}:${String(l).padStart(2,"0")}`};function se({value:e,onChange:a,onBlur:s,label:i="Klokkeslett",hideLabel:l,disabled:u,error:c,className:m,options:f,maxTime:d}){const h=o.useRef(null),y=o.useRef(!1),b=o.useRef(!1),T=o.useMemo(()=>{const t=f??j;return d?t.filter(r=>r<=d):t},[f,d]),[n,p]=o.useState(e??""),[S,q]=o.useState(!1),x=o.useRef(!1),P=o.useRef(e),C=o.useRef(!1),E=o.useRef(!1),I=o.useCallback(t=>Re.test(t)&&(!d||t<=d),[d]),V=o.useCallback(t=>!t||/^[\d:]*$/.test(t),[]),oe=o.useCallback((t,r)=>d&&r>d||t.includes(r)?t:[...t,r].sort(),[d]),B=e&&I(e)?oe(T,e):T,R=o.useMemo(()=>B,[B]),K=()=>{const t=h.current;if(!t||typeof document>"u")return null;const r=t.getAttribute("aria-controls");return r?document.getElementById(r):null},le=o.useCallback(()=>{if(y.current)return;const t=h.current;if(!t||t.getAttribute("aria-expanded")!=="true")return;const r=K();if(!r)return;let g=r.querySelector("[role='option'][aria-selected='true']");if(!g&&e&&(g=Array.from(r.querySelectorAll("[role='option']")).find(k=>k.textContent?.trim()===e)||null),!g)return;const w=g.closest("[role='listbox']")||g.parentElement;if(w){const k=g.offsetTop,O=k+g.offsetHeight,W=w.scrollTop,ye=W+w.clientHeight;if(k<W+4){w.scrollTop=Math.max(k-4,0);return}if(O>ye-4){const he=Math.max(k-4,0);w.scrollTop=he}}},[e]),A=o.useCallback(()=>{},[le]),M=o.useCallback(t=>{const r=t.trim();return r===""?(x.current?e&&a(""):p(e??""),!0):I(r)?(r!==e&&a(r),!0):(p(e??""),!1)},[I,a,e]),ue=o.useCallback(t=>{if(C.current&&t===""){C.current=!1;return}!x.current&&t!==""&&(x.current=!0),!(t===""&&!x.current)&&(p(t===""?"":t),t!==""&&q(!0))},[]),de=o.useCallback(t=>{const r=t.relatedTarget,g=K(),w=b.current;if(b.current=!1,!w&&(E.current||(r&&g?g.contains(r):!1))){E.current=!1,s?.(t);return}if(E.current=!1,!x.current&&(n===""||n===P.current)){p(e??""),s?.(t);return}M(n),q(!0),s?.(t)},[M,n,s,e]),U=o.useCallback((t,r)=>{const g=B;let v=(k=>k&&I(k)?g.indexOf(k):-1)(t);if(v===-1){const k=Me(n);v=k?g.indexOf(k):-1}if(v===-1){const k=n||e||"",O=g.indexOf(k);v=O>=0?O:0}return g[(v+r+g.length)%g.length]},[B,I,n,e]),G=o.useCallback((t,r)=>{const g=U(t,r);x.current=!0,C.current=!0,p(g)},[U]),ce=o.useCallback(t=>{const r=t.key;if(r==="ArrowDown"||r==="ArrowUp"){t.preventDefault(),t.stopPropagation(),G(n||e,r==="ArrowDown"?1:-1);return}if(r==="Enter"){C.current=!0,!M(n??"")&&e&&p(e),q(!0);return}if(r==="Tab"){b.current=!0,C.current=!0,!M(n??"")&&e&&p(e),q(!0);return}},[M,n,G,e]),fe=o.useCallback(t=>{const r=t.nativeEvent,g="data"in r?r.data:null;V(g)||t.preventDefault()},[V]),me=o.useCallback(t=>{const r=t.clipboardData.getData("text");V(r)||t.preventDefault()},[V]),pe=o.useCallback(t=>{const r=t.target,g=r.tagName==="INPUT",w=r.getAttribute("role")==="option"||!!r.closest("[role='option']"),v=!!r.closest("[role='listbox']");(w||v)&&(E.current=!0),v&&(y.current=!0),g||w||v||(h.current?.focus(),t.preventDefault(),C.current=!0)},[]),ge=o.useCallback(()=>{y.current=!1,x.current=!1,P.current=e,q(!1),C.current=!0,E.current=!1,b.current=!1,A()},[A,e]);o.useEffect(()=>{const t=e??"",r=setTimeout(()=>{p(t)},0);return()=>clearTimeout(r)},[e]),o.useEffect(()=>{const t=h.current;if(!t)return;const r=new MutationObserver(()=>{t.getAttribute("aria-expanded")==="true"&&A()});return r.observe(t,{attributes:!0,attributeFilter:["aria-expanded"]}),()=>r.disconnect()},[A]);const Te=o.useMemo(()=>{const t=n&&I(n)&&R.includes(n)?n:e&&I(e)&&R.includes(e)?e:void 0;return t?[t]:[]},[n,e,I,R]),De=`${m??"w-[7rem]"} focus-within:outline-none focus-visible:outline-none focus-within:ring-0 focus-visible:ring-0`;return D.jsx(qe,{ref:h,label:i,hideLabel:l,disabled:u,error:c,className:De,options:R,filteredOptions:R,allowNewValues:!0,toggleListButton:!0,isListOpen:S?!1:void 0,value:n,inputClassName:"min-w-0",shouldShowSelectedOptions:!1,selectedOptions:Te,onMouseDownCapture:pe,onFocus:ge,onToggleSelected:(t,r)=>{r&&(C.current=!0,E.current=!1,p(t),P.current=t,x.current=!1,a(t),q(!0))},onChange:ue,onBlur:de,onKeyDownCapture:ce,onBeforeInput:fe,onPaste:me})}se.__docgenInfo={description:"",methods:[],displayName:"TimeInput",props:{value:{required:!1,tsType:{name:"string"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},onBlur:{required:!1,tsType:{name:"ReactFocusEventHandler",raw:"React.FocusEventHandler<HTMLInputElement>",elements:[{name:"HTMLInputElement"}]},description:""},label:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"'Klokkeslett'",computed:!1}},hideLabel:{required:!1,tsType:{name:"boolean"},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:""},error:{required:!1,tsType:{name:"union",raw:"ReactNode | boolean",elements:[{name:"ReactNode"},{name:"boolean"}]},description:""},className:{required:!1,tsType:{name:"string"},description:""},options:{required:!1,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""},maxTime:{required:!1,tsType:{name:"string"},description:""}}};function ae(e,a,s,i=15){return o.useMemo(()=>{const l=e??null,u=a??null,c=s??null;if(!l||!u||!z(c)||!F(l,u))return j;const m=N(u,c);if(!m)return j;const f=je(m,i);if(!F(m,f))return i>0?[]:j;const d=f.getTime(),h=i>0;return j.filter(b=>{const T=N(l,b);return T?h?T.getTime()>=d:T.getTime()<=d:!1})},[e,a,s,i])}function ie({label:e,value:a,onChange:s,onBlur:i,error:l,from:u=new Date,to:c=new Date("2040-12-31"),disabled:m}){const{inputProps:f,datepickerProps:d,selectedDay:h,setSelected:y}=xe({defaultSelected:a??void 0,fromDate:u,toDate:c,onDateChange:n=>s(n??null)}),b=o.useCallback(n=>!n||/^[\d./-]*$/.test(n),[]);o.useEffect(()=>{const n=a??void 0,p=h??void 0;(n&&(!p||p.getTime()!==n.getTime())||!n&&p)&&y(n)},[a,h,y]);const T=n=>{f.onBlur?.(n),i?.()};return D.jsx(Y,{mode:"single",...d,children:D.jsx(Y.Input,{...f,hideLabel:!0,label:e,error:l?l.message||!0:void 0,disabled:m,onBlur:T,onBeforeInput:n=>{const p=n.nativeEvent,S="data"in p?p.data:null;if(!b(S)){n.preventDefault();return}f.onBeforeInput?.(n)},onPaste:n=>{const p=n.clipboardData.getData("text");if(!b(p)){n.preventDefault();return}f.onPaste?.(n)},placeholder:"dd.mm.책책책책"})})}ie.__docgenInfo={description:"",methods:[],displayName:"ControlledDatePicker",props:{label:{required:!0,tsType:{name:"string"},description:""},value:{required:!0,tsType:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}]},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(d: Date | null) => void",signature:{arguments:[{type:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}]},name:"d"}],return:{name:"void"}}},description:""},onBlur:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},error:{required:!1,tsType:{name:"FieldError"},description:""},from:{required:!1,tsType:{name:"Date"},description:"",defaultValue:{value:"new Date()",computed:!1}},to:{required:!1,tsType:{name:"Date"},description:"",defaultValue:{value:"new Date('2040-12-31')",computed:!1}},disabled:{required:!1,tsType:{name:"boolean"},description:""}}};function L({label:e,nameDato:a,nameTid:s,control:i,disabledDato:l,disabledTid:u,hideDato:c,dateFrom:m,dateTo:f,timeOptions:d,onDatoBlur:h,onTidBlur:y,timeMax:b}){return D.jsxs("div",{className:"flex items-start gap-4",children:[e&&D.jsx("div",{className:"mt-3 flex min-w-fit items-center",children:D.jsx(Z,{size:"small",children:e})}),!c&&D.jsx($,{name:a,control:i,rules:{required:"Dato er obligatorisk"},render:({field:T,fieldState:n})=>D.jsx(ie,{label:e??"",value:T.value,onChange:p=>T.onChange(p),onBlur:()=>{T.onBlur(),h?.()},error:n.error,disabled:l,from:m,to:f})}),c&&D.jsx($,{name:a,control:i,render:({field:T})=>{const n=T.value;return D.jsx("input",{type:"hidden",value:n instanceof Date?n.toISOString():"",onChange:()=>{}})}}),D.jsx($,{name:s,control:i,rules:{required:"Tid er obligatorisk"},render:({field:T,fieldState:n})=>{const p=typeof T.value=="string"?T.value:"";return D.jsx(se,{value:p,onChange:T.onChange,label:"Klokkeslett",hideLabel:!0,error:n.error?.message,disabled:u,onBlur:()=>{T.onBlur(),y?.()},className:"w-24",options:d??j,maxTime:b})}})]})}L.__docgenInfo={description:"",methods:[],displayName:"DatoTidRad",props:{label:{required:!1,tsType:{name:"string"},description:""},nameDato:{required:!0,tsType:{name:"Path",elements:[{name:"T"}],raw:"Path<T>"},description:""},nameTid:{required:!0,tsType:{name:"Path",elements:[{name:"T"}],raw:"Path<T>"},description:""},control:{required:!0,tsType:{name:"Control",elements:[{name:"T"}],raw:"Control<T>"},description:""},disabledDato:{required:!1,tsType:{name:"boolean"},description:""},disabledTid:{required:!1,tsType:{name:"boolean"},description:""},hideDato:{required:!1,tsType:{name:"boolean"},description:""},dateFrom:{required:!1,tsType:{name:"Date"},description:""},dateTo:{required:!1,tsType:{name:"Date"},description:""},timeOptions:{required:!1,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""},onDatoBlur:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onTidBlur:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},timeMax:{required:!1,tsType:{name:"string"},description:""}}};const Oe=e=>e?te(e):null,Fe=e=>e?ne(te(e),"HH:mm"):"",Ve=({control:e})=>{const{setValue:a}=ee(),[s,i]=H({control:e,name:["svarfristDato","svarfristTid"]}),[l,u]=H({control:e,name:["fraDato","fraTid"]}),{treff:c}=ve(),m=ae(s,l,u,0);return o.useEffect(()=>{c&&(!s&&c.svarfrist&&a("svarfristDato",Oe(c.svarfrist),{shouldValidate:!1,shouldDirty:!1}),!i&&c.svarfrist&&a("svarfristTid",Fe(c.svarfrist),{shouldValidate:!1,shouldDirty:!1}))},[c,s,i,a]),o.useEffect(()=>{if(!l||!z(u))return;const f=N(l??null,u??null),d=N(s??null,i??null);!f||!d||d.getTime()>f.getTime()&&(a("svarfristDato",new Date(l),{shouldDirty:!0,shouldValidate:!1}),a("svarfristTid",u,{shouldDirty:!0,shouldValidate:!1}))},[l,u,s,i,a]),D.jsxs("div",{className:"space-y-4",children:[D.jsx(re,{level:"3",size:"small",children:"Svarfrist"}),D.jsx("div",{children:D.jsx(L,{nameDato:"svarfristDato",nameTid:"svarfristTid",control:e,dateTo:l??void 0,timeOptions:m})})]})};Ve.__docgenInfo={description:"",methods:[],displayName:"SvarfristForm",props:{control:{required:!0,tsType:{name:"Control",elements:[{name:"signature",type:"object",raw:`{
  tittel?: string;
  gateadresse?: string | null;
  postnummer?: string | null;
  poststed?: string | null;
  fraDato?: Date | null;
  fraTid?: string;
  tilDato?: Date | null;
  tilTid?: string;
  svarfristDato?: Date | null;
  svarfristTid?: string;
}`,signature:{properties:[{key:"tittel",value:{name:"string",required:!1}},{key:"gateadresse",value:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}],required:!1}},{key:"postnummer",value:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}],required:!1}},{key:"poststed",value:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}],required:!1}},{key:"fraDato",value:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}],required:!1}},{key:"fraTid",value:{name:"string",required:!1}},{key:"tilDato",value:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}],required:!1}},{key:"tilTid",value:{name:"string",required:!1}},{key:"svarfristDato",value:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}],required:!1}},{key:"svarfristTid",value:{name:"string",required:!1}}]}}],raw:"Control<RekrutteringstreffFormValues>"},description:""}}};function Be(e,a=1){return{adjustEndTime:o.useCallback((i,l,u,c,m,f)=>{if(!i||!z(l))return!1;const d=N(i,l);if(!d)return!1;const y=N(u??i,c),b=a>0;if(y?b?y.getTime()>d.getTime():y.getTime()<d.getTime():!1)return!1;const n=Ee(d,a),p=X(n),S=ne(n,"HH:mm");let q=!1;return(!u||X(u).getTime()!==p.getTime())&&(e(m,p,{shouldDirty:!0,shouldValidate:!1}),q=!0),c!==S&&(e(f,S,{shouldDirty:!0,shouldValidate:!1}),q=!0),q},[e,a])}}const Ae=(e,a,s,i)=>{if(!e||!s)return"";const l=(m,f)=>{const[d,h]=f.split(":").map(Number),y=new Date(m);return y.setHours(d,h,0,0),y},u=l(e,a),c=l(s,i);if(F(u,c)){const m=Ne(c,u);if(m===0)return"0 minutt";const f=Math.abs(m),d=Math.floor(f/60),h=f%60,y=m<0?"-":"",b=[];return d>0&&b.push(`${d} time${d>1?"r":""}`),h>0&&b.push(`${h} minutt`),`${y}${b.join(" ")}`}else{const m=we(c,u),f=m>=0?m+1:m;return`${f} dag${Math.abs(f)!==1?"er":""}`}},Le=({control:e})=>{const{setValue:a}=ee(),[s,i,l,u]=H({control:e,name:["fraDato","fraTid","tilDato","tilTid"]}),[c,m]=o.useState(s&&l?!F(s,l):!1),{adjustEndTime:f}=Be(a,1),d=ae(l??s,s,i,1);o.useEffect(()=>{const y=s&&l?!F(s,l):!1,b=setTimeout(()=>{m(T=>T===y?T:y)},0);return()=>clearTimeout(b)},[s,l]),o.useEffect(()=>{f(s,i,l,u,"tilDato","tilTid")},[s,i,l,u,f]);const h=o.useMemo(()=>!s||!i||!u?"":Ae(s,i,l??s,u),[s,i,l,u]);return D.jsxs("div",{className:"space-y-4",children:[D.jsx("div",{className:"flex items-center justify-between",children:D.jsx(re,{level:"3",size:"small",children:"Tid"})}),D.jsxs("div",{className:"flex flex-col gap-4 lg:flex-row",children:[D.jsx(L,{nameDato:"fraDato",nameTid:"fraTid",control:e,timeMax:"22:59"}),D.jsx(L,{label:"Til",nameDato:"tilDato",nameTid:"tilTid",control:e,hideDato:!c,dateFrom:s??void 0,timeOptions:d}),D.jsx(Z,{size:"small",className:"mt-3",children:h||"Velg tid"})]})]})};Le.__docgenInfo={description:"",methods:[],displayName:"TidspunktForm",props:{control:{required:!0,tsType:{name:"Control",elements:[{name:"signature",type:"object",raw:`{
  tittel?: string;
  gateadresse?: string | null;
  postnummer?: string | null;
  poststed?: string | null;
  fraDato?: Date | null;
  fraTid?: string;
  tilDato?: Date | null;
  tilTid?: string;
  svarfristDato?: Date | null;
  svarfristTid?: string;
}`,signature:{properties:[{key:"tittel",value:{name:"string",required:!1}},{key:"gateadresse",value:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}],required:!1}},{key:"postnummer",value:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}],required:!1}},{key:"poststed",value:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}],required:!1}},{key:"fraDato",value:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}],required:!1}},{key:"fraTid",value:{name:"string",required:!1}},{key:"tilDato",value:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}],required:!1}},{key:"tilTid",value:{name:"string",required:!1}},{key:"svarfristDato",value:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}],required:!1}},{key:"svarfristTid",value:{name:"string",required:!1}}]}}],raw:"Control<RekrutteringstreffFormValues>"},description:""}}};export{Ve as S,Le as T};
