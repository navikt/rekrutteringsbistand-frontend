import{j as e,d as r,u as E,P as q,aw as U,d6 as O,d7 as $,r as N,d8 as t,cD as _,d9 as G,J as F,M as K,B as S,D as W}from"./iframe-_QUoCLzD.js";import{A as Q}from"./ActionMenu-MnQcPvY-.js";import{S as y}from"./ArrowForward-IzyID6lT.js";import{P as X,a as Y,b as Z,c as ee,d as se}from"./PopoverModal-CDVAiYig.js";import{U as ne}from"./umamiEvents-4lZbqD_K.js";import{S as ae}from"./Select-BlMsCIgD.js";import{B as I}from"./Box-B_LxU5eT.js";import{M as v}from"./Modal-Csfh0IqP.js";import{A as g}from"./Accordion-EFcdA_ix.js";import{T as a}from"./Table-B_bItFtM.js";const le=({markerteKandidater:i,knappVariant:l,actionMenu:h,setVisSendSmsModal:n})=>{const m=()=>{n&&i.length>0&&n(!0)};return h?e.jsxs(Q.Item,{onSelect:m,children:[e.jsx(y,{})," Tips om stilling"]}):e.jsx(r,{disabled:i.length===0,onClick:m,size:"small",variant:l||"secondary",icon:e.jsx(y,{title:"Tips om stilling"}),children:"Tips om stillingen"})};le.__docgenInfo={description:"",methods:[],displayName:"SendSmsKnapp",props:{markerteKandidater:{required:!0,tsType:{name:"Array",elements:[{name:"z.infer",elements:[{name:"kandidaterSchema"}],raw:"z.infer<typeof kandidaterSchema>"}],raw:"KandidatListeKandidatDTO[]"},description:""},knappVariant:{required:!1,tsType:{name:"union",raw:"'secondary' | 'tertiary'",elements:[{name:"literal",value:"'secondary'"},{name:"literal",value:"'tertiary'"}]},description:""},actionMenu:{required:!1,tsType:{name:"boolean"},description:""},setVisSendSmsModal:{required:!1,tsType:{name:"signature",type:"function",raw:"(open: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"open"}],return:{name:"void"}}},description:""}}};const ie="_sendSmsModal_1o7hh_1",te="_velgMal_1o7hh_5",re="_kontortidAdvarsel_1o7hh_18",b={sendSmsModal:ie,velgMal:te,kontortidAdvarsel:re},de=i=>{const{visVarsel:l}=E(),{fjernAllMarkering:h,markerteKandidater:n,popover:m,knappVariant:z,setVisSendSmsModal:c}=i,{track:D}=q(),{stillingsData:p}=U(),u=p?.stillingsinfo?.stillingskategori,P=p.stilling.uuid,{data:M={}}=O(u==="FORMIDLING"?null:p.stilling.uuid),V=$(),[j,T]=N.useState(!1),d=n.filter(s=>s.fodselsnr&&M[s.fodselsnr]),o=n.filter(s=>!(s.fodselsnr&&M[s.fodselsnr])),B=n.some(s=>s.fodselsnr===null),[A,H]=N.useState(u===_.Jobbmesse?t.Jobbarrangement:t.VurdertSomAktuell),{data:C}=G(),k=n.map(s=>s.fodselsnr),x=async()=>{if(T(!0),k.length===0){l({tekst:"Ingen kandidater valgt",type:"warning"});return}try{await V({mal:A,fnr:k.filter(s=>s!==null),stillingId:P}),D(ne.Stilling.send_beskjed_til_kandidat,{antall:k.length}),l({tekst:"Beskjed er sendt",type:"success"}),h(),c?.(!1)}catch(s){new W({message:"Klarte ikke å sende SMS:",error:s}),l({tekst:s instanceof Error?`Feil ved sending: ${s.message}`:"Det skjedde en uventet feil ved sending av beskjed",type:"error"})}finally{T(!1)}},f=e.jsxs("div",{className:"send-sms-modal__innhold",children:[e.jsx(F,{variant:"info",className:b.kontortidAdvarsel,children:e.jsx(K,{size:"small",children:"SMS sendes ut mellom 09:00 og 17:15 hver dag. Det kan oppstå forsinkelser."})}),u!==_.Jobbmesse&&e.jsxs(ae,{className:b.velgMal,label:"Velg hva som skal vises i beskjeden",onChange:s=>{H(s.target.value)},children:[e.jsx("option",{value:t.VurdertSomAktuell,children:"Tips en aktuell kandidat om stilling"}),e.jsx("option",{value:t.FunnetPassendeStilling,children:"Oppfordre kandidat til å søke på stilling"})]}),e.jsx(K,{htmlFor:"forhåndsvisning",children:"Meldingen som vil bli sendt til kandidatene"}),e.jsx("div",{id:"forhåndsvisning",className:"py-4",children:e.jsx(I.New,{background:"neutral-softA",borderRadius:"large",padding:"4",children:e.jsx(S,{children:e.jsxs("span",{children:[C?oe(A,C):"Klarte ikke å hente meldingsmaler"," "]})})})})]});return m?e.jsxs(e.Fragment,{children:[e.jsx(X,{tittel:"Tips om stilling",åpneKnapp:e.jsx(r,{disabled:n.length===0,size:"small",variant:z||"secondary",icon:e.jsx(y,{title:"Tips om stilling"}),children:"Tips om stillingen"}),children:e.jsxs(e.Fragment,{children:[f,e.jsx("div",{className:"flex justify-end",children:e.jsx(r,{disabled:d.length===n.length||o.length===0,variant:"primary",loading:j,onClick:x,children:"Send tips"})})]})}),e.jsxs(Y,{children:[e.jsx(Z,{}),e.jsx(ee,{className:"z-999",side:"bottom",align:"start",children:e.jsxs(I.New,{background:"raised",borderRadius:"12",padding:"5",shadow:"dialog",borderColor:"neutral-subtle",borderWidth:"1",children:[e.jsx("div",{className:"flex justify-between",children:e.jsx(se,{children:"asd"})}),f,e.jsx("div",{className:"flex justify-end",children:e.jsx(r,{disabled:d.length===n.length||o.length===0,variant:"primary",loading:j,onClick:x,children:"Send tips"})})]})})]})]}):c?e.jsx(e.Fragment,{children:e.jsxs(v,{open:!0,className:b.sendSmsModal,onClose:()=>c(!1),"aria-label":`Tips ${n.length} kandidater om stillingen`,header:{heading:"Tips om stillingen"},children:[e.jsxs(v.Body,{children:[(d.length>0||B)&&e.jsx(F,{variant:"warning",size:"small",className:"my-4",children:"Ikke alle kandidatene vil motta beskjeden"}),e.jsxs(S,{children:["Det vil bli sendt beskjed til"," ",e.jsx("b",{children:o.length})," ",o.length===1?"kandidat":"kandidater"]}),e.jsx(S,{size:"small",children:"Telefonnummerene/e-postene blir hentet fra Kontakt- og reservasjonsregisteret."}),e.jsx(g,{size:"small",headingSize:"xsmall",className:"my-4",children:e.jsxs(g.Item,{children:[e.jsx(g.Header,{children:"Vis kandidater"}),e.jsx(g.Content,{children:e.jsxs(a,{size:"small",children:[e.jsx(a.Header,{children:e.jsxs(a.Row,{children:[e.jsx(a.HeaderCell,{scope:"col",children:"Navn"}),e.jsx(a.HeaderCell,{scope:"col",children:"Fødselsnr."}),e.jsx(a.HeaderCell,{scope:"col",children:"Kan sende tips"})]})}),e.jsx(a.Body,{children:n?.map(({fornavn:s,etternavn:J,fodselsnr:w},R)=>e.jsxs(a.Row,{children:[e.jsxs(a.HeaderCell,{scope:"row",children:[s," ",J]}),e.jsx(a.DataCell,{children:w}),e.jsx(a.DataCell,{children:d.some(L=>L.fodselsnr===w)?"Nei":"Ja"})]},R))})]})})]})}),f]}),e.jsxs(v.Footer,{children:[e.jsx(r,{disabled:d.length===n.length||o.length===0,variant:"primary",loading:j,onClick:x,children:"Send tips"}),e.jsx(r,{variant:"secondary",onClick:()=>c(!1),children:"Avbryt"})]})]})}):null},oe=(i,l)=>{if(i===t.VurdertSomAktuell)return l.vurdertSomAktuell?.smsTekst;if(i===t.FunnetPassendeStilling)return l.passendeStilling?.smsTekst;if(i===t.Jobbarrangement)return l.passendeJobbarrangement?.smsTekst};de.__docgenInfo={description:"",methods:[],displayName:"SendSmsModal"};export{le as S,de as a};
