import{r as n,v as k,j as e,d as s,C as m,w as b,x as f,y as w}from"./iframe-CVBkVRHF.js";import{R as S}from"./RikTekstEditor-DsLX6i4w.js";import{S as E}from"./Pencil-Jkk0E3lX.js";import{M as l}from"./Modal-DwOvZulO.js";import{T}from"./TextField-D1bsAp3q.js";function C({eksisterendeNyhet:r,refetch:x}){const a=n.useRef(null),[d,c]=n.useState(!1),[p,o]=n.useState(!1),{control:u,handleSubmit:y,reset:h,formState:{errors:g}}=k({defaultValues:r||{tittel:"",innhold:""}}),j=async t=>{if(r){const i={...r,...t};c(!0);try{await b(i)}catch(v){throw new f({message:"Noe gikk galt ved oppdatering av nyhet",error:v})}}else try{await w(t)}catch(i){throw new f({message:"Noe gikk galt ved oppretting av nyhet",error:i})}x(),c(!1),o(!0)};return n.useEffect(()=>{if(p){a.current?.close(),h();const t=setTimeout(()=>o(!1),0);return()=>clearTimeout(t)}},[p,h]),e.jsxs("div",{children:[r?e.jsx(s,{onClick:()=>a.current?.showModal(),variant:"tertiary",icon:e.jsx(E,{}),children:"Endre"}):e.jsx(s,{size:"small",onClick:()=>a.current?.showModal(),children:r?"Oppdater nyhet":"Opprett nyhet"}),e.jsx(l,{className:"w-full",ref:a,header:{heading:r?"Oppdater nyhet":"Opprett ny nyhet"},children:e.jsxs("form",{onSubmit:y(j),children:[e.jsx(l.Body,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx(m,{name:"tittel",control:u,rules:{required:"Tittel er pÃ¥krevd"},render:({field:t})=>e.jsx(T,{...t,label:"Tittel",error:g.tittel?.message})}),e.jsxs("div",{children:[e.jsx("label",{className:"navds-label mb-2 block",children:"Innhold"}),e.jsx(m,{name:"innhold",control:u,render:({field:t})=>e.jsx(S,{utviklerExtensions:!0,id:"oppdater-nyhet",tekst:t.value??"",onChange:t.onChange})})]})]})}),e.jsxs(l.Footer,{children:[e.jsx(s,{loading:d,type:"submit",children:"Oppdater nyhet"}),e.jsx(s,{loading:d,type:"button",variant:"secondary",onClick:()=>o(!0),children:"Avbryt"})]})]})})]})}C.__docgenInfo={description:"",methods:[],displayName:"EndreNyhetModal",props:{eksisterendeNyhet:{required:!1,tsType:{name:"z.infer",elements:[{name:"nyheterSchema"}],raw:"z.infer<typeof nyheterSchema>"},description:""},refetch:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{C as E};
