import{r as p,y as F,R as w,j as e,cC as T,W as _,X as K,T as H,u as L,av as B,cD as P,d as C,S as V,D as J,E as D}from"./iframe-BwFHCbBn.js";import{u as U}from"./KandidatlisteContext-DYAMuCUL.js";import{U as $}from"./umamiEvents-DmzFNrn7.js";import{M as A}from"./Modal-CcX2UsI9.js";import{A as h}from"./Accordion-D_-rv2OH.js";import{T as d}from"./Table-BGwzDCLh.js";import{C as q}from"./ComboboxProvider-BV90Sdtl.js";var W=function(t,o){var s={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&o.indexOf(n)<0&&(s[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)o.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(s[n[r]]=t[n[r]]);return s};const Z=p.forwardRef((t,o)=>{var{title:s,titleId:n}=t,r=W(t,["title","titleId"]);let c=F();return c=s?n||"title-"+c:void 0,w.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 24 24",focusable:!1,role:"img",ref:o,"aria-labelledby":c},r),s?w.createElement("title",{id:c},s):null,w.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M5.75 20.25V3.75h12.5v9.75a.75.75 0 0 0 1.5 0v-10c0-.69-.56-1.25-1.25-1.25h-13c-.69 0-1.25.56-1.25 1.25v17c0 .69.56 1.25 1.25 1.25h1.742a.75.75 0 0 0 0-1.5zm5.2-14.1a.75.75 0 0 1 .15 1.05l-1.5 2a.75.75 0 0 1-1.13.08l-1-1a.75.75 0 0 1 1.06-1.06l.389.388L9.9 6.3a.75.75 0 0 1 1.05-.15M13 7.25a.75.75 0 0 0 0 1.5h2.5a.75.75 0 0 0 0-1.5zm-3.514 5.204a.75.75 0 0 1 .819-.14l9 4a.75.75 0 0 1 0 1.371l-9 4a.75.75 0 0 1-1.007-.948L10.699 17l-1.401-3.737a.75.75 0 0 1 .188-.809m1.845 1.958.689 1.838H14a.75.75 0 0 1 0 1.5h-1.98l-.69 1.838L17.154 17z",clipRule:"evenodd"}))}),S=({opprettetAvNavn:t,stillingstittel:o})=>{const s=p.useRef(null),n=p.useCallback(a=>{if(!a)return;let m=null;try{m=a.contentDocument||a.contentWindow?.document,m?.body}catch{return}if(!m)return;const v=m.getElementById("tittel"),j=m.getElementById("stillingstittel"),b=m.getElementById("avsender");v&&(v.textContent=o||"stilling"),j&&(j.textContent=o||"stilling"),b&&(b.textContent=t)},[t,o]);p.useEffect(()=>{n(s.current)},[n]);const r=a=>{s.current=a,n(a)},c=`${T.internUrl}/template`;return e.jsx("iframe",{ref:s,title:"forhåndsvisning",className:"border-border-divider h-[30rem] max-h-full w-full rounded-lg border",onLoad:a=>r(a.currentTarget),src:c})};S.__docgenInfo={description:"",methods:[],displayName:"ForhåndsvisningAvEpost",props:{opprettetAvNavn:{required:!0,tsType:{name:"string"},description:""},stillingstittel:{required:!1,tsType:{name:"string"},description:""}}};const X=t=>`${K.internUrl}/veileder/kandidatlister/${t}/deltekandidater`,G=async t=>await _(X(t.kandidatlisteId),{epostMottakere:t.mailadresser,epostTekst:"",kandidater:t.kandidatnummerListe,navKontor:t.navKontor}),Q=({markerteKandidater:t,sidebar:o})=>{const{track:s}=H(),[n,r]=p.useState(!1),[c,a]=p.useState(!1),{valgtNavKontor:m}=L(),{stillingsData:v}=B(),{kandidatlisteId:j,reFetchKandidatliste:b,kandidatlisteRawData:I}=U(),N=P(v.stilling.uuid),E=v.stilling.contactList?.map(i=>i.email).filter(i=>i!==null&&i.trim()!=="")||[],[x,y]=p.useState(E),R=async i=>{s($.Stilling.del_kandidat_med_arbeidsgiver,{antall:i.length}),r(!0),await G({kandidatlisteId:j,kandidatnummerListe:i,mailadresser:x,navKontor:m?.navKontor??""}).then(()=>{r(!1),y([]),a(!1),b()})},M=i=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(i);return e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"text-nowrap",onClick:()=>a(!0),disabled:t.length===0,variant:o?"primary":"tertiary",icon:e.jsx(Z,{title:"Del med arbeidsgiver"}),children:"Del CV med arbeidsgiver"}),e.jsx(A,{className:"overflow-visible",width:"medium",open:c,onClose:()=>a(!1),"aria-label":"Del kandidater med arbeidsgiver",header:{heading:"Del med arbeidsgiver"},children:e.jsx(V,{hooks:[N],children:i=>{const u=t.filter(l=>{const g=(l.aktørid&&i[l.aktørid])??null;return(g?g?.some(k=>k.svar?.harSvartJa===!0):null)?l:null}),O=u.length===t.length;return e.jsxs(e.Fragment,{children:[e.jsxs(A.Body,{className:"overflow-visible",children:[!O&&e.jsx(J,{variant:"warning",size:"small",className:"mb-4",children:e.jsxs(D,{children:[u.length===0?"Kandidaten(e) ":`${t.length-u.length} av kandidatene har `,"har ikke svart eller svart nei på om CV-en kan deles."]})}),e.jsx(h,{size:"small",headingSize:"xsmall",className:"my-4",children:e.jsxs(h.Item,{children:[e.jsx(h.Header,{children:"Vis kandidater"}),e.jsx(h.Content,{children:e.jsxs(d,{size:"small",children:[e.jsx(d.Header,{children:e.jsxs(d.Row,{children:[e.jsx(d.HeaderCell,{scope:"col",children:"Navn"}),e.jsx(d.HeaderCell,{scope:"col",children:"Fødselsnr."}),e.jsx(d.HeaderCell,{scope:"col",children:"Kan deles"})]})}),e.jsx(d.Body,{children:t?.map(({fornavn:l,etternavn:g,fodselsnr:f},k)=>e.jsxs(d.Row,{children:[e.jsxs(d.HeaderCell,{scope:"row",children:[l," ",g]}),e.jsx(d.DataCell,{children:f}),e.jsx(d.DataCell,{children:f&&u.some(z=>z.fodselsnr===f)?"Ja":"Nei"})]},k))})]})})]})}),e.jsx(D,{children:"Send en e-post med kandidater med arbeidsgiveren."}),e.jsx(q,{className:"my-4 ",allowNewValues:!0,label:"E-post til arbeidsgiver",options:E,selectedOptions:x,shouldAutocomplete:!1,isMultiSelect:!0,onToggleSelected:(l,g)=>{g?M(l)&&y([...x,l]):y(x.filter(f=>f!==l))}}),e.jsx(h,{children:e.jsxs(h.Item,{children:[e.jsx(h.Header,{children:"Forhåndsvis e-posten"}),e.jsx(h.Content,{children:e.jsx(S,{stillingstittel:v.stilling.title,opprettetAvNavn:I.opprettetAv.navn})})]})})]}),e.jsxs(A.Footer,{children:[e.jsx(C,{variant:"secondary",onClick:()=>a(!1),children:"Avbryt"}),e.jsx(C,{loading:n,disabled:u.length===0||x.length===0,variant:"primary",onClick:()=>R(u.map(l=>l.kandidatnr).filter(l=>l!==null)),children:"Del kandidatene"})]})]})}})})]})};Q.__docgenInfo={description:"",methods:[],displayName:"DelMedArbeidsgiver",props:{markerteKandidater:{required:!0,tsType:{name:"Array",elements:[{name:"z.infer",elements:[{name:"kandidaterSchema"}],raw:"z.infer<typeof kandidaterSchema>"}],raw:"KandidatListeKandidatDTO[]"},description:""},sidebar:{required:!1,tsType:{name:"boolean"},description:""}}};export{Q as D,S as F};
