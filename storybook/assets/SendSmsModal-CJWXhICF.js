import{u as L,J as E,aD as R,r as u,c_ as U,c$ as q,d0 as t,cH as N,d1 as O,j as e,E as _,L as w,B as f,d as i,x as $}from"./iframe-BvvhrRbe.js";import{P as G,a as W,b as Q,c as X,d as Y}from"./PopoverModal-3DI-BAkb.js";import{U as Z}from"./umamiEvents-DmzFNrn7.js";import{S as ee}from"./Select-D_MUwqYC.js";import{S as D}from"./ArrowForward-CZ8ItM9B.js";import{B as se}from"./Box-BxC7AYwR.js";import{M as v}from"./Modal-ezHDj648.js";import{A as m}from"./Accordion-Bm6VuLIF.js";import{T as l}from"./Table-5TQi-oL7.js";const ne="_sendSmsModal_1o7hh_1",le="_velgMal_1o7hh_5",ae="_kontortidAdvarsel_1o7hh_18",S={sendSmsModal:ne,velgMal:le,kontortidAdvarsel:ae},te=r=>{const{visVarsel:a}=L(),{fjernAllMarkering:F,markerteKandidater:n}=r,{track:T}=E(),{stillingsData:g}=R(),h=g?.stillingsinfo?.stillingskategori,K=g.stilling.uuid,[z,d]=u.useState(!1),{data:b={}}=U(h==="FORMIDLING"?null:g.stilling.uuid),H=q(),[j,y]=u.useState(!1),o=n.filter(s=>s.fodselsnr&&b[s.fodselsnr]),c=n.filter(s=>!(s.fodselsnr&&b[s.fodselsnr])),I=n.some(s=>s.fodselsnr===null),[M,B]=u.useState(h===N.Jobbmesse?t.Jobbarrangement:t.VurdertSomAktuell),{data:C}=O(),k=n.map(s=>s.fodselsnr),x=async()=>{if(y(!0),k.length===0){a({tekst:"Ingen kandidater valgt",type:"warning"});return}try{await H({mal:M,fnr:k.filter(s=>s!==null),stillingId:K}),T(Z.Stilling.send_beskjed_til_kandidat,{antall:k.length}),a({tekst:"Beskjed er sendt",type:"success"}),F(),d(!1)}catch(s){new $({message:"Klarte ikke å sende SMS:",error:s}),a({tekst:s instanceof Error?`Feil ved sending: ${s.message}`:"Det skjedde en uventet feil ved sending av beskjed",type:"error"})}finally{y(!1)}},p=e.jsxs("div",{className:"send-sms-modal__innhold",children:[e.jsx(_,{variant:"info",className:S.kontortidAdvarsel,children:e.jsx(w,{size:"small",children:"SMS sendes ut mellom 09:00 og 17:15 hver dag. Det kan oppstå forsinkelser."})}),h!==N.Jobbmesse&&e.jsxs(ee,{className:S.velgMal,label:"Velg hva som skal vises i beskjeden",onChange:s=>{B(s.target.value)},children:[e.jsx("option",{value:t.VurdertSomAktuell,children:"Send stilling til en aktuell kandidat"}),e.jsx("option",{value:t.FunnetPassendeStilling,children:"Oppfordre kandidat til å søke på stilling"})]}),e.jsx(w,{htmlFor:"forhåndsvisning",children:"Meldingen som vil bli sendt til kandidatene"}),e.jsx("div",{id:"forhåndsvisning",className:"p-4",children:e.jsx(f,{children:e.jsxs("span",{children:[C?re(M,C):"Klarte ikke å hente meldingsmaler"," "]})})})]});return r.popover?e.jsxs(e.Fragment,{children:[e.jsx(G,{tittel:"Del stilling",åpneKnapp:e.jsx(i,{disabled:n.length===0,onClick:()=>d(!0),size:"small",variant:"secondary",icon:e.jsx(D,{title:"Del stilling"}),children:"Del stillingen"}),children:e.jsxs(e.Fragment,{children:[p,e.jsx("div",{className:"flex justify-end",children:e.jsx(i,{disabled:o.length===n.length||c.length===0,variant:"primary",loading:j,onClick:x,children:"Send beskjed"})})]})}),e.jsxs(W,{children:[e.jsx(Q,{}),e.jsx(X,{className:"z-999",side:"bottom",align:"start",children:e.jsxs(se.New,{background:"raised",borderRadius:"12",padding:"5",shadow:"dialog",borderColor:"neutral-subtle",borderWidth:"1",children:[e.jsx("div",{className:"flex justify-between",children:e.jsx(Y,{children:"asd"})}),p,e.jsx("div",{className:"flex justify-end",children:e.jsx(i,{disabled:o.length===n.length||c.length===0,variant:"primary",loading:j,onClick:x,children:"Send beskjed"})})]})})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(i,{className:"text-nowrap",disabled:n.length===0,onClick:()=>d(!0),size:"small",variant:"secondary",icon:e.jsx(D,{title:"Del stilling"}),children:"Del stillingen"}),e.jsxs(v,{open:z,className:S.sendSmsModal,onClose:()=>d(!1),"aria-label":`Del stillingen med ${n.length} kandidater`,header:{heading:"Del stillingen"},children:[e.jsxs(v.Body,{children:[(o.length>0||I)&&e.jsx(_,{variant:"warning",size:"small",className:"my-4",children:"Ikke alle kandidatene vil motta beskjeden"}),e.jsxs(f,{children:["Det vil bli sendt beskjed til"," ",e.jsx("b",{children:c.length})," ",c.length===1?"kandidat":"kandidater"]}),e.jsx(f,{size:"small",children:"Telefonnummerene/e-postene blir hentet fra Kontakt- og reservasjonsregisteret."}),e.jsx(m,{size:"small",headingSize:"xsmall",className:"my-4",children:e.jsxs(m.Item,{children:[e.jsx(m.Header,{children:"Vis kandidater"}),e.jsx(m.Content,{children:e.jsxs(l,{size:"small",children:[e.jsx(l.Header,{children:e.jsxs(l.Row,{children:[e.jsx(l.HeaderCell,{scope:"col",children:"Navn"}),e.jsx(l.HeaderCell,{scope:"col",children:"Fødselsnr."}),e.jsx(l.HeaderCell,{scope:"col",children:"Kan sende beskjed"})]})}),e.jsx(l.Body,{children:n?.map(({fornavn:s,etternavn:P,fodselsnr:A},V)=>e.jsxs(l.Row,{children:[e.jsxs(l.HeaderCell,{scope:"row",children:[s," ",P]}),e.jsx(l.DataCell,{children:A}),e.jsx(l.DataCell,{children:o.some(J=>J.fodselsnr===A)?"Nei":"Ja"})]},V))})]})})]})}),p]}),e.jsxs(v.Footer,{children:[e.jsx(i,{disabled:o.length===n.length||c.length===0,variant:"primary",loading:j,onClick:x,children:"Send beskjed"}),e.jsx(i,{variant:"secondary",onClick:()=>d(!1),children:"Avbryt"})]})]})]})},re=(r,a)=>{if(r===t.VurdertSomAktuell)return a.vurdertSomAktuell?.smsTekst;if(r===t.FunnetPassendeStilling)return a.passendeStilling?.smsTekst;if(r===t.Jobbarrangement)return a.passendeJobbarrangement?.smsTekst};te.__docgenInfo={description:"",methods:[],displayName:"SendSmsModal",props:{markerteKandidater:{required:!0,tsType:{name:"Array",elements:[{name:"z.infer",elements:[{name:"kandidaterSchema"}],raw:"z.infer<typeof kandidaterSchema>"}],raw:"KandidatListeKandidatDTO[]"},description:""},fjernAllMarkering:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},popover:{required:!1,tsType:{name:"boolean"},description:""}}};export{te as S};
