import{G as ve,t as L,aL as we,aM as Y,r as o,j as y,B as Z,C as H,b0 as ee,bD as _,b2 as qe,H as te,I as J}from"./iframe-BI-wOhDW.js";import{b as ne}from"./useAutosave-BjNijknp.js";import{i as K,k as R}from"./utils-ChKo3S0S.js";import{p as re}from"./parseISO-C8NqvTw9.js";import{f as se,m as Ce}from"./format-C4wZl0k7.js";import{C as xe}from"./ComboboxProvider-5Y_VYv9c.js";import{i as B}from"./isSameDay-B39JjFTS.js";import{u as Se,D as Q}from"./useDatepicker-D_W3WPtJ.js";import"./Date.Input-DYRBxtfE.js";function Ie(e,i,s){return ve(e,+L(e)+i)}function Ee(e,i,s){return Ie(e,i*we)}function je(e,i,s){const n=L(e,s?.in);return n.setTime(n.getTime()+i*Y),n}function Re(e){return i=>{const n=(e?Math[e]:Math.trunc)(i);return n===0?0:n}}function Me(e,i){return+L(e)-+L(i)}function Ne(e,i,s){const n=Me(e,i)/Y;return Re(s?.roundingMethod)(n)}const z=[0,30],j=Array.from({length:24},(e,i)=>z.map(s=>`${String(i).padStart(2,"0")}:${String(s).padStart(2,"0")}`)).flat(),Oe=/^([01]\d|2[0-3]):([0-5]\d)$/,Be=e=>{const i=e.match(/^(\d{1,2})(?::?(\d{0,2}))?$/);if(!i)return null;const s=Math.min(parseInt(i[1]||"0",10)||0,23),n=parseInt(i[2]||"0",10)||0,c=z.reduce((l,u)=>Math.abs(u-n)<Math.abs(l-n)?u:l,z[0]);return`${String(s).padStart(2,"0")}:${String(c).padStart(2,"0")}`};function ae({value:e,onChange:i,onBlur:s,label:n="Klokkeslett",hideLabel:c,disabled:l,error:u,className:f,options:m,maxTime:d}){const p=o.useRef(null),k=o.useRef(!1),h=o.useRef(!1),g=o.useMemo(()=>{const t=m??j;return d?t.filter(a=>a<=d):t},[m,d]),[r,T]=o.useState(e??""),[I,C]=o.useState(!1),v=o.useRef(!1),$=o.useRef(e),x=o.useRef(!1),E=o.useRef(!1),S=o.useCallback(t=>Oe.test(t)&&(!d||t<=d),[d]),F=o.useCallback(t=>!t||/^[\d:]*$/.test(t),[]),ue=o.useCallback((t,a)=>d&&a>d||t.includes(a)?t:[...t,a].sort(),[d]),V=e&&S(e)?ue(g,e):g,M=o.useMemo(()=>V,[V]),U=()=>{const t=p.current;if(!t||typeof document>"u")return null;const a=t.getAttribute("aria-controls");return a?document.getElementById(a):null},de=o.useCallback(()=>{if(k.current)return;const t=p.current;if(!t||t.getAttribute("aria-expanded")!=="true")return;const a=U();if(!a)return;let D=a.querySelector("[role='option'][aria-selected='true']");if(!D&&e&&(D=Array.from(a.querySelectorAll("[role='option']")).find(b=>b.textContent?.trim()===e)||null),!D)return;const q=D.closest("[role='listbox']")||D.parentElement;if(q){const b=D.offsetTop,O=b+D.offsetHeight,X=q.scrollTop,ke=X+q.clientHeight;if(b<X+4){q.scrollTop=Math.max(b-4,0);return}if(O>ke-4){const be=Math.max(b-4,0);q.scrollTop=be}}},[e]),A=o.useCallback(()=>{},[de]),N=o.useCallback(t=>{const a=t.trim();return a===""?(v.current?e&&i(""):T(e??""),!0):S(a)?(a!==e&&i(a),!0):(T(e??""),!1)},[S,i,e]),ce=o.useCallback(t=>{if(x.current&&t===""){x.current=!1;return}!v.current&&t!==""&&(v.current=!0),!(t===""&&!v.current)&&(T(t===""?"":t),t!==""&&C(!0))},[]),fe=o.useCallback(t=>{const a=t.relatedTarget,D=U(),q=h.current;if(h.current=!1,!q&&(E.current||(a&&D?D.contains(a):!1))){E.current=!1,s?.(t);return}if(E.current=!1,!v.current&&(r===""||r===$.current)){T(e??""),s?.(t);return}N(r),C(!0),s?.(t)},[N,r,s,e]),G=o.useCallback((t,a)=>{const D=V;let w=(b=>b&&S(b)?D.indexOf(b):-1)(t);if(w===-1){const b=Be(r);w=b?D.indexOf(b):-1}if(w===-1){const b=r||e||"",O=D.indexOf(b);w=O>=0?O:0}return D[(w+a+D.length)%D.length]},[V,S,r,e]),W=o.useCallback((t,a)=>{const D=G(t,a);v.current=!0,x.current=!0,T(D)},[G]),me=o.useCallback(t=>{const a=t.key;if(a==="ArrowDown"||a==="ArrowUp"){t.preventDefault(),t.stopPropagation(),W(r||e,a==="ArrowDown"?1:-1);return}if(a==="Enter"){x.current=!0,!N(r??"")&&e&&T(e),C(!0);return}if(a==="Tab"){h.current=!0,x.current=!0,!N(r??"")&&e&&T(e),C(!0);return}},[N,r,W,e]),pe=o.useCallback(t=>{const a=t.nativeEvent,D="data"in a?a.data:null;F(D)||t.preventDefault()},[F]),ge=o.useCallback(t=>{const a=t.clipboardData.getData("text");F(a)||t.preventDefault()},[F]),Te=o.useCallback(t=>{const a=t.target,D=a.tagName==="INPUT",q=a.getAttribute("role")==="option"||!!a.closest("[role='option']"),w=!!a.closest("[role='listbox']");(q||w)&&(E.current=!0),w&&(k.current=!0),D||q||w||(p.current?.focus(),t.preventDefault(),x.current=!0)},[]),De=o.useCallback(()=>{k.current=!1,v.current=!1,$.current=e,C(!1),x.current=!0,E.current=!1,h.current=!1,A()},[A,e]);o.useEffect(()=>T(e??""),[e]),o.useEffect(()=>{const t=p.current;if(!t)return;const a=new MutationObserver(()=>{t.getAttribute("aria-expanded")==="true"&&A()});return a.observe(t,{attributes:!0,attributeFilter:["aria-expanded"]}),()=>a.disconnect()},[A]);const ye=o.useMemo(()=>{const t=r&&S(r)&&M.includes(r)?r:e&&S(e)&&M.includes(e)?e:void 0;return t?[t]:[]},[r,e,S,M]),he=`${f??"w-[7rem]"} focus-within:outline-none focus-visible:outline-none focus-within:ring-0 focus-visible:ring-0`;return y.jsx(xe,{ref:p,label:n,hideLabel:c,disabled:l,error:u,className:he,options:M,filteredOptions:M,allowNewValues:!0,toggleListButton:!0,isListOpen:I?!1:void 0,value:r,inputClassName:"min-w-0",shouldShowSelectedOptions:!1,selectedOptions:ye,onMouseDownCapture:Te,onFocus:De,onToggleSelected:(t,a)=>{a&&(x.current=!0,E.current=!1,T(t),$.current=t,v.current=!1,i(t),C(!0))},onChange:ce,onBlur:fe,onKeyDownCapture:me,onBeforeInput:pe,onPaste:ge})}ae.__docgenInfo={description:"",methods:[],displayName:"TimeInput",props:{value:{required:!1,tsType:{name:"string"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},onBlur:{required:!1,tsType:{name:"ReactFocusEventHandler",raw:"React.FocusEventHandler<HTMLInputElement>",elements:[{name:"HTMLInputElement"}]},description:""},label:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"'Klokkeslett'",computed:!1}},hideLabel:{required:!1,tsType:{name:"boolean"},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:""},error:{required:!1,tsType:{name:"union",raw:"ReactNode | boolean",elements:[{name:"ReactNode"},{name:"boolean"}]},description:""},className:{required:!1,tsType:{name:"string"},description:""},options:{required:!1,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""},maxTime:{required:!1,tsType:{name:"string"},description:""}}};function ie(e,i,s,n=15){return o.useMemo(()=>{const c=e??null,l=i??null,u=s??null;if(!c||!l||!K(u)||!B(c,l))return j;const f=R(l,u);if(!f)return j;const m=je(f,n);if(!B(f,m))return n>0?[]:j;const d=m.getTime(),p=n>0;return j.filter(h=>{const g=R(c,h);return g?p?g.getTime()>=d:g.getTime()<=d:!1})},[e,i,s,n])}function oe(e,i){const s=o.useRef(null);return o.useEffect(()=>()=>{s.current&&clearTimeout(s.current)},[]),{scheduleSave:o.useCallback(()=>{s.current&&clearTimeout(s.current),s.current=window.setTimeout(()=>{s.current=null,e(i)},0)},[e,i])}}function le({label:e,value:i,onChange:s,onBlur:n,error:c,from:l=new Date,to:u=new Date("2040-12-31"),disabled:f}){const{inputProps:m,datepickerProps:d,selectedDay:p,setSelected:k}=Se({defaultSelected:i??void 0,fromDate:l,toDate:u,onDateChange:r=>s(r??null)}),h=o.useCallback(r=>!r||/^[\d./-]*$/.test(r),[]);o.useEffect(()=>{const r=i??void 0,T=p??void 0;(r&&(!T||T.getTime()!==r.getTime())||!r&&T)&&k(r)},[i,p,k]);const g=r=>{m.onBlur?.(r),n?.()};return y.jsx(Q,{mode:"single",...d,children:y.jsx(Q.Input,{...m,hideLabel:!0,label:e,error:c?c.message||!0:void 0,disabled:f,onBlur:g,onBeforeInput:r=>{const T=r.nativeEvent,I="data"in T?T.data:null;if(!h(I)){r.preventDefault();return}m.onBeforeInput?.(r)},onPaste:r=>{const T=r.clipboardData.getData("text");if(!h(T)){r.preventDefault();return}m.onPaste?.(r)},placeholder:"dd.mm.책책책책"})})}le.__docgenInfo={description:"",methods:[],displayName:"ControlledDatePicker",props:{label:{required:!0,tsType:{name:"string"},description:""},value:{required:!0,tsType:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}]},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(d: Date | null) => void",signature:{arguments:[{type:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}]},name:"d"}],return:{name:"void"}}},description:""},onBlur:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},error:{required:!1,tsType:{name:"FieldError"},description:""},from:{required:!1,tsType:{name:"Date"},description:"",defaultValue:{value:"new Date()",computed:!1}},to:{required:!1,tsType:{name:"Date"},description:"",defaultValue:{value:"new Date('2040-12-31')",computed:!1}},disabled:{required:!1,tsType:{name:"boolean"},description:""}}};function P({label:e,nameDato:i,nameTid:s,control:n,disabledDato:c,disabledTid:l,hideDato:u,dateFrom:f,dateTo:m,timeOptions:d,onDatoBlur:p,onTidBlur:k,timeMax:h}){return y.jsxs("div",{className:"flex gap-4 items-start",children:[e&&y.jsx("div",{className:"flex items-center min-w-fit mt-3",children:y.jsx(Z,{size:"small",children:e})}),!u&&y.jsx(H,{name:i,control:n,rules:{required:"Dato er obligatorisk"},render:({field:g,fieldState:r})=>y.jsx(le,{label:e??"",value:g.value,onChange:T=>g.onChange(T),onBlur:()=>{g.onBlur(),p?.()},error:r.error,disabled:c,from:f,to:m})}),u&&y.jsx(H,{name:i,control:n,render:({field:g})=>{const r=g.value;return y.jsx("input",{type:"hidden",value:r instanceof Date?r.toISOString():"",onChange:()=>{}})}}),y.jsx(H,{name:s,control:n,rules:{required:"Tid er obligatorisk"},render:({field:g,fieldState:r})=>{const T=typeof g.value=="string"?g.value:"";return y.jsx(ae,{value:T,onChange:g.onChange,label:"Klokkeslett",hideLabel:!0,error:r.error?.message,disabled:l,onBlur:()=>{g.onBlur(),k?.()},className:"w-24",options:d??j,maxTime:h})}})]})}P.__docgenInfo={description:"",methods:[],displayName:"DatoTidRad",props:{label:{required:!1,tsType:{name:"string"},description:""},nameDato:{required:!0,tsType:{name:"Path",elements:[{name:"T"}],raw:"Path<T>"},description:""},nameTid:{required:!0,tsType:{name:"Path",elements:[{name:"T"}],raw:"Path<T>"},description:""},control:{required:!0,tsType:{name:"Control",elements:[{name:"T"}],raw:"Control<T>"},description:""},disabledDato:{required:!1,tsType:{name:"boolean"},description:""},disabledTid:{required:!1,tsType:{name:"boolean"},description:""},hideDato:{required:!1,tsType:{name:"boolean"},description:""},dateFrom:{required:!1,tsType:{name:"Date"},description:""},dateTo:{required:!1,tsType:{name:"Date"},description:""},timeOptions:{required:!1,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""},onDatoBlur:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onTidBlur:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},timeMax:{required:!1,tsType:{name:"string"},description:""}}};const Fe=e=>e?re(e):null,Ve=e=>e?se(re(e),"HH:mm"):"",Ae=({control:e})=>{const{autosave:i}=ne(),{setValue:s}=ee(),[n,c]=_({control:e,name:["svarfristDato","svarfristTid"]}),[l,u]=_({control:e,name:["fraDato","fraTid"]}),{treff:f}=qe(),{scheduleSave:m}=oe(i,["fraDato","fraTid","tilDato","tilTid","svarfristDato","svarfristTid"]),d=ie(n,l,u,0);return o.useEffect(()=>{f&&(!n&&f.svarfrist&&s("svarfristDato",Fe(f.svarfrist),{shouldValidate:!1,shouldDirty:!1}),!c&&f.svarfrist&&s("svarfristTid",Ve(f.svarfrist),{shouldValidate:!1,shouldDirty:!1}))},[f,n,c,s]),o.useEffect(()=>{if(!l||!K(u))return;const p=R(l??null,u??null),k=R(n??null,c??null);!p||!k||k.getTime()>p.getTime()&&(s("svarfristDato",new Date(l),{shouldDirty:!0,shouldValidate:!1}),s("svarfristTid",u,{shouldDirty:!0,shouldValidate:!1}),m())},[l,u,n,c,s,m]),y.jsxs("div",{className:"space-y-4",children:[y.jsx(te,{level:"3",size:"small",children:"Svarfrist"}),y.jsx("div",{children:y.jsx(P,{nameDato:"svarfristDato",nameTid:"svarfristTid",control:e,dateTo:l??void 0,timeOptions:d,onDatoBlur:m,onTidBlur:m})})]})};Ae.__docgenInfo={description:"",methods:[],displayName:"SvarfristForm",props:{control:{required:!0,tsType:{name:"Control",elements:[{name:"signature",type:"object",raw:`{
  tittel?: string;
  gateadresse?: string | null;
  postnummer?: string | null;
  poststed?: string | null;
  fraDato?: Date | null;
  fraTid?: string;
  tilDato?: Date | null;
  tilTid?: string;
  svarfristDato?: Date | null;
  svarfristTid?: string;
}`,signature:{properties:[{key:"tittel",value:{name:"string",required:!1}},{key:"gateadresse",value:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}],required:!1}},{key:"postnummer",value:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}],required:!1}},{key:"poststed",value:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}],required:!1}},{key:"fraDato",value:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}],required:!1}},{key:"fraTid",value:{name:"string",required:!1}},{key:"tilDato",value:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}],required:!1}},{key:"tilTid",value:{name:"string",required:!1}},{key:"svarfristDato",value:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}],required:!1}},{key:"svarfristTid",value:{name:"string",required:!1}}]}}],raw:"Control<RekrutteringstreffFormValues>"},description:""}}};function Le(e,i,s=1){return{adjustEndTime:o.useCallback((c,l,u,f,m,d)=>{if(!c||!K(l))return!1;const p=R(c,l);if(!p)return!1;const h=R(u??c,f),g=s>0;if(h?g?h.getTime()>p.getTime():h.getTime()<p.getTime():!1)return!1;const T=Ee(p,s),I=J(T),C=se(T,"HH:mm");let v=!1;return(!u||J(u).getTime()!==I.getTime())&&(e(m,I,{shouldDirty:!0,shouldValidate:!1}),v=!0),f!==C&&(e(d,C,{shouldDirty:!0,shouldValidate:!1}),v=!0),v&&i(),v},[e,i,s])}}const Pe=(e,i,s,n)=>{if(!e||!s)return"";const c=(f,m)=>{const[d,p]=m.split(":").map(Number),k=new Date(f);return k.setHours(d,p,0,0),k},l=c(e,i),u=c(s,n);if(B(l,u)){const f=Ne(u,l);if(f===0)return"0 minutt";const m=Math.abs(f),d=Math.floor(m/60),p=m%60,k=f<0?"-":"",h=[];return d>0&&h.push(`${d} time${d>1?"r":""}`),p>0&&h.push(`${p} minutt`),`${k}${h.join(" ")}`}else{const f=Ce(u,l),m=f>=0?f+1:f;return`${m} dag${Math.abs(m)!==1?"er":""}`}},$e=({control:e})=>{const{setValue:i}=ee(),{autosave:s}=ne(),[n,c,l,u]=_({control:e,name:["fraDato","fraTid","tilDato","tilTid"]}),[f,m]=o.useState(n&&l?!B(n,l):!1),{scheduleSave:d}=oe(s,["fraDato","fraTid","tilDato","tilTid","svarfristDato","svarfristTid"]),{adjustEndTime:p}=Le(i,d,1),k=ie(l??n,n,c,1);o.useEffect(()=>{const g=n&&l?!B(n,l):!1;m(r=>r===g?r:g)},[n,l]),o.useEffect(()=>{p(n,c,l,u,"tilDato","tilTid")},[n,c,l,u,p]);const h=o.useMemo(()=>!n||!c||!u?"":Pe(n,c,l??n,u),[n,c,l,u]);return y.jsxs("div",{className:"space-y-4",children:[y.jsx("div",{className:"flex justify-between items-center",children:y.jsx(te,{level:"3",size:"small",children:"Tid"})}),y.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[y.jsx(P,{nameDato:"fraDato",nameTid:"fraTid",control:e,onDatoBlur:d,onTidBlur:d,timeMax:"22:59"}),y.jsx(P,{label:"Til",nameDato:"tilDato",nameTid:"tilTid",control:e,hideDato:!f,dateFrom:n??void 0,timeOptions:k,onDatoBlur:d,onTidBlur:d}),y.jsx(Z,{size:"small",className:"mt-3",children:h||"Velg tid"})]})]})};$e.__docgenInfo={description:"",methods:[],displayName:"TidspunktForm",props:{control:{required:!0,tsType:{name:"Control",elements:[{name:"signature",type:"object",raw:`{
  tittel?: string;
  gateadresse?: string | null;
  postnummer?: string | null;
  poststed?: string | null;
  fraDato?: Date | null;
  fraTid?: string;
  tilDato?: Date | null;
  tilTid?: string;
  svarfristDato?: Date | null;
  svarfristTid?: string;
}`,signature:{properties:[{key:"tittel",value:{name:"string",required:!1}},{key:"gateadresse",value:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}],required:!1}},{key:"postnummer",value:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}],required:!1}},{key:"poststed",value:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}],required:!1}},{key:"fraDato",value:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}],required:!1}},{key:"fraTid",value:{name:"string",required:!1}},{key:"tilDato",value:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}],required:!1}},{key:"tilTid",value:{name:"string",required:!1}},{key:"svarfristDato",value:{name:"union",raw:"Date | null",elements:[{name:"Date"},{name:"null"}],required:!1}},{key:"svarfristTid",value:{name:"string",required:!1}}]}}],raw:"Control<RekrutteringstreffFormValues>"},description:""}}};export{Ae as S,$e as T};
