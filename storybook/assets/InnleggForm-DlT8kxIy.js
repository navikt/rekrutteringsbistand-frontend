import{b5 as A,bJ as L,b7 as N,bH as D,r as l,bK as V,j as e,L as B,B as H,C as P,h as _}from"./iframe-BHAALu18.js";import{K as q}from"./KiAnalyse-CU1vpk53.js";import{K as W}from"./KiAnalysePanel-5IznABe0.js";import{u as z}from"./useAutosave-fSC6ZWw4.js";import{u as J}from"./useKiAnalyse-CZyYTdZW.js";import{R as M}from"./RikTekstEditor-BcKc3PNA.js";import{S as O}from"./Skeleton-CosXwY2i.js";const g="rediger-innlegg-htmlcontent-form",m=({onUpdated:d})=>{const{rekrutteringstreffId:a}=A(),{data:c,isLoading:o}=L(a),n=c?.[0],u=n?n.htmlContent??null:void 0,{control:i,setValue:r,getValues:h,trigger:f,formState:{isDirty:v}}=N(),{save:y}=z(),{setLagret:p}=D(a,"innlegg"),[k,x]=l.useState(Date.now()),C=V({control:i,name:"htmlContent"});l.useEffect(()=>{const t=n?.htmlContent??"";r("htmlContent",t,{shouldDirty:!1,shouldTouch:!1,shouldValidate:!1}),x(Date.now())},[r,n?.htmlContent]);const b=async t=>{try{await y(["htmlContent"],t)}catch(s){new _({message:"Lagring av innlegg feilet.",error:s})}finally{d?.()}},{analyse:j,analyseError:F,validating:K,kiErrorBorder:E,forceSave:S,showAnalysis:I,erRedigeringAvPublisertTreff:R,runValidationAndMaybeSave:T,onForceSave:w}=J({feltType:"innlegg",fieldName:"htmlContent",watchedValue:C,triggerRHF:f,getValues:h,setValue:r,setKiFeilFieldName:"innleggKiFeil",saveCallback:b,setKiLagret:p,requireHasCheckedToShow:!0,setKiSjekketFieldName:"innleggKiSjekket",savedValue:u});return e.jsxs("section",{className:"space-y-3",children:[o&&e.jsx(O,{variant:"text"}),!o&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:g,children:n?"Endre innlegg":"Skriv nytt innlegg"}),e.jsx(H,{size:"small",textColor:"subtle",children:"Fortell jobbsøkeren om treffet: de unike fordelene, mulighetene, og oppgavene som de vil møte. For eksempel arbeidsgivere, forventninger, læring- og karrieremuligheter."})]}),e.jsx("div",{className:`border rounded-lg ${E?"border-red-500":"border-gray-300"}`,onBlur:t=>{const s=t.currentTarget;setTimeout(async()=>{s.contains(document.activeElement)||v&&await T()},0)},children:e.jsx(P,{name:"htmlContent",control:i,render:({field:t})=>e.jsx(M,{id:g,tekst:t.value??"",onChange:t.onChange},k)})}),e.jsx(q,{}),e.jsx(W,{validating:K,analyse:j,analyseError:F,forceSave:S,showAnalysis:I,erRedigeringAvPublisertTreff:R,onForceSave:w,ariaLabel:"Analyse av innlegg"})]})]})};m.displayName="InnleggForm";m.__docgenInfo={description:"",methods:[],displayName:"InnleggForm",props:{onUpdated:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{m as I};
