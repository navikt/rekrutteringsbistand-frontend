import{j as e,H as P,B as T,r as a,an as C,d as A,bb as E,A as B,b3 as I,b4 as _,b9 as H,bc as N,i as R,S as L,ba as $}from"./iframe-B2tryd13.js";import{e as V}from"./util-BbPUv3M_.js";import{c as W}from"./stilling-util-BjBixF7p.js";import{B as D}from"./Box-CBaDthZZ.js";import{T as K}from"./Tag-Co9kyAHI.js";import{S as J}from"./Trash-C5oGf-Fb.js";import{M as w}from"./Modal-LawZZxyM.js";import{C as X}from"./ComboboxProvider-BKPPBfik.js";import{H as G}from"./VStack-CpoSlYhk.js";const q=({navn:l,gateadresse:i,postnummer:o,poststed:d,status:m,organisasjonsnummer:u,actionSlot:p})=>{const c=`${i?i+", ":""}${o||""} ${d||""}`;return e.jsxs(D.New,{background:"neutral-softA",borderRadius:"xlarge",padding:"4",marginBlock:"2",className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(P,{level:"3",size:"xsmall",children:W(l||"")}),e.jsxs(T,{size:"small",className:"mt-1",children:[u&&e.jsxs(e.Fragment,{children:["Org.nr. ",u,c?"  ":""]}),c]})]}),e.jsxs("div",{className:"ml-2 flex items-center gap-2 self-start",children:[m&&e.jsx(K,{size:"medium",variant:"info",children:V(m)}),p]})]})};q.__docgenInfo={description:"",methods:[],displayName:"ArbeidsgiverKort",props:{organisasjonsnummer:{required:!0,tsType:{name:"string"},description:""},navn:{required:!0,tsType:{name:"string"},description:""},organisasjonsform:{required:!1,tsType:{name:"string"},description:""},antallAnsatte:{required:!1,tsType:{name:"number"},description:""},gateadresse:{required:!1,tsType:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}]},description:""},postnummer:{required:!1,tsType:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}]},description:""},poststed:{required:!1,tsType:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}]},description:""},status:{required:!1,tsType:{name:"string"},description:""},naringskoder:{required:!1,tsType:{name:"union",raw:"naringskode[] | null",elements:[{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  kode?: string;
  beskrivelse?: string;
}`,signature:{properties:[{key:"kode",value:{name:"string",required:!1}},{key:"beskrivelse",value:{name:"string",required:!1}}]}}],raw:"naringskode[]"},{name:"null"}]},description:""},actionSlot:{required:!1,tsType:{name:"ReactNode"},description:""}}};const F=({navn:l,loading:i,disabled:o,onConfirm:d,onCancel:m,onAfterClose:u,onOpen:p,arbeidsgivereHook:c,variant:f="trash",triggerLabel:n,triggerAriaLabel:v,renderTrigger:t})=>{const y=a.useRef(null),[b,h]=a.useState(null),j=a.useCallback(()=>{h("close")},[]),x=a.useCallback(()=>{o||i||(p?.(),h("open"))},[o,i,p]),S=a.useCallback(async()=>{await Promise.resolve(d()),c.mutate(),j()},[d,c,j]),s=a.useCallback(()=>{i||(m?.(),j())},[i,m,j]),r=a.useMemo(()=>f==="cross"?e.jsx(C,{"aria-hidden":!0}):e.jsx(J,{"aria-hidden":!0}),[f]),g=!!i||!!o;a.useEffect(()=>{if(!b)return;const k=y.current,O=setTimeout(()=>{if(!k){h(null);return}b==="open"?k.showModal():(k.close(),u?.()),h(null)},0);return()=>clearTimeout(O)},[b,u]);const M=a.useMemo(()=>{const k=f==="cross"?e.jsx(A,{size:"xsmall",variant:"tertiary",icon:r,onClick:x,"aria-label":v||n||"Fjern arbeidsgiver fra treffet",disabled:g}):e.jsx(A,{size:"small",variant:"tertiary",icon:r,onClick:x,disabled:g,children:n||"Slett"});return t?t({button:k,open:x,disabled:g}):k},[t,f,r,x,g,v,n]);return e.jsxs(e.Fragment,{children:[M,e.jsxs(w,{ref:y,header:{heading:"Slett arbeidsgiver"},children:[e.jsx(w.Body,{children:l&&e.jsxs(T,{children:["Er du sikker på at du vil slette ",l," fra dette rekrutteringstreffet?"]})}),e.jsxs(w.Footer,{children:[e.jsx(A,{variant:"danger",onClick:S,loading:!!i,disabled:!!i,children:"Slett"}),e.jsx(A,{variant:"secondary",onClick:s,disabled:!!i,children:"Avbryt"})]})]})]})};F.__docgenInfo={description:"",methods:[],displayName:"SlettArbeidsgiverModal",props:{navn:{required:!1,tsType:{name:"string"},description:""},loading:{required:!1,tsType:{name:"boolean"},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:""},onConfirm:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void | Promise<void>",signature:{arguments:[],return:{name:"union",raw:"void | Promise<void>",elements:[{name:"void"},{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}]}}},description:""},onCancel:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onAfterClose:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onOpen:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},arbeidsgivereHook:{required:!0,tsType:{name:"Pick",elements:[{name:"SWRResponse",elements:[{name:"z.infer",elements:[{name:"ArbeidsgivereSchema"}],raw:"z.infer<typeof ArbeidsgivereSchema>"}],raw:"SWRResponse<ArbeidsgivereDTO>"},{name:"literal",value:"'mutate'"}],raw:"Pick<SWRResponse<ArbeidsgivereDTO>, 'mutate'>"},description:""},variant:{required:!1,tsType:{name:"union",raw:"'trash' | 'cross'",elements:[{name:"literal",value:"'trash'"},{name:"literal",value:"'cross'"}]},description:"",defaultValue:{value:"'trash'",computed:!1}},triggerLabel:{required:!1,tsType:{name:"string"},description:""},triggerAriaLabel:{required:!1,tsType:{name:"string"},description:""},renderTrigger:{required:!1,tsType:{name:"signature",type:"function",raw:`(args: {
  button: ReactNode;
  open: () => void;
  disabled: boolean;
}) => ReactNode`,signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  button: ReactNode;
  open: () => void;
  disabled: boolean;
}`,signature:{properties:[{key:"button",value:{name:"ReactNode",required:!0}},{key:"open",value:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}},required:!0}},{key:"disabled",value:{name:"boolean",required:!0}}]}},name:"args"}],return:{name:"ReactNode"}}},description:""}}};const z=({arbeidsgiverCallback:l,valgtArbeidsgiver:i,labelText:o,placeholder:d})=>{const[m,u]=a.useState(""),{isLoading:p,error:c,data:f}=E(m),[n,v]=a.useState(i??null);return a.useEffect(()=>{n&&l(n)},[n,l]),e.jsxs(a.Fragment,{children:[e.jsx("div",{role:"search",children:e.jsx(X,{isLoading:p,label:o??"Arbeidsgivers navn eller organisasjonsnummer",options:f?.map(t=>`${t.navn} - ${t.organisasjonsnummer}`)??[],shouldAutocomplete:!0,toggleListButton:!1,onChange:t=>u(t),onToggleSelected:t=>{const y=t.split(" - ").at(-1),b=f?.find(h=>h.organisasjonsnummer===y);b&&v(b)},placeholder:d,shouldShowSelectedOptions:!1})}),c&&e.jsx(B,{className:"mt-8",variant:"error",children:JSON.stringify(c)})]})};z.__docgenInfo={description:"",methods:[],displayName:"VelgArbeidsgiver",props:{children:{required:!1,tsType:{name:"union",raw:"ReactNode | undefined",elements:[{name:"ReactNode"},{name:"undefined"}]},description:""},arbeidsgiverCallback:{required:!0,tsType:{name:"signature",type:"function",raw:"(arbeidsgiver: ArbeidsgiverDTO) => void",signature:{arguments:[{type:{name:"z.infer",elements:[{name:"ArbeidsgiverSchema"}],raw:"z.infer<typeof ArbeidsgiverSchema>"},name:"arbeidsgiver"}],return:{name:"void"}}},description:""},valgtArbeidsgiver:{required:!1,tsType:{name:"union",raw:"ArbeidsgiverDTO | null",elements:[{name:"z.infer",elements:[{name:"ArbeidsgiverSchema"}],raw:"z.infer<typeof ArbeidsgiverSchema>"},{name:"null"}]},description:""},labelText:{required:!1,tsType:{name:"string"},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""}}};const Q=({variant:l="inline",onCompleted:i})=>{const{rekrutteringstreffId:o}=I(),d=_(o),m=H(o),{data:u}=d,[p,c]=a.useState(!1),f=async s=>{if(s)try{c(!0),await $(o,s.arbeidsgiverTreffId??s.organisasjonsnummer),m.mutate()}finally{c(!1)}},[n,v]=a.useState(null),[t,y]=a.useState([]),[b,h]=a.useState(!1),j=a.useMemo(()=>new Set((u??[]).map(s=>s.organisasjonsnummer)),[u]),x=s=>{y(r=>r.filter(g=>g.organisasjonsnummer!==s))};a.useEffect(()=>{!u||!n||(async()=>{try{if(j.has(n.organisasjonsnummer)){v(null);return}if(l==="modal"){y(s=>s.some(g=>g.organisasjonsnummer===n.organisasjonsnummer)?s:[...s,n]),v(null);return}await N(o,{organisasjonsnummer:n.organisasjonsnummer,navn:n.navn,næringskoder:n.naringskoder,gateadresse:n.adresse?.adresse,postnummer:n.adresse?.postnummer,poststed:n.adresse?.poststed}),d.mutate(),m.mutate()}catch(s){throw new R({message:"Feiler når prøver å legge til arbeidsgiver.",error:s})}finally{v(null)}})()},[n,l,j,o,d,m,u]);const S=async()=>{if(t.length!==0){h(!0);try{for(const s of t)await N(o,{organisasjonsnummer:s.organisasjonsnummer,navn:s.navn,næringskoder:s.naringskoder,gateadresse:s.adresse?.adresse,postnummer:s.adresse?.postnummer,poststed:s.adresse?.poststed});d.mutate(),m.mutate(),y([]),i?.()}catch(s){throw new R({message:"Feiler når prøver å legge til arbeidsgiver(e).",error:s})}finally{h(!1)}}};return e.jsx(L,{hooks:[d],children:s=>e.jsxs("div",{className:l==="modal"?"space-y-3":"space-y-4",children:[e.jsx("div",{children:e.jsx(z,{arbeidsgiverCallback:v,valgtArbeidsgiver:n,labelText:"Finn arbeidsgiver",placeholder:"Søk på navn, organisasjonsnummer"})}),l==="modal"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[t.map(r=>e.jsxs("div",{className:"relative",children:[e.jsx(q,{navn:r.navn,organisasjonsnummer:r.organisasjonsnummer,gateadresse:r.adresse?.adresse,postnummer:r.adresse?.postnummer,poststed:r.adresse?.poststed}),e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx(A,{size:"xsmall",variant:"tertiary",onClick:()=>x(r.organisasjonsnummer),"aria-label":`Fjern ${r.navn}`,children:e.jsx(C,{"aria-hidden":!0})})})]},r.organisasjonsnummer)),t.length===0&&e.jsx(T,{size:"small",children:"Ingen arbeidsgivere valgt ennå"})]}),e.jsx(G,{gap:"2",justify:"end",children:e.jsx(A,{type:"button",onClick:S,disabled:t.length===0||b,loading:b,children:"Legg til"})})]}),l==="inline"&&e.jsx(e.Fragment,{children:Array.isArray(s)&&s.length>0?e.jsx("ul",{children:s.map((r,g)=>e.jsx("li",{children:e.jsxs("div",{className:"relative",children:[e.jsx(q,{navn:r.navn,organisasjonsnummer:r.organisasjonsnummer,gateadresse:r.gateadresse,postnummer:r.postnummer,poststed:r.poststed}),e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx(F,{navn:r.navn,loading:p,disabled:p,onConfirm:()=>f(r),arbeidsgivereHook:d,variant:"cross",triggerAriaLabel:`Fjern ${r.navn}`})})]})},g))}):e.jsx(T,{children:"Ingen arbeidsgivere lagt til"})})]})})};Q.__docgenInfo={description:"",methods:[],displayName:"LeggTilArbeidsgiverForm",props:{variant:{required:!1,tsType:{name:"union",raw:"'inline' | 'modal'",elements:[{name:"literal",value:"'inline'"},{name:"literal",value:"'modal'"}]},description:"",defaultValue:{value:"'inline'",computed:!1}},onCompleted:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{q as A,Q as L,F as S,z as V};
