import{Q as Y,r as u,I as P,aA as Z,m as $,l as x,B as ee,v as te,J as se,L as oe,u as ne,b7 as le,c as re,bb as ie,aa as ae,j as s,e as M,H as K,w as de,cs as ce,h as ue}from"./iframe-BjHUBmX4.js";import{D as H}from"./DatoVelger-Cieb1ESD.js";import{p as B}from"./parse-D5XBI5ZB.js";import{f as _,i as A}from"./format-CEnvRZey.js";import{p as pe}from"./parseISO-BIccb9Iy.js";import{U as ge}from"./umamiEvents-DmzFNrn7.js";import{M as V}from"./Modal-nT3A2Dfs.js";import{B as me}from"./Box-CuZSUbSP.js";import{C as fe}from"./Checkbox-Cu7f4-zV.js";import{c as be}from"./useDescendant-CZdqCo1y.js";import{u as ve}from"./useControllableState-Co_ihWoO.js";import{T as R}from"./TextField-NvKcs65k.js";u.createContext(null);const[ye,ze,he,xe]=be(),[ke,J]=Y({name:"ToggleGroupContext",hookName:"useToggleGroupContext",providerName:"ToggleGroupProvider",errorMessage:"<ToggleGroup.Item> needs to be wrapped within <ToggleGroup>"});function je({value:e,disabled:n=!1,onFocus:l,onClick:t,onKeyDown:o},d){const{setSelectedValue:p,setFocusedValue:y,selectedValue:g,focusedValue:b}=J(),{register:S,descendants:c}=xe({disabled:n,value:e}),m=e===g,v=()=>y(e),T=u.useCallback(f=>{const w=c.values().findIndex(a=>a.value===b),I={ArrowLeft:()=>{var a;const i=c.prevEnabled(w,!1);(a=i?.node)===null||a===void 0||a.focus()},ArrowRight:()=>{var a;const i=c.nextEnabled(w,!1);(a=i?.node)===null||a===void 0||a.focus()},Home:()=>{var a;const i=c.firstEnabled();(a=i?.node)===null||a===void 0||a.focus()},End:()=>{var a;const i=c.lastEnabled();(a=i?.node)===null||a===void 0||a.focus()}},O=f.shiftKey||f.ctrlKey||f.altKey||f.metaKey,D=I[f.key];D&&!O?(f.preventDefault(),D(f)):f.key==="Tab"&&g&&setTimeout(()=>y(g))},[c,b,g,y]);return{ref:Z([S,d]),isSelected:m,isFocused:b===e,onClick:P(t,()=>g!==e&&p(e)),onFocus:n?void 0:P(l,v),onKeyDown:P(o,T)}}var Se=function(e,n){var l={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.indexOf(t)<0&&(l[t]=e[t]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,t=Object.getOwnPropertySymbols(e);o<t.length;o++)n.indexOf(t[o])<0&&Object.prototype.propertyIsEnumerable.call(e,t[o])&&(l[t[o]]=e[t[o]]);return l};const Te=u.forwardRef((e,n)=>{var{className:l,children:t,icon:o,label:d,value:p,onClick:y,onFocus:g,onKeyDown:b}=e,S=Se(e,["className","children","icon","label","value","onClick","onFocus","onKeyDown"]);const{cn:c}=$(),m=je({value:p,onClick:y,onFocus:g,disabled:!1,onKeyDown:b},n),v=J();return x.createElement("button",Object.assign({},S,{ref:m.ref,className:c("navds-toggle-group__button",l),type:"button",role:"radio","aria-checked":m.isSelected,"data-selected":m.isSelected,tabIndex:m.isFocused?0:-1,onClick:m.onClick,onFocus:m.onFocus,onKeyDown:m.onKeyDown}),x.createElement(ee,{as:"span",className:c("navds-toggle-group__button-inner"),size:v?.size},t??x.createElement(x.Fragment,null,o,d)))});function we({onChange:e,value:n,defaultValue:l=""}){const[t,o]=u.useState(l),[d,p]=ve({defaultValue:l,value:n,onChange:e});return u.useEffect(()=>{n!=null&&o(n)},[n]),{selectedValue:d,setSelectedValue:p,focusedValue:t,setFocusedValue:o}}var Oe=function(e,n){var l={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.indexOf(t)<0&&(l[t]=e[t]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,t=Object.getOwnPropertySymbols(e);o<t.length;o++)n.indexOf(t[o])<0&&Object.prototype.propertyIsEnumerable.call(e,t[o])&&(l[t[o]]=e[t[o]]);return l};const E=u.forwardRef((e,n)=>{var{className:l,children:t,onChange:o,size:d="medium",label:p,value:y,defaultValue:g,variant:b,fill:S=!1,"data-color":c}=e,m=Oe(e,["className","children","onChange","size","label","value","defaultValue","variant","fill","data-color"]);const{cn:v}=$(),T=te(!1),f=he(),w=we({defaultValue:g,value:y,onChange:o}),N=Object.assign(Object.assign({},w),{size:d}),k=se();!y&&!g&&console.error("ToggleGroup without value or defaultvalue is not allowed"),!y&&!g&&console.error("ToggleGroup needs either a value or defaultValue");let j;return T?.isDarkside?j=b:j=b??"action",x.createElement(ye,{value:f},x.createElement(ke,Object.assign({},N),x.createElement("div",{className:v("navds-toggle-group__wrapper",l,{"navds-toggle-group__wrapper--fill":S}),"data-color":c??Ne(j)},p&&x.createElement(oe,{as:"div",size:d,className:v("navds-toggle-group__label"),id:k},p),x.createElement("div",Object.assign({"aria-labelledby":p?k:void 0},m,{ref:n,className:v("navds-toggle-group",`navds-toggle-group--${d}`,{[`navds-toggle-group--${j}`]:j}),role:"radiogroup"}),t))))});function Ne(e){switch(e){case"action":return"accent";case"neutral":return"neutral";default:return}}E.Item=Te;const Ce=e=>e.replace(/^(\d{4}-\d{2}-\d{2}T\d{2}:\d{2})(?!:)/,"$1:00").replace(/^(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})\.(\d{3})\d+(.*)$/,"$1.$2$3"),z=e=>{if(!e)return null;if(/^\d{2}\.\d{2}\.\d{4}$/.test(e)){const l=B(e,"dd.MM.yyyy",new Date);return A(l)?_(l,"yyyy-MM-dd'T'00:00:00"):null}const n=pe(Ce(e));return A(n)?_(n,"yyyy-MM-dd'T'HH:mm:ss"):null},De=e=>{const n=z(e.stilling?.published),l=z(e.stilling?.expires);return{...e,stilling:{...e.stilling,properties:{...e.stilling.properties,tags:typeof e.stilling?.properties?.tags=="string"?e.stilling?.properties?.tags:JSON.stringify(e.stilling?.properties?.tags??[]),workday:typeof e.stilling?.properties?.workday=="string"?e.stilling?.properties?.workday:JSON.stringify(e.stilling?.properties?.workday??[]),workhours:typeof e.stilling?.properties?.workhours=="string"?e.stilling?.properties?.workhours:JSON.stringify(e.stilling?.properties?.workhours??[])},published:n,expires:l}}};function Ee({disabled:e}){const{brukerData:n,valgtNavKontor:l}=ne(),t=u.useRef(null),{watch:o,setValue:d,getValues:p}=le(),{track:y}=re(),g=ie(),b=o("stilling.privacy"),S=o("stilling.published"),c=o("stilling.expires"),m=o("stilling.properties.applicationemail"),v=o("stilling.properties.applicationurl"),[T,f]=u.useState(!1),w=ae(p().stilling.uuid),N=r=>{if(r)try{return _(new Date(r),"dd.MM.yyyy")}catch{return}},[k,j]=u.useState(N(S)),[C,I]=u.useState(N(c)),[O,D]=u.useState(b==="SHOW_ALL"),a=v?"url":"email",[i,U]=u.useState(a),[F,W]=u.useState(m??""),[G,q]=u.useState(v??""),L=r=>{if(!r)return null;const h=B(r,"dd.MM.yyyy",new Date);return _(h,"yyyy-MM-dd'T'HH:mm:ss")},Q=async()=>{f(!0);try{d("stilling.published",L(k),{shouldDirty:!0}),d("stilling.expires",L(C),{shouldDirty:!0}),d("stilling.privacy",O?"SHOW_ALL":"INTERNAL_NOT_SHOWN",{shouldDirty:!0}),O&&(i==="email"?(d("stilling.properties.applicationemail",F||null,{shouldDirty:!0}),d("stilling.properties.applicationurl",null,{shouldDirty:!0})):(d("stilling.properties.applicationurl",G||null,{shouldDirty:!0}),d("stilling.properties.applicationemail",null,{shouldDirty:!0})));const r=De(p()),h={...r,stillingsinfo:{...r.stillingsinfo},stilling:{...r.stilling,status:"ACTIVE",administration:{...r.stilling.administration,status:"DONE"},firstPublished:!0}};y(ge.Stilling.ny_stilling_info,{yrkestittel:h.stilling.categoryList?.[0]?.name,sektor:h.stilling.properties?.sector,ansettelsesform:h.stilling.properties?.engagementtype,arbeidstidsordning:h.stilling?.properties?.jobarrangement,omfangIProsent:h.stilling.properties?.jobpercentage,arbeidssted:h.stilling.locationList});try{await ce(h,{eierNavident:n.ident,eierNavn:n.navn,eierNavKontorEnhetId:l?.navKontor})}catch(X){alert("Feil ved opprettelse av stilling"),new ue({message:"Feil ved opprettelse av stilling",error:X})}t.current?.close(),w.mutate(),g.push(`/stilling/${p().stilling.uuid}`)}catch{alert("Uventet feil ved publisering")}finally{f(!1)}};return s.jsxs(s.Fragment,{children:[s.jsx(M,{size:"small",disabled:e,onClick:()=>t.current?.showModal(),children:"Publiser"}),s.jsxs(V,{ref:t,header:{heading:"Publiser stillingsoppdraget"},children:[s.jsxs(V.Body,{children:[s.jsxs(me.New,{background:"neutral-soft",padding:"6",className:"mb-8",children:[s.jsx(K,{size:"small",className:"mb-2",children:"Dette skjer når du publiserer oppdraget"}),s.jsxs("ul",{className:"list-disc pl-5 text-sm mb-4",children:[s.jsx("li",{children:"Stillingsoppdraget blir synlig for Nav-ansatte i rekrutteringsbistand."}),s.jsx("li",{children:"Ansatte hos arbeidsgiveren på Min Side Arbeidsgiver på nav.no (med Altinn-tilgang)."}),s.jsx("li",{children:"Jobbsøkere som får stillingen delt i aktivitetsplanen."})]}),s.jsx(de,{size:"small",children:"Ikke alt må være helt perfekt! Du kan når som helst endre eller avpublisere oppdraget."})]}),s.jsxs("div",{className:"grid gap-6",children:[s.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[s.jsx(H,{disablePastDates:!0,label:"Publiseringsdato",valgtDato:k,tilDato:C,setDato:r=>j(r)}),s.jsx(H,{disablePastDates:!0,label:"Siste visningsdato",valgtDato:C,fraDato:k,setDato:r=>I(r)})]}),s.jsx(fe,{checked:O,onChange:r=>D(r.target.checked),children:"Publiser stillingsoppdraget offentlig på arbeidsplassen.no også"}),O&&s.jsxs("div",{children:[s.jsx(K,{size:"small",className:"mb-4",children:"Hvordan skal jobbsøker søke?"}),s.jsxs(E,{fill:!0,defaultValue:i,onChange:r=>U(r),children:[s.jsx(E.Item,{value:"email",label:"E-post"}),s.jsx(E.Item,{value:"url",label:"Søknadsskjema"})]}),i==="email"&&s.jsx("div",{className:"mt-4",children:s.jsx(R,{label:"E-post",value:F,onChange:r=>W(r.target.value)})}),i==="url"&&s.jsx("div",{className:"mt-4",children:s.jsx(R,{label:"Lenke til søknadsskjema",value:G,onChange:r=>q(r.target.value)})})]})]})]}),s.jsxs(V.Footer,{children:[s.jsx(M,{loading:T,type:"button",onClick:Q,children:"Publiser oppdraget"}),s.jsx(M,{type:"button",variant:"secondary",onClick:()=>t.current?.close(),children:"Avbryt"})]})]})]})}Ee.__docgenInfo={description:"",methods:[],displayName:"PubliserModal",props:{disabled:{required:!0,tsType:{name:"boolean"},description:""}}};export{Ee as P,De as m};
