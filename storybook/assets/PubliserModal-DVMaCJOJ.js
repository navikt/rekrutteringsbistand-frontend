import{ag as Y,r as u,J as P,aK as Z,p as $,R as j,B as ee,v as te,M as se,L as oe,N as ne,u as re,h4 as le,f as ie,h6 as ae,j as s,e as M,H as L,x as de,w as ce}from"./iframe-2oXcNiqk.js";import{o as ue}from"./oppdaterStilling-BqHBbE6X.js";import{u as pe}from"./useStilling-0DDHNtYu.js";import{D as H}from"./DatoVelger-DYkJFIpo.js";import{p as B}from"./parse-CySyyd9K.js";import{f as _,i as R}from"./format-DWR74HJu.js";import{p as ge}from"./parseISO-CK2-VrtQ.js";import{U as me}from"./umamiEvents-BDpRy9-M.js";import{M as V}from"./Modal-pL3N-R8J.js";import{B as fe}from"./Box-apRlbBNj.js";import{C as be}from"./Checkbox-DpKFyikM.js";import{c as ye}from"./useDescendant-q-9CiBNR.js";import{u as ve}from"./useControllableState-n5Q65I8H.js";import{T as A}from"./TextField-CMYi2ZiZ.js";u.createContext(null);const[he,Je,xe,ke]=ye(),[je,J]=Y({name:"ToggleGroupContext",hookName:"useToggleGroupContext",providerName:"ToggleGroupProvider",errorMessage:"<ToggleGroup.Item> needs to be wrapped within <ToggleGroup>"});function Se({value:e,disabled:n=!1,onFocus:r,onClick:t,onKeyDown:o},d){const{setSelectedValue:p,setFocusedValue:b,selectedValue:g,focusedValue:x}=J(),{register:v,descendants:m}=ke({disabled:n,value:e}),c=e===g,h=()=>b(e),S=u.useCallback(f=>{const w=m.values().findIndex(a=>a.value===x),I={ArrowLeft:()=>{var a;const i=m.prevEnabled(w,!1);(a=i?.node)===null||a===void 0||a.focus()},ArrowRight:()=>{var a;const i=m.nextEnabled(w,!1);(a=i?.node)===null||a===void 0||a.focus()},Home:()=>{var a;const i=m.firstEnabled();(a=i?.node)===null||a===void 0||a.focus()},End:()=>{var a;const i=m.lastEnabled();(a=i?.node)===null||a===void 0||a.focus()}},O=f.shiftKey||f.ctrlKey||f.altKey||f.metaKey,D=I[f.key];D&&!O?(f.preventDefault(),D(f)):f.key==="Tab"&&g&&setTimeout(()=>b(g))},[m,x,g,b]);return{ref:Z([v,d]),isSelected:c,isFocused:x===e,onClick:P(t,()=>g!==e&&p(e)),onFocus:n?void 0:P(r,h),onKeyDown:P(o,S)}}var Te=function(e,n){var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.indexOf(t)<0&&(r[t]=e[t]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,t=Object.getOwnPropertySymbols(e);o<t.length;o++)n.indexOf(t[o])<0&&Object.prototype.propertyIsEnumerable.call(e,t[o])&&(r[t[o]]=e[t[o]]);return r};const we=u.forwardRef((e,n)=>{var{className:r,children:t,icon:o,label:d,value:p,onClick:b,onFocus:g,onKeyDown:x}=e,v=Te(e,["className","children","icon","label","value","onClick","onFocus","onKeyDown"]);const{cn:m}=$(),c=Se({value:p,onClick:b,onFocus:g,disabled:!1,onKeyDown:x},n),h=J();return j.createElement("button",Object.assign({},v,{ref:c.ref,className:m("navds-toggle-group__button",r),type:"button",role:"radio","aria-checked":c.isSelected,"data-selected":c.isSelected,tabIndex:c.isFocused?0:-1,onClick:c.onClick,onFocus:c.onFocus,onKeyDown:c.onKeyDown}),j.createElement(ee,{as:"span",className:m("navds-toggle-group__button-inner"),size:h?.size},t??j.createElement(j.Fragment,null,o,d)))});function Oe({onChange:e,value:n,defaultValue:r=""}){const[t,o]=u.useState(r),[d,p]=ve({defaultValue:r,value:n,onChange:e});return u.useEffect(()=>{n!=null&&o(n)},[n]),{selectedValue:d,setSelectedValue:p,focusedValue:t,setFocusedValue:o}}var Ne=function(e,n){var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.indexOf(t)<0&&(r[t]=e[t]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,t=Object.getOwnPropertySymbols(e);o<t.length;o++)n.indexOf(t[o])<0&&Object.prototype.propertyIsEnumerable.call(e,t[o])&&(r[t[o]]=e[t[o]]);return r};const E=u.forwardRef((e,n)=>{var{className:r,children:t,onChange:o,size:d="medium",label:p,value:b,defaultValue:g,"aria-describedby":x,variant:v,fill:m=!1,"data-color":c}=e,h=Ne(e,["className","children","onChange","size","label","value","defaultValue","aria-describedby","variant","fill","data-color"]);const{cn:S}=$(),f=te(!1),w=xe(),N=Oe({defaultValue:g,value:b,onChange:o}),T=Object.assign(Object.assign({},N),{size:d}),C=se();!b&&!g&&console.error("ToggleGroup without value or defaultvalue is not allowed"),!b&&!g&&console.error("ToggleGroup needs either a value or defaultValue");let y;return f?y=v:y=v??"action",j.createElement(he,{value:w},j.createElement(je,Object.assign({},T),j.createElement("div",{className:S("navds-toggle-group__wrapper",r,{"navds-toggle-group__wrapper--fill":m}),"data-color":c??Ce(y)},p&&j.createElement(oe,{size:d,className:S("navds-toggle-group__label"),id:C},p),j.createElement("div",Object.assign({},h,{ref:n,className:S("navds-toggle-group",`navds-toggle-group--${d}`,{[`navds-toggle-group--${y}`]:y}),"aria-describedby":ne(x,!!p&&C)||void 0,role:"radiogroup"}),t))))});function Ce(e){switch(e){case"action":return"accent";case"neutral":return"neutral";default:return}}E.Item=we;const De=e=>e.replace(/^(\d{4}-\d{2}-\d{2}T\d{2}:\d{2})(?!:)/,"$1:00").replace(/^(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})\.(\d{3})\d+(.*)$/,"$1.$2$3"),z=e=>{if(!e)return null;if(/^\d{2}\.\d{2}\.\d{4}$/.test(e)){const r=B(e,"dd.MM.yyyy",new Date);return R(r)?_(r,"yyyy-MM-dd'T'00:00:00"):null}const n=ge(De(e));return R(n)?_(n,"yyyy-MM-dd'T'HH:mm:ss"):null},Ee=e=>{const n=z(e.stilling?.published),r=z(e.stilling?.expires);return{...e,stilling:{...e.stilling,properties:{...e.stilling.properties,tags:typeof e.stilling?.properties?.tags=="string"?e.stilling?.properties?.tags:JSON.stringify(e.stilling?.properties?.tags??[]),workday:typeof e.stilling?.properties?.workday=="string"?e.stilling?.properties?.workday:JSON.stringify(e.stilling?.properties?.workday??[]),workhours:typeof e.stilling?.properties?.workhours=="string"?e.stilling?.properties?.workhours:JSON.stringify(e.stilling?.properties?.workhours??[])},published:n,expires:r}}};function _e({disabled:e}){const{brukerData:n,valgtNavKontor:r}=re(),t=u.useRef(null),{watch:o,setValue:d,getValues:p}=le(),{track:b}=ie(),g=ae(),x=o("stilling.privacy"),v=o("stilling.published"),m=o("stilling.expires"),c=o("stilling.properties.applicationemail"),h=o("stilling.properties.applicationurl"),[S,f]=u.useState(!1),w=pe(p().stilling.uuid),N=l=>{if(l)try{return _(new Date(l),"dd.MM.yyyy")}catch{return}},[T,C]=u.useState(N(v)),[y,I]=u.useState(N(m)),[O,D]=u.useState(x==="SHOW_ALL"),a=h?"url":"email",[i,U]=u.useState(a),[F,W]=u.useState(c??""),[G,q]=u.useState(h??""),K=l=>{if(!l)return null;const k=B(l,"dd.MM.yyyy",new Date);return _(k,"yyyy-MM-dd'T'HH:mm:ss")},Q=async()=>{f(!0);try{d("stilling.published",K(T),{shouldDirty:!0}),d("stilling.expires",K(y),{shouldDirty:!0}),d("stilling.privacy",O?"SHOW_ALL":"INTERNAL_NOT_SHOWN",{shouldDirty:!0}),O&&(i==="email"?(d("stilling.properties.applicationemail",F||null,{shouldDirty:!0}),d("stilling.properties.applicationurl",null,{shouldDirty:!0})):(d("stilling.properties.applicationurl",G||null,{shouldDirty:!0}),d("stilling.properties.applicationemail",null,{shouldDirty:!0})));const l=Ee(p()),k={...l,stillingsinfo:{...l.stillingsinfo},stilling:{...l.stilling,status:"ACTIVE",administration:{...l.stilling.administration,status:"DONE"},firstPublished:!0}};b(me.Stilling.ny_stilling_info,{yrkestittel:k.stilling.categoryList?.[0]?.name,sektor:k.stilling.properties?.sector,ansettelsesform:k.stilling.properties?.engagementtype,arbeidstidsordning:k.stilling?.properties?.jobarrangement,omfangIProsent:k.stilling.properties?.jobpercentage,arbeidssted:k.stilling.locationList});try{await ue(k,{eierNavident:n.ident,eierNavn:n.navn,eierNavKontorEnhetId:r?.navKontor})}catch(X){alert("Feil ved opprettelse av stilling"),new ce({message:"Feil ved opprettelse av stilling",error:X})}t.current?.close(),w.mutate(),g.push(`/stilling/${p().stilling.uuid}`)}catch{alert("Uventet feil ved publisering")}finally{f(!1)}};return s.jsxs(s.Fragment,{children:[s.jsx(M,{size:"small",disabled:e,onClick:()=>t.current?.showModal(),children:"Publiser"}),s.jsxs(V,{ref:t,header:{heading:"Publiser stillingsoppdraget"},children:[s.jsxs(V.Body,{children:[s.jsxs(fe.New,{background:"neutral-soft",padding:"6",className:"mb-8",children:[s.jsx(L,{size:"small",className:"mb-2",children:"Dette skjer når du publiserer oppdraget"}),s.jsxs("ul",{className:"list-disc pl-5 text-sm mb-4",children:[s.jsx("li",{children:"Stillingsoppdraget blir synlig for Nav-ansatte i rekrutteringsbistand."}),s.jsx("li",{children:"Ansatte hos arbeidsgiveren på Min Side Arbeidsgiver på nav.no (med Altinn-tilgang)."}),s.jsx("li",{children:"Jobbsøkere som får stillingen delt i aktivitetsplanen."})]}),s.jsx(de,{size:"small",children:"Ikke alt må være helt perfekt! Du kan når som helst endre eller avpublisere oppdraget."})]}),s.jsxs("div",{className:"grid gap-6",children:[s.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[s.jsx(H,{disablePastDates:!0,label:"Publiseringsdato",valgtDato:T,tilDato:y,setDato:l=>C(l)}),s.jsx(H,{disablePastDates:!0,label:"Siste visningsdato",valgtDato:y,fraDato:T,setDato:l=>I(l)})]}),s.jsx(be,{checked:O,onChange:l=>D(l.target.checked),children:"Publiser stillingsoppdraget offentlig på arbeidsplassen.no også"}),O&&s.jsxs("div",{children:[s.jsx(L,{size:"small",className:"mb-4",children:"Hvordan skal jobbsøker søke?"}),s.jsxs(E,{fill:!0,defaultValue:i,onChange:l=>U(l),children:[s.jsx(E.Item,{value:"email",label:"E-post"}),s.jsx(E.Item,{value:"url",label:"Søknadsskjema"})]}),i==="email"&&s.jsx("div",{className:"mt-4",children:s.jsx(A,{label:"E-post",value:F,onChange:l=>W(l.target.value)})}),i==="url"&&s.jsx("div",{className:"mt-4",children:s.jsx(A,{label:"Lenke til søknadsskjema",value:G,onChange:l=>q(l.target.value)})})]})]})]}),s.jsxs(V.Footer,{children:[s.jsx(M,{loading:S,type:"button",onClick:Q,children:"Publiser oppdraget"}),s.jsx(M,{type:"button",variant:"secondary",onClick:()=>t.current?.close(),children:"Avbryt"})]})]})]})}_e.__docgenInfo={description:"",methods:[],displayName:"PubliserModal",props:{disabled:{required:!0,tsType:{name:"boolean"},description:""}}};export{_e as P,Ee as m};
