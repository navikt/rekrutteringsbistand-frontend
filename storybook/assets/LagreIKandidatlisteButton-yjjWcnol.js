import{j as e,S as L,a as U,k as A,g as B,o as v,T as s,c as k,U as C,l as D,f as M,u as _,r as j,an as q,e as x,w,h as z}from"./iframe-UjNt-zBO.js";import{u as O}from"./useStilling-CjH1Q9PA.js";import{L as V}from"./Link-wUd1tDUs.js";import{l as T}from"./leggTilKandidat-78ulsw2F.js";import{u as b}from"./KandidatSøkMarkerteContext-07r9ySfZ.js";import{U as E}from"./umamiEvents-BDpRy9-M.js";import{M as S}from"./Modal-ixcUKZqK.js";import{T as i}from"./Table-By5x8_3K.js";import{C as I}from"./Checkbox-CXcaQ6We.js";import{P as W}from"./Pagination-D71Vl9mc.js";import{u as G}from"./useKandidatlisteForEier-TvlH73Eq.js";import{S as $}from"./PersonPlus-DfPJcZz-.js";const F=({stillingsId:t})=>{const g=O(t);return e.jsx(L,{hooks:[g],children:o=>e.jsx(V,{href:`stilling/${t}`,children:o.stilling.title??"Ukjent tittel"})})};F.__docgenInfo={description:"",methods:[],displayName:"KandidatlisteTittel",props:{stillingsId:{required:!0,tsType:{name:"string"},description:""}}};const J=t=>`${A.internUrl}/veileder/kandidatlister?pagesize=8${t&&t>1?`&pagenumber=${t}`:""}`,Q=v({kandidatlisteId:s(),tittel:s().nullable(),organisasjonReferanse:s().nullable(),organisasjonNavn:s().nullable(),stillingId:s(),opprettetAv:v({ident:s(),navn:s()}),opprettetTidspunkt:s(),antallKandidater:k(),kanEditere:C(),erEier:C(),kanSlette:s(),antallUsynligeKandidater:k(),status:s(),antallStillinger:k(),stillingskategori:s()}),X=v({liste:D(Q),antall:k()}),Y=t=>U(J(t),B(X)),P=({onClose:t})=>{const{track:g}=M(),{visVarsel:o}=_(),{markerteKandidater:r,fjernMarkerteKandidater:f}=b(),[h,p]=j.useState(1),d=Y(h>1?h-1:0),[l,u]=j.useState([]),[m,H]=j.useState(!1),R=n=>u(c=>c.includes(n)?c.filter(a=>a!==n):[...c,n]);return e.jsxs(S,{onClose:t,open:!0,width:800,header:{heading:`Lagre ${r?.length||0} kandidat i kandidatlister`},children:[e.jsx(S.Body,{children:e.jsx(L,{hooks:[d],children:n=>{const c=Math.floor(n.antall/8);return m?e.jsx(q,{}):e.jsxs(e.Fragment,{children:[e.jsxs(i,{zebraStripes:!0,children:[e.jsx(i.Header,{children:e.jsxs(i.Row,{children:[e.jsx(i.DataCell,{children:e.jsx(I,{checked:l.length===n.liste.length,indeterminate:l.length>0&&l.length!==n.liste.length,onChange:()=>{l.length?u([]):u(n.liste.map(a=>a.stillingId))},hideLabel:!0,children:"Velg alle rader"})}),e.jsx(i.HeaderCell,{scope:"col",children:"Stilling"}),e.jsx(i.HeaderCell,{scope:"col",children:"Organisasjon"}),e.jsx(i.HeaderCell,{scope:"col",children:"Antall stillinger"})]})}),e.jsx(i.Body,{children:n.liste?.map((a,y)=>e.jsxs(i.Row,{selected:l.includes(a.stillingId),children:[e.jsx(i.DataCell,{children:e.jsx(I,{hideLabel:!0,checked:l.includes(a.stillingId),onChange:()=>R(a.stillingId),"aria-labelledby":`id-${a.stillingId}`,children:" "})}),e.jsx(i.HeaderCell,{scope:"row",children:e.jsx(F,{stillingsId:a.stillingId})}),e.jsx(i.DataCell,{children:a.organisasjonNavn}),e.jsx(i.DataCell,{children:a.antallStillinger})]},a.stillingId+y))})]}),e.jsx(W,{className:"my-8 flex justify-center",size:"small",page:h,onPageChange:p,count:c>0?c:1})]})}})}),e.jsxs(S.Footer,{children:[e.jsx(x,{disabled:m||l.length===0,type:"button",onClick:()=>{N(l,t,H)},children:"Lagre"}),e.jsx(x,{disabled:m,type:"button",variant:"secondary",onClick:t,children:"Avbryt"})]})]});async function N(n,c,a){if(!(!r||r.length===0)){if(a(!0),n.length!==0){g(E.Stilling.legg_til_markerte_kandidater,{antallKandidater:r?.length,kilde:"Kandidatsøk",antallStillinger:n.length});const y=n.map(K=>T(r,K));try{await Promise.all(y),o({type:"success",tekst:`${r.length}  kandidat${r.length>1?"er":""} lagret i rekrutteringstreff`}),f(),c()}catch(K){new w({message:"Feil ved lagring av kandidater i kandidatliste",error:K}),o({type:"error",tekst:"Feil ved lagring av kandidater i kandidatliste"})}}a(!1)}}};P.__docgenInfo={description:"",methods:[],displayName:"LagreIKandidatlisteModal",props:{onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};const Z=({stillingsId:t})=>{const{track:g}=M(),{erEier:o,stillingsData:r,refetchKandidatliste:f}=z(),h=G(r,o),{visVarsel:p}=_(),{markerteKandidater:d,fjernMarkerteKandidater:l}=b();async function u(){if(!(!d||d.length===0)&&t){g(E.Stilling.legg_til_markerte_kandidater,{antallKandidater:d?.length,kilde:"Finn kandidater"});try{await T(d,t),p({type:"success",tekst:`${d.length}  kandidat${d.length>1?"er":""} lagret i kandiatliste`}),l()}catch(m){new w({message:"Feil ved lagring av kandidater i kandidatliste",error:m}),p({type:"error",tekst:"Feil ved lagring av kandidater i kandidatliste"})}}}return e.jsx(x,{variant:"tertiary",onClick:()=>{u(),setTimeout(()=>{h.mutate(),f?.()},1e3)},icon:e.jsx($,{"aria-hidden":!0}),disabled:d?.length===0,children:"Legg til markerte kandidater"})},ee=({stillingsId:t})=>{const{markerteKandidater:g}=b(),[o,r]=j.useState(!1);return t?e.jsx(Z,{stillingsId:t}):e.jsxs("div",{className:"flex",children:[e.jsx(x,{variant:"tertiary",onClick:()=>r(!0),icon:e.jsx($,{"aria-hidden":!0}),disabled:g?.length===0,children:"Lagre i kandidatliste"}),o&&e.jsx(P,{onClose:()=>r(!1)})]})};ee.__docgenInfo={description:"",methods:[],displayName:"LagreIKandidatlisteButton",props:{stillingsId:{required:!1,tsType:{name:"string"},description:""}}};export{F as K,ee as L};
