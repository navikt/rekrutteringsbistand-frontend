import{h4 as x,hE as S,r as M,j as e,H as j,aP as E,B as U,hb as w,e as K,Y as _,a0 as G}from"./iframe-DxsVXlKp.js";import{b as O}from"./useAutosave-DVGo-89L.js";import{u as z}from"./usePamPostdata-DQSMHUJP.js";import{T as y}from"./TextField-BkANrbpx.js";import{T as I,S as H}from"./TidspunktForm-Ux0jAX6n.js";import{K as X}from"./KiAnalyse-Dh_0zLPj.js";import{K as q}from"./KiAnalysePanel-BfOIv8iP.js";import{u as W}from"./useFormFeltMedKiValidering-DMnIVkxL.js";import{M as F}from"./mutations-B9GyulbB.js";import{S as Y}from"./Skeleton-lh898a5X.js";const t={GATEADRESSE:"gateadresse",POSTNUMMER:"postnummer",POSTSTED:"poststed"},b=({control:r})=>{const{setValue:o,clearErrors:u,setError:f,trigger:T}=x(),{save:m}=O(),n=S({control:r,name:t.POSTNUMMER}),{data:d,isLoading:c}=z(n||"");return M.useEffect(()=>{!n||n.length!==4||c||(d?.korrigertNavnBy?(o(t.POSTSTED,d.korrigertNavnBy,{shouldDirty:!0,shouldValidate:!0}),u(t.POSTSTED)):(o(t.POSTSTED,"",{shouldDirty:!0,shouldValidate:!0}),f(t.POSTSTED,{type:"manual",message:"Ukjent poststed"})))},[n,c,d,o,f,u]),e.jsxs("div",{className:"space-y-4",children:[e.jsx(j,{level:"3",size:"small",children:"Sted"}),e.jsx(E,{name:t.GATEADRESSE,control:r,render:({field:a,fieldState:l})=>e.jsx(y,{...a,value:a.value??"",label:"Gateadresse",error:l.error?.message,onBlur:()=>{a.onBlur(),m([t.GATEADRESSE])}})}),e.jsxs("div",{className:"flex gap-4 items-start",children:[e.jsx(E,{name:t.POSTNUMMER,control:r,render:({field:a,fieldState:l})=>e.jsx(y,{...a,value:a.value??"",label:"Postnummer",htmlSize:12,error:l.error?.message,onChange:g=>{const h=g.target.value.replace(/\D/g,"");u([t.POSTNUMMER,t.POSTSTED]),o(t.POSTSTED,"",{shouldDirty:!1,shouldValidate:!0}),h.length<=4&&a.onChange(h),h.length===4&&T([t.POSTNUMMER])},onBlur:()=>{a.onBlur(),m([t.POSTNUMMER,t.POSTSTED])}})}),e.jsx(U,{className:`pt-8 ${S({control:r,name:t.POSTSTED})?"":"aksel-error-message"}`,children:S({control:r,name:t.POSTSTED})||(n&&n.length===4&&!c?"Ukjent poststed":"")})]})]})};b.__docgenInfo={description:"",methods:[],displayName:"StedForm"};const $=()=>{const{control:r}=x();return e.jsxs("div",{className:"space-y-8",children:[e.jsx(j,{level:"2",size:"medium",children:"Praktiske forhold"}),e.jsx(I,{control:r}),e.jsx(H,{control:r}),e.jsx(b,{control:r})]})};$.__docgenInfo={description:"",methods:[],displayName:"PraktiskeForhold"};const J="Treff uten navn",A=({onUpdated:r})=>{const{treff:o}=w(),u=o?o.tittel??null:void 0,{clearErrors:f,formState:{isSubmitting:T}}=x(),m=M.useRef(null),{save:n}=O(),{analyse:d,analyseError:c,validating:a,kiErrorBorder:l,harGodkjentKiFeil:g,showAnalysis:h,erRedigeringAvPublisertTreff:R,runValidationAndMaybeSave:P,onGodkjennKiFeil:B,watchedValue:p,control:C,setValue:D,kiLoggLoading:N}=W({feltType:"tittel",fieldName:"tittel",savedValue:u,saveCallback:n,onUpdated:r}),V=F-(typeof p=="string"?p.length:0),L=()=>{D("tittel","",{shouldValidate:!0,shouldDirty:!0,shouldTouch:!0}),m.current?.focus()};return e.jsxs("section",{className:"space-y-3",children:[N&&e.jsx(Y,{variant:"text"}),!N&&e.jsxs(e.Fragment,{children:[e.jsx(j,{level:"2",size:"medium",children:"Navn på treffet"}),e.jsxs("div",{className:"relative w-full",children:[p&&e.jsx(K,{type:"button",onClick:L,"aria-label":"Tøm tittel feltet",variant:"tertiary",size:"small",className:"absolute right-2 top-[2rem] -translate-y-1/2 h-8 p-1",title:"Tøm feltet",children:e.jsx(_,{"aria-hidden":!0,fontSize:"1.25rem"})}),e.jsx("div",{className:"flex items-start",children:e.jsx(E,{control:C,name:"tittel",render:({field:i,fieldState:k})=>e.jsx(y,{...i,value:i.value??"",ref:s=>{i.ref(s),m.current=s},label:"Navn på treffet",hideLabel:!0,maxLength:F,className:"w-full pt-2",error:k.error?.message||(l?"Brudd på retningslinjer":void 0),"aria-invalid":!!(k.error||l),autoComplete:"off",autoCorrect:"off",spellCheck:!1,onChange:s=>{i.onChange(s),s.target.value.trim().length>0&&f("tittel")},onBlur:async()=>{i.onBlur(),setTimeout(async()=>{!a&&!T&&await P()},0)},onFocus:()=>{const s=i.value;if(!s||typeof s!="string")return;s.trim()===J&&D("tittel","",{shouldValidate:!1,shouldDirty:!1,shouldTouch:!1})},onKeyDown:s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),(async()=>{const v=s.currentTarget;await P(),v?.blur()})())}})})})]}),e.jsxs(G,{className:"text-gray-400",children:[V," tegn igjen"]}),e.jsx(X,{}),e.jsx(q,{validating:a,analyse:d,analyseError:c,harGodkjentKiFeil:g,showAnalysis:h,erRedigeringAvPublisertTreff:R,onGodkjennKiFeil:B,ariaLabel:"Analyse av tittel"})]})]})};A.displayName="TittelForm";A.__docgenInfo={description:"",methods:[],displayName:"TittelForm",props:{onUpdated:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{$ as P,b as S,A as T};
