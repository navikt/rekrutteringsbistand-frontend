import{u as J,Q as q,aw as U,r as x,d4 as O,d5 as $,d6 as i,cP as N,d7 as G,j as e,L as A,N as _,B as f,d as t,E as Q}from"./iframe-BA8lGxgc.js";import{P as W,a as X,b as Y,c as Z,d as ee}from"./PopoverModal-DhAzM4S4.js";import{U as se}from"./umamiEvents-CYDHrNFb.js";import{S as ne}from"./Select-Dpi3Anwx.js";import{B as F}from"./Box-BxtLu52g.js";import{S as K}from"./ArrowForward-jdN-Mytj.js";import{M as v}from"./Modal-FL_hfnIr.js";import{A as m}from"./Accordion-BY7cBQ6d.js";import{T as a}from"./Table-BE-PhXr5.js";const ae="_sendSmsModal_1o7hh_1",le="_velgMal_1o7hh_5",ie="_kontortidAdvarsel_1o7hh_18",S={sendSmsModal:ae,velgMal:le,kontortidAdvarsel:ie},re=r=>{const{visVarsel:l}=J(),{fjernAllMarkering:z,markerteKandidater:n,knappVariant:b}=r,{track:I}=q(),{stillingsData:g}=U(),h=g?.stillingsinfo?.stillingskategori,P=g.stilling.uuid,[V,d]=x.useState(!1),{data:y={}}=O(h==="FORMIDLING"?null:g.stilling.uuid),B=$(),[p,M]=x.useState(!1),o=n.filter(s=>s.fodselsnr&&y[s.fodselsnr]),c=n.filter(s=>!(s.fodselsnr&&y[s.fodselsnr])),H=n.some(s=>s.fodselsnr===null),[T,D]=x.useState(h===N.Jobbmesse?i.Jobbarrangement:i.VurdertSomAktuell),{data:C}=G(),k=n.map(s=>s.fodselsnr),u=async()=>{if(M(!0),k.length===0){l({tekst:"Ingen kandidater valgt",type:"warning"});return}try{await B({mal:T,fnr:k.filter(s=>s!==null),stillingId:P}),I(se.Stilling.send_beskjed_til_kandidat,{antall:k.length}),l({tekst:"Beskjed er sendt",type:"success"}),z(),d(!1)}catch(s){new Q({message:"Klarte ikke å sende SMS:",error:s}),l({tekst:s instanceof Error?`Feil ved sending: ${s.message}`:"Det skjedde en uventet feil ved sending av beskjed",type:"error"})}finally{M(!1)}},j=e.jsxs("div",{className:"send-sms-modal__innhold",children:[e.jsx(A,{variant:"info",className:S.kontortidAdvarsel,children:e.jsx(_,{size:"small",children:"SMS sendes ut mellom 09:00 og 17:15 hver dag. Det kan oppstå forsinkelser."})}),h!==N.Jobbmesse&&e.jsxs(ne,{className:S.velgMal,label:"Velg hva som skal vises i beskjeden",onChange:s=>{D(s.target.value)},children:[e.jsx("option",{value:i.VurdertSomAktuell,children:"Tips en aktuell kandidat om stilling"}),e.jsx("option",{value:i.FunnetPassendeStilling,children:"Oppfordre kandidat til å søke på stilling"})]}),e.jsx(_,{htmlFor:"forhåndsvisning",children:"Meldingen som vil bli sendt til kandidatene"}),e.jsx("div",{id:"forhåndsvisning",className:"py-4",children:e.jsx(F.New,{background:"neutral-softA",borderRadius:"large",padding:"4",children:e.jsx(f,{children:e.jsxs("span",{children:[C?te(T,C):"Klarte ikke å hente meldingsmaler"," "]})})})})]});return r.popover?e.jsxs(e.Fragment,{children:[e.jsx(W,{tittel:"Tips om stilling",åpneKnapp:e.jsx(t,{disabled:n.length===0,onClick:()=>d(!0),size:"small",variant:b||"secondary",icon:e.jsx(K,{title:"Tips om stilling"}),children:"Tips om stillingen"}),children:e.jsxs(e.Fragment,{children:[j,e.jsx("div",{className:"flex justify-end",children:e.jsx(t,{disabled:o.length===n.length||c.length===0,variant:"primary",loading:p,onClick:u,children:"Send tips"})})]})}),e.jsxs(X,{children:[e.jsx(Y,{}),e.jsx(Z,{className:"z-999",side:"bottom",align:"start",children:e.jsxs(F.New,{background:"raised",borderRadius:"12",padding:"5",shadow:"dialog",borderColor:"neutral-subtle",borderWidth:"1",children:[e.jsx("div",{className:"flex justify-between",children:e.jsx(ee,{children:"asd"})}),j,e.jsx("div",{className:"flex justify-end",children:e.jsx(t,{disabled:o.length===n.length||c.length===0,variant:"primary",loading:p,onClick:u,children:"Send tips"})})]})})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(t,{className:"text-nowrap",disabled:n.length===0,onClick:()=>d(!0),size:"small",variant:b||"secondary",icon:e.jsx(K,{title:"Tips om stilling"}),children:"Tips om stillingen"}),e.jsxs(v,{open:V,className:S.sendSmsModal,onClose:()=>d(!1),"aria-label":`Tips ${n.length} kandidater om stillingen`,header:{heading:"Tips om stillingen"},children:[e.jsxs(v.Body,{children:[(o.length>0||H)&&e.jsx(A,{variant:"warning",size:"small",className:"my-4",children:"Ikke alle kandidatene vil motta beskjeden"}),e.jsxs(f,{children:["Det vil bli sendt beskjed til"," ",e.jsx("b",{children:c.length})," ",c.length===1?"kandidat":"kandidater"]}),e.jsx(f,{size:"small",children:"Telefonnummerene/e-postene blir hentet fra Kontakt- og reservasjonsregisteret."}),e.jsx(m,{size:"small",headingSize:"xsmall",className:"my-4",children:e.jsxs(m.Item,{children:[e.jsx(m.Header,{children:"Vis kandidater"}),e.jsx(m.Content,{children:e.jsxs(a,{size:"small",children:[e.jsx(a.Header,{children:e.jsxs(a.Row,{children:[e.jsx(a.HeaderCell,{scope:"col",children:"Navn"}),e.jsx(a.HeaderCell,{scope:"col",children:"Fødselsnr."}),e.jsx(a.HeaderCell,{scope:"col",children:"Kan sende tips"})]})}),e.jsx(a.Body,{children:n?.map(({fornavn:s,etternavn:L,fodselsnr:w},R)=>e.jsxs(a.Row,{children:[e.jsxs(a.HeaderCell,{scope:"row",children:[s," ",L]}),e.jsx(a.DataCell,{children:w}),e.jsx(a.DataCell,{children:o.some(E=>E.fodselsnr===w)?"Nei":"Ja"})]},R))})]})})]})}),j]}),e.jsxs(v.Footer,{children:[e.jsx(t,{disabled:o.length===n.length||c.length===0,variant:"primary",loading:p,onClick:u,children:"Send tips"}),e.jsx(t,{variant:"secondary",onClick:()=>d(!1),children:"Avbryt"})]})]})]})},te=(r,l)=>{if(r===i.VurdertSomAktuell)return l.vurdertSomAktuell?.smsTekst;if(r===i.FunnetPassendeStilling)return l.passendeStilling?.smsTekst;if(r===i.Jobbarrangement)return l.passendeJobbarrangement?.smsTekst};re.__docgenInfo={description:"",methods:[],displayName:"SendSmsModal",props:{markerteKandidater:{required:!0,tsType:{name:"Array",elements:[{name:"z.infer",elements:[{name:"kandidaterSchema"}],raw:"z.infer<typeof kandidaterSchema>"}],raw:"KandidatListeKandidatDTO[]"},description:""},fjernAllMarkering:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},popover:{required:!1,tsType:{name:"boolean"},description:""},knappVariant:{required:!1,tsType:{name:"union",raw:"'secondary' | 'tertiary'",elements:[{name:"literal",value:"'secondary'"},{name:"literal",value:"'tertiary'"}]},description:""}}};export{re as S};
