import{r as p,y as R,R as w,j as e,cC as T,W as K,X as _,T as H,u as L,av as z,cD as B,d as C,S as P,D as J,E as D}from"./iframe-Dn6oOtbf.js";import{u as V}from"./KandidatlisteContext-dK394pnf.js";import{U}from"./umamiEvents-DmzFNrn7.js";import{v as q}from"./validerEpost-bkYxvk6k.js";import{M as A}from"./Modal-BVkvhY2h.js";import{A as h}from"./Accordion-Cdsm0aqq.js";import{T as i}from"./Table-ClZbLya2.js";import{C as $}from"./ComboboxProvider-CkgcVMoX.js";var W=function(t,d){var s={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&d.indexOf(n)<0&&(s[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)d.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(s[n[r]]=t[n[r]]);return s};const G=p.forwardRef((t,d)=>{var{title:s,titleId:n}=t,r=W(t,["title","titleId"]);let c=R();return c=s?n||"title-"+c:void 0,w.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 24 24",focusable:!1,role:"img",ref:d,"aria-labelledby":c},r),s?w.createElement("title",{id:c},s):null,w.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M5.75 20.25V3.75h12.5v9.75a.75.75 0 0 0 1.5 0v-10c0-.69-.56-1.25-1.25-1.25h-13c-.69 0-1.25.56-1.25 1.25v17c0 .69.56 1.25 1.25 1.25h1.742a.75.75 0 0 0 0-1.5zm5.2-14.1a.75.75 0 0 1 .15 1.05l-1.5 2a.75.75 0 0 1-1.13.08l-1-1a.75.75 0 0 1 1.06-1.06l.389.388L9.9 6.3a.75.75 0 0 1 1.05-.15M13 7.25a.75.75 0 0 0 0 1.5h2.5a.75.75 0 0 0 0-1.5zm-3.514 5.204a.75.75 0 0 1 .819-.14l9 4a.75.75 0 0 1 0 1.371l-9 4a.75.75 0 0 1-1.007-.948L10.699 17l-1.401-3.737a.75.75 0 0 1 .188-.809m1.845 1.958.689 1.838H14a.75.75 0 0 1 0 1.5h-1.98l-.69 1.838L17.154 17z",clipRule:"evenodd"}))}),S=({opprettetAvNavn:t,stillingstittel:d})=>{const s=p.useRef(null),n=p.useCallback(a=>{if(!a)return;let m=null;try{m=a.contentDocument||a.contentWindow?.document,m?.body}catch{return}if(!m)return;const u=m.getElementById("tittel"),j=m.getElementById("stillingstittel"),b=m.getElementById("avsender");u&&(u.textContent=d||"stilling"),j&&(j.textContent=d||"stilling"),b&&(b.textContent=t)},[t,d]);p.useEffect(()=>{n(s.current)},[n]);const r=a=>{s.current=a,n(a)},c=`${T.internUrl}/template`;return e.jsx("iframe",{ref:s,title:"forhåndsvisning",className:"border-border-divider h-[30rem] max-h-full w-full rounded-lg border",onLoad:a=>r(a.currentTarget),src:c})};S.__docgenInfo={description:"",methods:[],displayName:"ForhåndsvisningAvEpost",props:{opprettetAvNavn:{required:!0,tsType:{name:"string"},description:""},stillingstittel:{required:!1,tsType:{name:"string"},description:""}}};const X=t=>`${_.internUrl}/veileder/kandidatlister/${t}/deltekandidater`,Q=async t=>await K(X(t.kandidatlisteId),{epostMottakere:t.mailadresser,epostTekst:"",kandidater:t.kandidatnummerListe,navKontor:t.navKontor}),Y=({markerteKandidater:t,sidebar:d})=>{const{track:s}=H(),[n,r]=p.useState(!1),[c,a]=p.useState(!1),{valgtNavKontor:m}=L(),{stillingsData:u}=z(),{kandidatlisteId:j,reFetchKandidatliste:b,kandidatlisteRawData:I}=V(),N=B(u.stilling.uuid),E=u.stilling.contactList?.map(o=>o.email).filter(o=>o!==null&&o.trim()!=="")||[],[x,y]=p.useState(E),M=async o=>{s(U.Stilling.del_kandidat_med_arbeidsgiver,{antall:o.length}),r(!0),await Q({kandidatlisteId:j,kandidatnummerListe:o,mailadresser:x,navKontor:m?.navKontor??""}).then(()=>{r(!1),y([]),a(!1),b()})};return e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"text-nowrap",onClick:()=>a(!0),disabled:t.length===0,variant:d?"primary":"tertiary",icon:e.jsx(G,{title:"Del med arbeidsgiver"}),children:"Del CV med arbeidsgiver"}),e.jsx(A,{className:"overflow-visible",width:"medium",open:c,onClose:()=>a(!1),"aria-label":"Del kandidater med arbeidsgiver",header:{heading:"Del med arbeidsgiver"},children:e.jsx(P,{hooks:[N],children:o=>{const v=t.filter(l=>{const g=(l.aktørid&&o[l.aktørid])??null;return(g?g?.some(k=>k.svar?.harSvartJa===!0):null)?l:null}),O=v.length===t.length;return e.jsxs(e.Fragment,{children:[e.jsxs(A.Body,{className:"overflow-visible",children:[!O&&e.jsx(J,{variant:"warning",size:"small",className:"mb-4",children:e.jsxs(D,{children:[v.length===0?"Kandidaten(e) ":`${t.length-v.length} av kandidatene har `,"har ikke svart eller svart nei på om CV-en kan deles."]})}),e.jsx(h,{size:"small",headingSize:"xsmall",className:"my-4",children:e.jsxs(h.Item,{children:[e.jsx(h.Header,{children:"Vis kandidater"}),e.jsx(h.Content,{children:e.jsxs(i,{size:"small",children:[e.jsx(i.Header,{children:e.jsxs(i.Row,{children:[e.jsx(i.HeaderCell,{scope:"col",children:"Navn"}),e.jsx(i.HeaderCell,{scope:"col",children:"Fødselsnr."}),e.jsx(i.HeaderCell,{scope:"col",children:"Kan deles"})]})}),e.jsx(i.Body,{children:t?.map(({fornavn:l,etternavn:g,fodselsnr:f},k)=>e.jsxs(i.Row,{children:[e.jsxs(i.HeaderCell,{scope:"row",children:[l," ",g]}),e.jsx(i.DataCell,{children:f}),e.jsx(i.DataCell,{children:f&&v.some(F=>F.fodselsnr===f)?"Ja":"Nei"})]},k))})]})})]})}),e.jsx(D,{children:"Send en e-post med kandidater med arbeidsgiveren."}),e.jsx($,{className:"my-4 ",allowNewValues:!0,label:"E-post til arbeidsgiver",options:E,selectedOptions:x,shouldAutocomplete:!1,isMultiSelect:!0,onToggleSelected:(l,g)=>{g?q(l).erGodkjent&&y([...x,l]):y(x.filter(f=>f!==l))}}),e.jsx(h,{children:e.jsxs(h.Item,{children:[e.jsx(h.Header,{children:"Forhåndsvis e-posten"}),e.jsx(h.Content,{children:e.jsx(S,{stillingstittel:u.stilling.title,opprettetAvNavn:I.opprettetAv.navn})})]})})]}),e.jsxs(A.Footer,{children:[e.jsx(C,{variant:"secondary",onClick:()=>a(!1),children:"Avbryt"}),e.jsx(C,{loading:n,disabled:v.length===0||x.length===0,variant:"primary",onClick:()=>M(v.map(l=>l.kandidatnr).filter(l=>l!==null)),children:"Del kandidatene"})]})]})}})})]})};Y.__docgenInfo={description:"",methods:[],displayName:"DelMedArbeidsgiver",props:{markerteKandidater:{required:!0,tsType:{name:"Array",elements:[{name:"z.infer",elements:[{name:"kandidaterSchema"}],raw:"z.infer<typeof kandidaterSchema>"}],raw:"KandidatListeKandidatDTO[]"},description:""},sidebar:{required:!1,tsType:{name:"boolean"},description:""}}};export{Y as D,S as F};
